on_actions = {
	on_state_control_changed = {	
		effect = {
			### TRADE CITIES 2.0 ###
			if = {# when states change controller, both check for trade cities
				limit = {
					OR = {
						FROM.FROM = { state = 16 }
						FROM.FROM = { state = 27 }
						FROM.FROM = { state = 99 }
						FROM.FROM = { state = 21 }
						FROM.FROM = { state = 143 }
						FROM.FROM = { state = 141 }
						FROM.FROM = { state = 140 }
						FROM.FROM = { state = 215 }
						FROM.FROM = { state = 228 }
						FROM.FROM = { state = 1 }	# TO-DO: change later!
					}
				}
				ROOT = { check_trade_cities = yes }
				FROM = { check_trade_cities = yes }
			}
		}
		effect = {
			### RELIGION SYSTEM 20. ###
			if = {
				limit = {	# gains compliance boost porportional to shared religion
					ROOT = { check_variable = { country_religion = FROM.FROM.state_relition }
					FROM.FROM = { NOT = { is_core_of = ROOT } }
				}
				if = {
					limit = { ROOT = { check_variable = country_religion = 1 } }	# Buddhism
					FROM.FROM = {
						set_temp_variable = { minimum_compliance = country_religion_buddhism }
					}
				}
				if = {
					limit = { ROOT = { check_variable = country_religion = 2 } }	# Shinto
					FROM.FROM = {
						set_temp_variable = { minimum_compliance = country_religion_shinto }
					}
				}
				if = {
					limit = { ROOT = { check_variable = country_religion = 3 } }	# Christianity
					FROM.FROM = {
						set_temp_variable = { minimum_compliance = country_religion_christianity }
					}
				}
				if = {
					limit = { ROOT = { check_variable = country_religion = 4 } }	# Taoism
					FROM.FROM = {
						set_temp_variable = { minimum_compliance = country_religion_taoism }
					}
				}
				if = {
					limit = { ROOT = { check_variable = country_religion = 5 } }	# Confucianism
					FROM.FROM = {
						set_temp_variable = { minimum_compliance = country_religion_confucianism }
					}
				}
				if = {
					limit = { ROOT = { check_variable = country_religion = 6 } }	# Secularism
					FROM.FROM = {
						set_temp_variable = { minimum_compliance = country_religion_secularism }
					}
				}
				if = {
					limit = { ROOT = { check_variable = country_religion = 7 } }	# Cult of Cthulhu
					FROM.FROM = {
						set_temp_variable = { minimum_compliance = country_religion_cthulhu }
					}
				}
				FROM.FROM = {
					multiply_temp_variable = { minimum_compliance = 100 }
					if = {
						limit = { ROOT = { has_war_with = FROM } }
						divide_temp_variable = { minimum_compliance = 2 }	# peaceful transfer is less traumatic
					}
					if = {
						limit = { compliance < var:minimum_compliance }
						set_compliance = var:minimum_compliance
					}
				}
			}
		}
	}
}
