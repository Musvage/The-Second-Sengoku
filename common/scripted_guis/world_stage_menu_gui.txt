scripted_gui = {

	##### POLITICS MENU INTERFACE #####
	
	SS_worldstage_open = {
		context_type = player_context
		window_name = "SS_worldstage_open_container"
		parent_window_token = politics_tab

		visible = {
			is_ai = no
			OR = {
				NOT = { has_variable = show_SS_worldstage }
				NOT = { check_variable = { show_SS_worldstage = 1 } }
			}
		}

		triggers = {
			worldstage_open_button_click_enabled = {
				OR = {
					NOT = { has_variable = show_SS_worldstage }
					NOT = { check_variable = { show_SS_worldstage = 1 } }
				}
			}
		}

		effects = {
			worldstage_open_button_click = {
				set_variable = { show_SS_trade = 0 }
				set_variable = { show_SS_religion = 0 }
				set_variable = { show_SS_unification = 0 }
				set_variable = { show_SS_worldstage = 1 }
				set_variable = { current_theater = 0 }
				set_variable = { show_SS_switch_leader = 0 }
				if = {
					limit = {
						NOT = { has_country_flag = worldstage_menu_show_asia }
						NOT = { has_country_flag = worldstage_menu_show_europe }
						NOT = { has_country_flag = worldstage_menu_show_ledger }
					}
					set_country_flag = worldstage_menu_show_europe
				}
				world_stage_get_country_icon = yes
			}
		}
	}

	SS_worldstage_close = {
		context_type = player_context
		window_name = "SS_worldstage_close_container"
		parent_window_token = politics_tab

		visible = {
			is_ai = no
			NOT = { check_variable = { show_SS_worldstage = 0 } }
		}

		triggers = {
			worldstage_open_button_click_enabled = {
				NOT = { check_variable = { show_SS_worldstage = 0 } }
			}
		}

		effects = {
			worldstage_open_button_click = {
				set_variable = { show_SS_worldstage = 0 }
				set_variable = { current_theater = 0 }
				clear_alternative_theater = yes	# this bit may be redundant but we'll run it here just for safety
			}
		}

	}
	
	SS_worldstage_base = {
		context_type = player_context
		window_name = "SS_worldstage_container_base"
		parent_window_token = politics_tab
		dirty = show_SS_worldstage

		visible = { check_variable = { show_SS_worldstage = 1 } }
		
		triggers = {
			worldstage_notification_on_button_visible = { NOT = { has_country_flag = hide_worldstage_notification } }
			worldstage_notification_off_button_visible = { has_country_flag = hide_worldstage_notification }
		}
		
		effects = {
			worldstage_notification_on_button_click = { set_country_flag = hide_worldstage_notification }
			worldstage_notification_off_button_click = { clr_country_flag = hide_worldstage_notification }
		}
	}

	SS_worldstage_europe = {
		context_type = player_context
		window_name = "SS_worldstage_container_europe"
		parent_window_token = politics_tab
		dirty = show_SS_worldstage

		visible = {
			check_variable = { show_SS_worldstage = 1 }
			has_country_flag = worldstage_menu_show_europe
			NOT = { has_country_flag = worldstage_menu_show_ledger }
		}
		
		triggers = {
			map_background_europe_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
			map_detail_finland_visible = { has_global_flag = worldstage_menu_annex_baltic }
			map_detail_baltic_visible = { has_global_flag = worldstage_menu_annex_karelia }
			worldstage_header_europe_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
			worldstage_power_display_visible = {
				has_variable = world_stage_metropolis
				NOT = { check_variable = { world_stage_metropolis = 0 } }	# should be redundant, but just in case...
				NOT = { check_variable = { world_stage_metropolis = 1 } }
			}
			worldstage_power_frame_icon_visible = {
				has_variable = world_stage_metropolis
				NOT = { check_variable = { world_stage_metropolis = 0 } }	# should be redundant, but just in case...
				NOT = { check_variable = { world_stage_metropolis = 1 } }	# non-foreing power
				NOT = { check_variable = { world_stage_metropolis = 11 } }	# internationally recognized Japan
			}
	#		theater_icon_england_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_france_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_germany_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_alsace_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_westphalia_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_netherlands_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_lybia_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_egypt_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_sicily_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_italy_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_alpes_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_austria_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_poland_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_belarus_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_smolensk_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
	#		theater_icon_russia_visible = { NOT = { has_country_flag = worldstage_menu_show_asia } }
			theater_icon_normandy_visible = {
				NOT = { has_country_flag = worldstage_menu_show_asia }
				has_global_flag = world_stage_theater_normandy_is_active
			}
			theater_icon_sealion_visible = {
				NOT = { has_country_flag = worldstage_menu_show_asia }
				has_global_flag = world_stage_theater_sealion_is_active
			}
			# active fronts
			active_front_england_visible = { 30 = { has_state_flag = theater_is_active } }
			active_front_france_visible = { 8 = { has_state_flag = theater_is_active } }
			active_front_germany_visible = { 7 = { has_state_flag = theater_is_active } }
			active_front_alsace_visible = { 5 = { has_state_flag = theater_is_active } }
			active_front_westphalia_visible = { 6 = { has_state_flag = theater_is_active } }
			active_front_netherlands_visible = { 27 = { has_state_flag = theater_is_active } }
			active_front_lybia_visible = { 14 = { has_state_flag = theater_is_active } }
			active_front_egypt_visible = { 15 = { has_state_flag = theater_is_active } }
			active_front_sicily_visible = { 24 = { has_state_flag = theater_is_active } }
			active_front_italy_visible = { 23 = { has_state_flag = theater_is_active } }
			active_front_alpes_visible = { 25 = { has_state_flag = theater_is_active } }
			active_front_austria_visible = { 26 = { has_state_flag = theater_is_active } }
			active_front_poland_visible = { 3 = { has_state_flag = theater_is_active } }
			active_front_belarus_visible = { 9 = { has_state_flag = theater_is_active } }
			active_front_smolensk_visible = { 10 = { has_state_flag = theater_is_active } }
			active_front_russia_visible = { 11 = { has_state_flag = theater_is_active } }
			active_front_normandy_visible = { always = no } #= {  = { has_state_flag = theater_is_active } }
			active_front_sealion_visible = { always = no } #= {  = { has_state_flag = theater_is_active } }
		}
		
		properties = {			
			map_background_europe = { frame = var:global.worldstage_europe_map_frame }
			country_icon = { frame = var:world_stage_icon }
			faction_icon = { frame = var:world_stage_coalition }
			theater_icon_england = { frame = var:30.theater_owner_coalition }
			theater_icon_france = { frame = var:8.theater_owner_coalition }
			theater_icon_germany = { frame = var:7.theater_owner_coalition }
			theater_icon_alsace = { frame = var:5.theater_owner_coalition }
			theater_icon_westphalia = { frame = var:6.theater_owner_coalition }
			theater_icon_netherlands = { frame = var:27.theater_owner_coalition }
			theater_icon_lybia = { frame = var:14.theater_owner_coalition }
			theater_icon_egypt = { frame = var:15.theater_owner_coalition }
			theater_icon_sicily = { frame = var:24.theater_owner_coalition }
			theater_icon_italy = { frame = var:23.theater_owner_coalition }
			theater_icon_alpes = { frame = var:25.theater_owner_coalition }
			theater_icon_austria = { frame = var:26.theater_owner_coalition }
			theater_icon_poland = { frame = var:3.theater_owner_coalition }
			theater_icon_belarus = { frame = var:9.theater_owner_coalition }
			theater_icon_smolensk = { frame = var:10.theater_owner_coalition }
			theater_icon_russia = { frame = var:11.theater_owner_coalition }
			#theater_icon_normandy = { frame = var: }
			#theater_icon_sealion = { frame = var: }
		}
		
		effects = {
			theater_icon_england_click = { if = { limit = { 30 = { can_open_theater = yes } } set_variable = { current_theater = 30 } get_number_of_connected_theaters = yes } }	# add proxy-specific triggers for all, triggers should be more precise
			theater_icon_france_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 8 } get_number_of_connected_theaters = yes } }
			theater_icon_germany_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 7 } get_number_of_connected_theaters = yes } }
			theater_icon_alsace_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 5 } get_number_of_connected_theaters = yes } }
			theater_icon_westphalia_click = { if = { limit = { 6 = { can_open_theater = yes } } set_variable = { current_theater = 6 } get_number_of_connected_theaters = yes } }
			theater_icon_netherlands_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 27 } get_number_of_connected_theaters = yes } }
			theater_icon_lybia_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 14 } get_number_of_connected_theaters = yes } }
			theater_icon_egypt_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 15 } get_number_of_connected_theaters = yes } }
			theater_icon_sicily_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 24 } get_number_of_connected_theaters = yes } }
			theater_icon_italy_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 23 } get_number_of_connected_theaters = yes } }
			theater_icon_alpes_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 25 } get_number_of_connected_theaters = yes } }
			theater_icon_austria_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 26 } get_number_of_connected_theaters = yes } }
			theater_icon_poland_click = { if = { limit = { 3 = { can_open_theater = yes } } set_variable = { current_theater = 3 } get_number_of_connected_theaters = yes } }
			theater_icon_belarus_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 9 } get_number_of_connected_theaters = yes } }
			theater_icon_smolensk_click = { if = { limit = { can_open_theater = yes } set_variable = { current_theater = 10 } get_number_of_connected_theaters = yes } }
			theater_icon_russia_click = { set_variable = { current_theater = 11 } get_number_of_connected_theaters = yes }
			switch_asia_button_click = {
				if = {
					limit = { has_country_flag = worldstage_menu_show_europe }
					clr_country_flag = worldstage_menu_show_europe
				}
				if = {
					limit = { has_country_flag = worldstage_menu_show_ledger }
					clr_country_flag = worldstage_menu_show_ledger
				}
				set_country_flag = worldstage_menu_show_asia
			}
			switch_ledger_button_click = {
				set_country_flag = worldstage_menu_show_ledger
			}
		}
	}
	
	SS_worldstage_asia = {
		context_type = player_context
		window_name = "SS_worldstage_container_asia"
		parent_window_token = politics_tab
		dirty = show_SS_worldstage

		visible = {
			check_variable = { show_SS_worldstage = 1 }
			has_country_flag = worldstage_menu_show_asia
			NOT = { has_country_flag = worldstage_menu_show_ledger }
		}
		
		triggers = {
			map_background_asia_visible = { has_country_flag = worldstage_menu_show_asia }
			worldstage_header_asia_visible = { has_country_flag = worldstage_menu_show_asia }
			worldstage_power_display_visible = {
				has_variable = world_stage_metropolis
				NOT = { check_variable = { world_stage_metropolis = 0 } }	# should be redundant, but just in case...
				NOT = { check_variable = { world_stage_metropolis = 1 } }
			}
			worldstage_power_frame_icon_visible = {
				has_variable = world_stage_metropolis
				NOT = { check_variable = { world_stage_metropolis = 0 } }	# should be redundant, but just in case...
				NOT = { check_variable = { world_stage_metropolis = 1 } }
				NOT = { check_variable = { world_stage_metropolis = 11 } }	# internationally recognized Japan
			}
	#		theater_icon_urals_visible = { has_country_flag = worldstage_menu_show_asia }
	#		theater_icon_siberia_visible = { has_country_flag = worldstage_menu_show_asia }
	#		theater_icon_mongolia_visible = { has_country_flag = worldstage_menu_show_asia }
	#		theater_icon_tibet_visible = { has_country_flag = worldstage_menu_show_asia }
	#		theater_icon_guanxi_visible = { has_country_flag = worldstage_menu_show_asia }
	#		theater_icon_china_visible = { has_country_flag = worldstage_menu_show_asia }
	#		theater_icon_bengal_visible = { has_country_flag = worldstage_menu_show_asia }
	#		theater_icon_india_visible = { has_country_flag = worldstage_menu_show_asia }
	#		theater_icon_indies_visible = { has_country_flag = worldstage_menu_show_asia }
	#		theater_icon_philipines_visible = { has_country_flag = worldstage_menu_show_asia }
			# active front
			active_front_urals_visible = { 29 = { has_state_flag = theater_is_active } }
			active_front_siberia_visible = { 22 = { has_state_flag = theater_is_active } }
			active_front_mongolia_visible = { 2 = { has_state_flag = theater_is_active } }
			active_front_tibet_visible = { 18 = { has_state_flag = theater_is_active } }
			active_front_guanxi_visible = { 28 = { has_state_flag = theater_is_active } }
			active_front_china_visible = { 19 = { has_state_flag = theater_is_active } }
			active_front_bengal_visible = { 17 = { has_state_flag = theater_is_active } }
			active_front_india_visible = { 16 = { has_state_flag = theater_is_active } }
			active_front_indies_visible = { 20 = { has_state_flag = theater_is_active } }
			active_front_philipines_visible = { 21 = { has_state_flag = theater_is_active } }
		}
		
		effects = {
			theater_icon_urals_click = { set_variable = { current_theater = 29 } get_number_of_connected_theaters = yes }
			theater_icon_siberia_click = { set_variable = { current_theater = 22 } get_number_of_connected_theaters = yes }
			theater_icon_mongolia_click = { set_variable = { current_theater = 2 } get_number_of_connected_theaters = yes }
			theater_icon_tibet_click = { set_variable = { current_theater = 18 } get_number_of_connected_theaters = yes }
			theater_icon_guanxi_click = { set_variable = { current_theater = 28 } get_number_of_connected_theaters = yes }
			theater_icon_china_click = { set_variable = { current_theater = 19 } get_number_of_connected_theaters = yes }
			theater_icon_bengal_click = { set_variable = { current_theater = 17 } get_number_of_connected_theaters = yes }
			theater_icon_india_click = { set_variable = { current_theater = 16 } get_number_of_connected_theaters = yes }
			theater_icon_indies_click = { set_variable = { current_theater = 20 } get_number_of_connected_theaters = yes }
			theater_icon_philipines_click = { set_variable = { current_theater = 21 } get_number_of_connected_theaters = yes }
			switch_europe_button_click = {
				if = {
					limit = { has_country_flag = worldstage_menu_show_asia }
					clr_country_flag = worldstage_menu_show_asia
				}
				if = {
					limit = { has_country_flag = worldstage_menu_show_ledger }
					clr_country_flag = worldstage_menu_show_ledger
				}
				set_country_flag = worldstage_menu_show_europe
			}
			switch_ledger_button_click = {
				set_country_flag = worldstage_menu_show_ledger
			}
		}
		
		properties = {
			map_background_asian = { frame = var:global.worldstage_asia_map_frame }
			country_icon = { frame = var:world_stage_icon }
			faction_icon = { frame = var:world_stage_coalition }
			theater_icon_urals = { frame = var:29.theater_owner_coalition }
			theater_icon_siberia = { frame = var:22.theater_owner_coalition }
			theater_icon_mongolia = { frame = var:2.theater_owner_coalition }
			theater_icon_tibet = { frame = var:18.theater_owner_coalition }
			theater_icon_guanxi = { frame = var:28.theater_owner_coalition }
			theater_icon_china = { frame = var:19.theater_owner_coalition }
			theater_icon_bengal = { frame = var:17.theater_owner_coalition }
			theater_icon_india = { frame = var:16.theater_owner_coalition }
			theater_icon_indies = { frame = var:20.theater_owner_coalition }
			theater_icon_philipines = { frame = var:21.theater_owner_coalition }
		}
	}
	
	SS_worldstage_ledger = {
		context_type = player_context
		window_name = "SS_worldstage_container_ledger"
		parent_window_token = politics_tab
		dirty = show_SS_worldstage

		visible = {
			check_variable = { show_SS_worldstage = 1 }
			has_country_flag = worldstage_menu_show_ledger
		}
		
		effects = {
			switch_europe_button_click = {
				if = {
					limit = { has_country_flag = worldstage_menu_show_asia }
					clr_country_flag = worldstage_menu_show_asia
				}
				if = {
					limit = { has_country_flag = worldstage_menu_show_ledger }
					clr_country_flag = worldstage_menu_show_ledger
				}
				set_country_flag = worldstage_menu_show_europe
			}
			switch_asia_button_click = {
				if = {
					limit = { has_country_flag = worldstage_menu_show_europe }
					clr_country_flag = worldstage_menu_show_europe
				}
				if = {
					limit = { has_country_flag = worldstage_menu_show_ledger }
					clr_country_flag = worldstage_menu_show_ledger
				}
				set_country_flag = worldstage_menu_show_asia
			}
		}
	}
	
	SS_worldstage_theater = {
		context_type = player_context
		window_name = "SS_worldstage_container_theater"
		parent_window_token = politics_tab
		dirty = show_SS_worldstage
		
		visible = { NOT = { check_variable = { current_theater = 0 } has_country_flag = view_alternative_theater_display } }
		
		properties = {
			world_stage_theater_map = {
				image = "[THIS.WorldStageGetMapGfx]"
			}
		}
		
		triggers = {
			worldstage_go_to_connection_1_visible = { always = yes }
			worldstage_go_to_connection_2_visible = { if = { check_variable = { number_of_connections_displayed > 1 } } }
			worldstage_go_to_connection_3_visible = { if = { check_variable = { number_of_connections_displayed > 2 } } }
			world_stage_naval_based_theater_visible = { var:current_theater = { has_state_flag = is_navy_theater } }
			world_stage_land_based_theater_visible = { NOT = { var:current_theater = { has_state_flag = is_navy_theater } } }
			world_stage_clock_base_visible = { has_state_flag = theater_is_active }
			world_stage_clock_counter_visible = { has_state_flag = theater_is_active }
			world_stage_clock_display_visible = { has_state_flag = theater_is_active }
			world_stage_allies_header_visible = { OR = { has_world_stage_coalition_axis = no has_state_flag = theater_is_active } }
			world_stage_allies_visible = { OR = { has_world_stage_coalition_axis = no has_state_flag = theater_is_active } }
			world_stage_allies_power_display_visible = { OR = { has_world_stage_coalition_axis = no has_state_flag = theater_is_active } }
			world_stage_axis_header_visible = { OR = { has_world_stage_coalition_axis = yes has_state_flag = theater_is_active } }
			world_stage_axis_visible = { OR = { has_world_stage_coalition_axis = yes has_state_flag = theater_is_active } }
			world_stage_axis_power_display_visible = { OR = { has_world_stage_coalition_axis = yes has_state_flag = theater_is_active } }
			button_reinforce_click_enabled = { has_state_flag = theater_is_active }
			button_equipment_click_enabled = { has_state_flag = theater_is_active }	# placeholder triggers, change later
			button_offensive_click_enabled = { has_state_flag = theater_is_active }
			button_defensive_click_enabled = { has_state_flag = theater_is_active }
			button_retreat_click_enabled = { has_state_flag = theater_is_active }
		}
		
		effects = {
			button_close_theater_click = { set_variable = { current_theater = 0 } clear_alternative_theater = yes }
			worldstage_go_to_connection_1_click = {
				var:current_theater = { set_variable = { ROOT.current_theater = connects_to^0 } }
				switch_theater_displayed = yes
			}
			worldstage_go_to_connection_2_click = {
				var:current_theater = { set_variable = { ROOT.current_theater = connects_to^1 } }
				switch_theater_displayed = yes
			}
			worldstage_go_to_connection_3_click = {
				var:current_theater = { set_variable = { ROOT.current_theater = connects_to^2 } }
				switch_theater_displayed = yes
			}
			button_reinforce_click = { log = "debug: button_reinforce" }
		}
	}
	
	SS_worldstage_theater_alternative = {
		context_type = player_context
		window_name = "SS_worldstage_container_theater_alternative"
		parent_window_token = politics_tab
		dirty = show_SS_worldstage
		
		visible = { NOT = { check_variable = { current_theater = 0 } } has_country_flag = view_alternative_theater_display }
		
		properties = {
			world_stage_theater_map = {
				image = "[THIS.WorldStageGetMapGfx]"
			}
		}
		
		triggers = {
			worldstage_go_to_connection_1_visible = { always = yes }
			worldstage_go_to_connection_2_visible = { if = { check_variable = { number_of_connections_displayed > 1 } } }
			worldstage_go_to_connection_3_visible = { if = { check_variable = { number_of_connections_displayed > 2 } } }
			world_stage_naval_based_theater_visible = { var:current_theater = { has_state_flag = is_navy_theater } }
			world_stage_land_based_theater_visible = { NOT = { var:current_theater = { has_state_flag = is_navy_theater } } }
		}
		
		effects = {
			button_close_theater_click = { set_variable = { current_theater = 0 } clear_alternative_theater = yes }
			worldstage_go_to_connection_1_click = {
				var:current_theater = { set_variable = { ROOT.current_theater = connects_to^0 } }
				switch_theater_displayed = yes
			}
			worldstage_go_to_connection_2_click = {
				var:current_theater = { set_variable = { ROOT.current_theater = connects_to^1 } }
				switch_theater_displayed = yes
			}
			worldstage_go_to_connection_3_click = {
				var:current_theater = { set_variable = { ROOT.current_theater = connects_to^2 } }
				switch_theater_displayed = yes
			}
		}
	}
	
	SS_worldstage_notification_on = {
		context_type = player_context
		window_name = "SS_worldstage_notification_on"
		parent_window_token = politics_tab
		dirty = show_SS_worldstage
		
		visible = {
			NOT = { has_country_flag = hide_worldstage_notification }
			check_variable = { show_SS_worldstage = 1 }
		}
		
		effects = {
			worldstage_notification_on_button_click = { set_country_flag = hide_worldstage_notification }
		}
	}
	
	SS_worldstage_notification_off = {
		context_type = player_context
		window_name = "SS_worldstage_notification_off"
		parent_window_token = politics_tab
		dirty = show_SS_worldstage
		
		visible = {
			has_country_flag = hide_worldstage_notification
			check_variable = { show_SS_worldstage = 1 }
		}
		
		effects = {
			worldstage_notification_off_button_click = { clr_country_flag = hide_worldstage_notification }
		}
	}
}
