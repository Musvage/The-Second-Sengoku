scripted_gui = {
	TWR_UN_open = {
		context_type = player_context
		parent_window_token = politics_tab
		window_name = "TWR_UN_open_container"
		dirty = show_UN_main

		visible = {
			is_ai = no
			NOT = { has_variable = show_UN_main } 
		}

		effects = {
			view_UN_button_click = {
					set_variable = { show_UN_main = 1 }
				if = {
					limit = {
						is_in_array = { global.LON_leader = ROOT }
					}
					set_variable = { voting_button_x = 0 }
				}
				else = {
					set_variable = { voting_button_x = -1000 }
				}
			}
		}
	}

	TWR_UN_close = {
		context_type = player_context
		parent_window_token = politics_tab
		window_name = "TWR_UN_open_container"
		dirty = show_UN_main

		visible = {
			is_ai = no
			check_variable = {
				show_UN_main > 0
			}
		}

		effects = {
			view_UN_button_click = {
				if = {
					limit = { has_variable = show_UN_main }
					clear_variable = show_UN_main
				}
				if = {
					limit = {
						is_in_array = { global.LON_leader = ROOT }
					}
					set_variable = { voting_button_x = 0 }
				}
				else = {
					set_variable = { voting_button_x = -1000 }
				}
			}
		}
	}

	TWR_UN_member = {
		context_type = selected_country_context
		parent_window_token = selected_country_view_diplomacy
		window_name = "LoN_member_container"
		dirty = show_UN_main

		visible = {
			is_in_array = { global.LON_members = THIS }
		}
	}

	LoN_main = {
		context_type = player_context
		window_name = "TWR_UN_main_container"
		dirty = show_UN_main
		parent_window_token = politics_tab
		visible = {
			check_variable = { show_UN_main > 0 }
		}

		dynamic_lists = {
			LoN_leader_grid = {
				array = global.LON_leader
				change_scope = yes
				entry_container = LoN_leader_entry
			}
			LoN_members_grid = {
				array = global.LON_members
				change_scope = yes
				entry_container = LoN_members_entry
			}
			LoN_observers_grid = {
				array = global.LON_observers
				change_scope = yes
				entry_container = LoN_observers_entry
			}
		}

		effects = {
			LoN_issue_1_button_click = {
				country_event = league.1
			}
			LoN_issue_5_button_click = {	# Become member
				remove_from_array = {
					array = global.LON_observers
					value = THIS
				}
				add_to_array = { global.LON_members = THIS }
			}
			close_UN_button_click = {
				clear_variable = show_UN_main
			}
			open_resolution_button_click = {
				if = {
					limit = { has_variable = show_UN_resolution }
					clear_variable = show_UN_resolution
				}
				else = {
					set_variable = { show_UN_resolution = 1 }
				}
			}
		}

		triggers = {
			LoN_issue_1_button_click_enabled = {
				always = yes
				#check_variable = { global.un_resolution > 0 }
				#check_variable = { voted_for_resolution < 1 }
			}
			LoN_issue_5_button_click_enabled = {
				NOT = { is_in_array = { global.LON_members = THIS } }
				is_in_array = { global.LON_observers = THIS }
			}
		}

		properties = {
			TWR_UNSC_flag_icon = {
				image = "[THIS.GetFlag]"
				x = global.unsc_position_flag
			}
			LoN_flag_icon = {
				image = "[THIS.GetFlag]"
			}
			TWR_UNSC_vote_text = {
				x = global.unsc_position_text
			}
			#LoN_issue_1_button = {
			#	x = voting_button_x
			#}
		}
	}

	TWR_UN_resolution = {
		context_type = player_context
		window_name = "TWR_UN_resolution_container"
		dirty = show_UN_resolution

		visible = {
			check_variable = { show_UN_resolution > 0 }
		}

		dynamic_lists = {
			TWR_resolution_grid = {
				array = global.TWR_resolution_array
				change_scope = yes
				entry_container = TWR_resolution_entry
			}
		}

		effects = {
			close_resolution_button_click = {
				if = {
					limit = { has_variable = show_UN_resolution }
					clear_variable = show_UN_resolution
				}
				else = {
					set_variable = { show_UN_resolution = 1 }
				}
			}
		}
	}
}

