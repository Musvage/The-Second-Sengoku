world_stage_phoney_category = {

	world_stage_phoney_war_countdown_axis = {	# mission, mostly cosmetic
		icon = generic_ignite_civil_war
		
		 activation = {
			always = no
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = world_stage_phoney_war_countdown_trigger_tt
				OR = {
					4 = { has_state_flag = theater_is_active }
					5 = { has_state_flag = theater_is_active }
					8 = { has_state_flag = theater_is_active }
				}
			}
		}
		cancel_trigger = {
			custom_trigger_tooltip = { tooltip = world_stage_world_war_2_is_active_NOT NOT = { has_global_flag = world_stage_world_war_2_is_active } }
		}
		days_mission_timeout = 180
		selectable_mission = no
		timeout_effect = {
			custom_effect_tooltip = world_stage_phoney_war_countdown_effect_tt
		}
		is_good = no
	}
	
	world_stage_phoney_war_countdown_allies = {	# mission, mostly cosmetic
		icon = generic_ignite_civil_war
		
		 activation = {
			always = no
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = world_stage_phoney_war_countdown_trigger_tt
				NOT = { has_global_flag = world_stage_phoney_war_rages_on }
				NOT = { has_global_flag = world_stage_blitzkrieg_rages_on }
			}
		}
		cancel_trigger = {
			custom_trigger_tooltip = { tooltip = world_stage_world_war_2_is_active_NOT NOT = { has_global_flag = world_stage_world_war_2_is_active } }
		}
		days_mission_timeout = 180
		selectable_mission = no
		timeout_effect = {
			custom_effect_tooltip = world_stage_phoney_war_countdown_effect_tt
			hidden_effect = {
				if = {
					limit = { tag = KOB }
					news_event = worldstage.21
					clr_global_flag = world_stage_phoney_war_rages_on
				}
			}
		}
		is_good = yes
	}
}

world_stage_overlord_category = {
	
	world_stage_overlord = {
		icon = GFX_decision_generic_advancing_soldier

		available = {
			#custom_trigger_tooltip = {
			#	tooltip = theater_not_active_france
			#	8 = { NOT = { has_state_flag = theater_is_active } }
			#}
			custom_trigger_tooltip = {
				tooltip = theater_france_controlled_axis
				8 = { check_variable = { theater_owner_coalition = 3 } }
			}
			custom_trigger_tooltip = {
				tooltip = theater_not_active_england
				30 = { NOT = { has_state_flag = theater_is_active } }
			}
			custom_trigger_tooltip = {
				tooltip = theater_england_controlled_allies
				30 = { check_variable = { theater_owner_coalition = 1 } }
			}
		}

		visible = {
			tag = OSA	# make it more elegant later....
		}

		days_remove = 70
		days_re_enable = 70

		remove_effect = {
			custom_effect_tooltip = "WORK IN PROGRESS! Placeholder effect:"
			army_experience = 10
			hidden_effect = { add_to_variable = { global.overlord_number = 1 } }
		}

		ai_will_do = {
			base = 1
		}
	}
}

world_stage_sealion_category = {
	
	world_stage_sealion = {
		icon = GFX_decision_generic_advancing_soldier
		
		allowed = { tag = REI }
		
		custom_cost_trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_power > 49 } }
		}
		
		custom_cost_text = world_stage_50_power_cost

		available = {
			#custom_trigger_tooltip = {
			#	tooltip = theater_not_active_england
			#	30 = { NOT = { has_state_flag = theater_is_active } }
			#}
			custom_trigger_tooltip = {
				tooltip = theater_england_controlled_allies
				30 = { check_variable = { theater_owner_coalition = 1 } }
			}
			custom_trigger_tooltip = {
				tooltip = theater_not_active_france
				8 = { NOT = { has_state_flag = theater_is_active } }
			}
			custom_trigger_tooltip = {
				tooltip = theater_france_controlled_axis
				8 = { check_variable = { theater_owner_coalition = 3 } }
			}
		}

		visible = {
			has_global_flag = REI_sea_lion_completed	# REI's focus
		}

		days_remove = 70
		days_re_enable = 70

		remove_effect = {
			hidden_effect = { add_to_variable = { global.sealion_number = 1 } }
			set_variable = { global.sealion_strength = 50 }
			set_global_flag = world_stage_sealion_preparing
			set_temp_variable = { chance_success = global.sealion_strength } multiply_temp_variable = { chance_success = chance_success }
			random_list = {
				var:chance_success = { custom_effect_tooltip = "SUCESS" }
				2500 = { custom_effect_tooltip = "FAILURE" }
			}
		}
		
		complete_effect = {
			hidden_effect = {
			set_variable = { global.sealion_strength = 0 }
				add_to_variable = { global.sealion_number = 1 }
				set_global_flag = world_stage_sealion_preparing
				var:world_stage_metropolis = { subtract_from_variable = { world_stage_power = 50 } }
			}
			add_to_variable = { global.sealion_strength = 50 tooltip = world_stage_sealion_increase_var_tt }
		}

		ai_will_do = {
			base = 1
		}
	}
	
	world_stage_sealion_increase = {
		
		allowed = { tag = REI }
		
		custom_cost_trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_power > 29 } }
		}
		
		custom_cost_text = world_stage_30_power_cost

		available = {
			has_decision = world_stage_sealion
		}

		visible = {
			has_global_flag = REI_sea_lion_completed	# REI's focus
		}

		days_remove = 14
		days_re_enable = 21


		complete_effect = {
			set_temp_variable = { chance_success = 100 } 101 = { multiply_temp_variable = { chance_success = doctrine_bonus_air } }
			set_temp_variable = { chance_failure = 100 } 102 = { multiply_temp_variable = { chance_failure = doctrine_bonus_air } }
			random_list = { 
				var:chance_failure = {	add_to_variable = { global.sealion_strength = 10 tooltip = world_stage_sealion_increase_var_tt } }
				200 = {					add_to_variable = { global.sealion_strength = 20 tooltip = world_stage_sealion_increase_var_tt } }
				var:chance_success = {	add_to_variable = { global.sealion_strength = 30 tooltip = world_stage_sealion_increase_var_tt } }
			}
			hidden_trigger = { var:world_stage_metropolis = { subtract_from_variable = { world_stage_power = 30 } } }
		}

		ai_will_do = {
			base = 1
		}
	}
	
	world_stage_sealion_defend = {
		
		allowed = { tag = OSA }
		
		custom_cost_trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_power > 19 } }
		}
		
		custom_cost_text = world_stage_20_power_cost

		available = {
			has_decision = world_stage_sealion
		}

		available = {
			has_global_flag = world_stage_sealion_preparing
		}

		visible = {
			has_global_flag = REI_sea_lion_completed	# REI's focus
			has_global_flag = world_stage_sealion_preparing
		}


		days_remove = 14
		days_re_enable = 21

		cost = 100

		complete_effect = {
			set_temp_variable = { chance_success = 100 } 102 = { multiply_temp_variable = { chance_success = doctrine_bonus_air } }
			set_temp_variable = { chance_failure = 100 } 101 = { multiply_temp_variable = { chance_failure = doctrine_bonus_air } }
			random_list = { 
				var:chance_failure = {	subtract_from_variable = { global.sealion_strength = 10 tooltip = world_stage_sealion_defend_var_tt } }
				200 = {					subtract_from_variable = { global.sealion_strength = 20 tooltip = world_stage_sealion_defend_var_tt } }
				var:chance_success = {	subtract_from_variable = { global.sealion_strength = 30 tooltip = world_stage_sealion_defend_var_tt } }
			}
			hidden_trigger = { var:world_stage_metropolis = { subtract_from_variable = { world_stage_power = 30 } } }
		}

		ai_will_do = {
			base = 1
		}
	}
	
	world_stage_sealion_abort = {
	
		allowed = { tag = REI }
		
		custom_cost_trigger = {
			command_power > 24.9
		}
		
		custom_cost_text = world_stage_25_cp_cost

		available = {
			has_decision = world_stage_sealion
		}

		visible = {
			has_global_flag = REI_sea_lion_completed	# REI's focus
		}

		days_remove = 70
		days_re_enable = 70

		cost = 100

		complete_effect = {
			remove_decision = world_stage_sealion
			# retreives portion of deployed power
			set_variable = { global.sealion_strength = 0 }
			hidden_effect = { add_command_power = -25 }
		}

		ai_will_do = {
			base = 1
		}
	}
}

world_stage_husky_category = {
	
	world_stage_husky = {
		icon = GFX_decision_generic_advancing_soldier

		available = {
			#custom_trigger_tooltip = {
			#	tooltip = theater_not_active_sicily
			#	24 = { NOT = { has_state_flag = theater_is_active } }
			#}
			custom_trigger_tooltip = {
				tooltip = theater_sicily_controlled_axis
				24 = { check_variable = { theater_owner_coalition = 3 } }
			}
			custom_trigger_tooltip = {
				tooltip = theater_not_active_lybia
				14 = { NOT = { has_state_flag = theater_is_active } }
			}
			custom_trigger_tooltip = {
				tooltip = theater_lybia_controlled_allies
				14 = { check_variable = { theater_owner_coalition = 1 } }
			}
		}

		visible = {
			tag = OSA	# make it more elegant later....
		}


		days_remove = 70
		days_re_enable = 70

		cost = 100

		remove_effect = {
			custom_effect_tooltip = "WORK IN PROGRESS! Placeholder effect:"
			army_experience = 10
			hidden_effect = { add_to_variable = { global.husky_number = 1 } }
		}

		ai_will_do = {
			base = 1
		}
	}
}

world_stage_torch_category = {
	
	world_stage_torch = {
		icon = GFX_decision_generic_advancing_soldier

		available = {
			#custom_trigger_tooltip = {
			#	tooltip = theater_not_active_lybia
			#	14 = { NOT = { has_state_flag = theater_is_active } }
			#}
			custom_trigger_tooltip = {
				tooltip = theater_lybia_controlled_axis
				14 = { check_variable = { theater_owner_coalition = 3 } }
			}
			custom_trigger_tooltip = {
				tooltip = world_stage_usa_is_allies
				105 = { check_variable = { world_stage_coalition = 1 } }
			}
		}

		visible = {
			tag = OSA	# make it more elegant later....
		}


		days_remove = 70
		days_re_enable = 70

		cost = 100

		remove_effect = {
			custom_effect_tooltip = "WORK IN PROGRESS! Placeholder effect:"
			army_experience = 10
			hidden_effect = { add_to_variable = { global.torch_number = 1 } }
		}

		ai_will_do = {
			base = 1
		}
	}
}