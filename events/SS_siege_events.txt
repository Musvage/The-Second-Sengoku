add_namespace = siege

# Edo surrenders (siege progress reached 100%)
news_event = {
	id = siege.0
	title = siege.0.t
	desc = siege.0.d
	picture = GFX_news_siege_surrender_1

	is_triggered_only = yes
	
	major = yes
	
	immediate = {
		hidden_effect = {
			ROOT = {
				delete_unit = { 
					state = 29
					disband = no #w ill no refund equipment and manpower
				}
				if = {
					limit = { has_variable  = siege_war_support }
					add_to_variable = { siege_war_support = -0.1 }
				} else = {
					set_variable = { siege_war_support = -0.1 }
				}
				if = {
					limit = {
						any_enemy_country = {
							is_faction_leader = yes
							OR = {
								controls_province = 3722
								controls_province = 1342
								controls_province = 932
								controls_province = 770
								controls_province = 3703
								controls_province = 53
							}
						}
					}
					random_enemy_country = {
						limit = {
							is_faction_leader = yes
							OR = {
								controls_province = 3722
								controls_province = 1342
								controls_province = 932
								controls_province = 770
								controls_province = 3703
								controls_province = 53
							}
						}
						set_state_controller = 29
					}
				} else = {
					random_enemy_country = {
						limit = {
							OR = {
								controls_province = 3722
								controls_province = 1342
								controls_province = 932
								controls_province = 770
								controls_province = 3703
								controls_province = 53
							}
						}
						set_state_controller = 29
					}
				}
			}
		}
	}
	
	option = {	# DEFENDER
		name = siege.0.a
		trigger = {
			OR = {
				tag = ROOT
				is_in_faction_with = ROOT
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# ATTACKER
		name = siege.0.b
		trigger = {
			OR = {
				OR = {
					controls_province = 3722
					any_allied_country = { controls_province = 3722 }
				}
				OR = {
					controls_province = 1342
					any_allied_country = { controls_province = 1342 }
				}
				OR = {
					controls_province = 932
					any_allied_country = { controls_province = 932 }
				}
				OR = {
					controls_province = 770
					any_allied_country = { controls_province = 770 }
				}
				OR = {
					controls_province = 3703
					any_allied_country = { controls_province = 3703 }
				}
				OR = {
					controls_province = 53
					any_allied_country = { controls_province = 53 }
				}
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# NEUTRAL
		name = siege.0.c
		trigger = {
			NOT = {
				tag = ROOT
				is_in_faction_with = ROOT
				has_war_with = ROOT
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
}

# Edo is taken (siege progress did not reach 100%)
news_event = {
	id = siege.1
	title = siege.1.t
	desc = siege.1.d
	picture = GFX_news_siege_surrender_1

	is_triggered_only = yes
	
	major = yes
	
	option = {	# DEFNDER
		name = siege.1.a
		trigger = {
			OR = {
				tag = ROOT
				is_in_faction_with = ROOT
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# ATTACKER
		name = siege.1.b
		trigger = {
			OR = {
				tag = ROOT.PREV
				is_in_faction_with = ROOT.PREV
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# NEUTRAL
		name = siege.1.c
		trigger = {
			NOT = {
				tag = ROOT
				is_in_faction_with = ROOT
				tag = ROOT.PREV
				is_in_faction_with = ROOT.PREV
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
}

# Edo is relieved (siege progress did not reach 100%)
news_event = {
	id = siege.2
	title = siege.2.t
	desc = siege.2.d
	picture = GFX_news_siege_relieve_1

	is_triggered_only = yes
	
	major = yes
	
	option = {	# DEFNDER
		name = siege.2.a
		trigger = {
			OR = {
				tag = ROOT
				is_in_faction_with = ROOT
			}
		}
	}
	option = {	# ATTACKER
		name = siege.2.b
		trigger = {
			has_war_with = ROOT
		}
	}
	option = {	# NEUTRAL
		name = siege.2.c
		trigger = {
			NOT = {
				tag = ROOT
				is_in_faction_with = ROOT
				has_war_with = ROOT
			}
		}
	}
}