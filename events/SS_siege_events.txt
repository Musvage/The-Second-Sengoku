add_namespace = surrender
add_namespace = capture
add_namespace = relieve

# Edo surrenders (siege progress reached 100%)
news_event = {
	id = surrender.29
	title = surrender.29.t
	desc = surrender.29.d
	picture = GFX_news_siege_surrender_1

	is_triggered_only = yes
	
	major = yes
	
	immediate = {
		hidden_effect = {
			ROOT = {
				delete_unit = { 
					state = 29
					disband = no #w ill no refund equipment and manpower
				}
				if = {
					limit = { has_variable  = siege_war_support }
					add_to_variable = { siege_war_support = -0.1 }
				} else = {
					set_variable = { siege_war_support = -0.1 }
				}
				if = {
					limit = {
						any_enemy_country = {
							is_faction_leader = yes
							OR = {
								controls_province = 1658
								controls_province = 1342
								controls_province = 932
								controls_province = 770
								controls_province = 3703
								controls_province = 53
							}
						}
					}
					random_enemy_country = {
						limit = {
							is_faction_leader = yes
							OR = {
								controls_province = 1658
								controls_province = 1342
								controls_province = 932
								controls_province = 770
								controls_province = 3703
								controls_province = 53
							}
						}
						set_state_controller = 29
					}
				} else = {
					random_enemy_country = {
						limit = {
							OR = {
								controls_province = 1658
								controls_province = 1342
								controls_province = 932
								controls_province = 770
								controls_province = 3703
								controls_province = 53
							}
						}
						set_state_controller = 29
					}
				}
			}
		}
	}
	
	option = {	# DEFENDER
		name = surrender.29.a
		trigger = {
			OR = {
				tag = ROOT
				is_in_faction_with = ROOT
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# ATTACKER
		name = surrender.29.b
		trigger = {
			OR = {
				OR = {
					controls_province = 1658
					any_allied_country = { controls_province = 1658 }
				}
				OR = {
					controls_province = 1342
					any_allied_country = { controls_province = 1342 }
				}
				OR = {
					controls_province = 932
					any_allied_country = { controls_province = 932 }
				}
				OR = {
					controls_province = 770
					any_allied_country = { controls_province = 770 }
				}
				OR = {
					controls_province = 3703
					any_allied_country = { controls_province = 3703 }
				}
				OR = {
					controls_province = 53
					any_allied_country = { controls_province = 53 }
				}
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# NEUTRAL
		name = surrender.29.c
		trigger = {
			NOT = {
				tag = ROOT
				is_in_faction_with = ROOT
				has_war_with = ROOT
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
}

# Edo is taken (siege progress did not reach 100%)
news_event = {
	id = capture.29
	title = capture.29.t
	desc = capture.29.d
	picture = GFX_news_siege_surrender_1

	is_triggered_only = yes
	
	major = yes
	
	option = {	# DEFNDER
		name = capture.29.a
		trigger = {
			OR = {
				tag = ROOT
				is_in_faction_with = ROOT
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# ATTACKER
		name = capture.29.b
		trigger = {
			OR = {
				tag = ROOT.PREV
				is_in_faction_with = ROOT.PREV
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# NEUTRAL
		name = capture.29.c
		trigger = {
			NOT = {
				tag = ROOT
				is_in_faction_with = ROOT
				tag = ROOT.PREV
				is_in_faction_with = ROOT.PREV
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
}

# Edo is relieved (siege progress did not reach 100%)
news_event = {
	id = relieve.29
	title = relieve.29.t
	desc = relieve.29.d
	picture = GFX_news_siege_relieve_1

	is_triggered_only = yes
	
	major = yes
	
	option = {	# DEFNDER
		name = relieve.29.a
		trigger = {
			OR = {
				tag = ROOT
				is_in_faction_with = ROOT
			}
		}
	}
	option = {	# ATTACKER
		name = relieve.29.b
		trigger = {
			has_war_with = ROOT
		}
	}
	option = {	# NEUTRAL
		name = relieve.29.c
		trigger = {
			NOT = {
				tag = ROOT
				is_in_faction_with = ROOT
				has_war_with = ROOT
			}
		}
	}
}

# Nagoya surrenders (siege progress reached 100%)
news_event = {
	id = surrender.211
	title = surrender.211.t
	desc = surrender.211.d
	picture = GFX_news_siege_surrender_1

	is_triggered_only = yes
	
	major = yes
	
	immediate = {
		hidden_effect = {
			ROOT = {
				delete_unit = { 
					state = 211
					disband = no #w ill no refund equipment and manpower
				}
				if = {
					limit = { has_variable  = siege_war_support }
					add_to_variable = { siege_war_support = -0.1 }
				} else = {
					set_variable = { siege_war_support = -0.1 }
				}
				if = {
					limit = {
						any_enemy_country = {
							is_faction_leader = yes
							OR = {
								controls_province = 220
								controls_province = 3425
								controls_province = 3388
								controls_province = 1365
								controls_province = 3440
								controls_province = 113
								controls_province = 1430
							}
						}
					}
					random_enemy_country = {
						limit = {
							is_faction_leader = yes
							OR = {
								controls_province = 220
								controls_province = 3425
								controls_province = 3388
								controls_province = 1365
								controls_province = 3440
								controls_province = 113
								controls_province = 1430
							}
						}
						set_state_controller = 211
					}
				} else = {
					random_enemy_country = {
						limit = {
							OR = {
								controls_province = 220
								controls_province = 3425
								controls_province = 3388
								controls_province = 1365
								controls_province = 3440
								controls_province = 113
								controls_province = 1430
							}
						}
						set_state_controller = 211
					}
				}
			}
		}
	}
	
	option = {	# DEFENDER
		name = surrender.211.a
		trigger = {
			OR = {
				tag = ROOT
				is_in_faction_with = ROOT
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# ATTACKER
		name = surrender.211.b
		trigger = {
			OR = {
				OR = {
					controls_province = 220
					any_allied_country = { controls_province = 220 }
				}
				OR = {
					controls_province = 3425
					any_allied_country = { controls_province = 3425 }
				}
				OR = {
					controls_province = 3388
					any_allied_country = { controls_province = 3388 }
				}
				OR = {
					controls_province = 1365
					any_allied_country = { controls_province = 1365 }
				}
				OR = {
					controls_province = 3440
					any_allied_country = { controls_province = 3440 }
				}
				OR = {
					controls_province = 113
					any_allied_country = { controls_province = 113 }
				}
				OR = {
					controls_province = 1430
					any_allied_country = { controls_province = 1430 }
				}
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# NEUTRAL
		name = surrender.211.c
		trigger = {
			NOT = {
				tag = ROOT
				is_in_faction_with = ROOT
				has_war_with = ROOT
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
}

# Nagoya is taken (siege progress did not reach 100%)
news_event = {
	id = capture.211
	title = capture.211.t
	desc = capture.211.d
	picture = GFX_news_siege_surrender_1

	is_triggered_only = yes
	
	major = yes
	
	option = {	# DEFNDER
		name = capture.211.a
		trigger = {
			OR = {
				tag = ROOT
				is_in_faction_with = ROOT
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# ATTACKER
		name = capture.211.b
		trigger = {
			OR = {
				tag = ROOT.PREV
				is_in_faction_with = ROOT.PREV
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
	option = {	# NEUTRAL
		name = capture.211.c
		trigger = {
			NOT = {
				tag = ROOT
				is_in_faction_with = ROOT
				tag = ROOT.PREV
				is_in_faction_with = ROOT.PREV
			}
		}
		ROOT = { effect_tooltip = { add_war_support = -0.1 } }
	}
}

# Nagoya is relieved (siege progress did not reach 100%)
news_event = {
	id = relieve.211
	title = relieve.211.t
	desc = relieve.211.d
	picture = GFX_news_siege_relieve_1

	is_triggered_only = yes
	
	major = yes
	
	option = {	# DEFNDER
		name = relieve.211.a
		trigger = {
			OR = {
				tag = ROOT
				is_in_faction_with = ROOT
			}
		}
	}
	option = {	# ATTACKER
		name = relieve.211.b
		trigger = {
			has_war_with = ROOT
		}
	}
	option = {	# NEUTRAL
		name = relieve.211.c
		trigger = {
			NOT = {
				tag = ROOT
				is_in_faction_with = ROOT
				has_war_with = ROOT
			}
		}
	}
}