### EVENTS for diplomatic and military plays in the WORLD STAGE
															   #and we are merely players
add_namespace = worldstage #(scripted & focuses)			   #performers and portrayers
add_namespace = worldstage_automatic						   #each anothers audience outside the gilded cage										   
add_namespace = worldstage_surrender
add_namespace = worldstage_news

########################################################################
############################## worldstage ##############################	# the ones here are actually in the game
########################################################################

### INVASION OF POLAND

# Invasion of Poland - Start of WW2
news_event = {
	id = worldstage.15
	title = worldstage.15.t
	desc = {
		text = worldstage.15.d1
		trigger = { NOT = { REI = { has_government = autocracy } } }	# normal event
	}
	desc = {
		text = worldstage.15.d2
		trigger = { REI = { has_government = autocracy } }  			# monarchist event (cannot use 2nd leader text)
	}
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					country_exists = OSA
					country_exists = KOB
					NOT = { KOB = { is_in_faction_with = OSA } }
				}
				OSA = { add_to_faction = KOB }
			}
			set_global_flag = world_stage_phoney_war_rages_on
			every_country = {
				limit = { check_variable = { world_stage_metropolis > 100 } }
				if = {
					limit = {
						OR = {
							tag = KOB
							tag = OSA
							has_country_flag = will_join_allies
						}
					}
					activate_mission = world_stage_phoney_war_countdown_allies
				} else = {	# everyone else gets the axis versions
					activate_mission = world_stage_phoney_war_countdown_axis
				}
			}
		}
	}
	
	option = {
		name = worldstage.15.axis
		trigger = { OR = { check_variable = { world_stage_coalition = 3 } check_variable = { world_stage_coalition = 6 } } }
		if = {
			limit = { check_variable = { world_stage_metropolis > 100 } }
			effect_tooltip = { activate_mission = world_stage_phoney_war_countdown_axis }
		}
	}
	option = {
		name = worldstage.15.komin1
		trigger = {
			check_variable = { world_stage_coalition = 2 }
			NOT = { has_global_flag = GER_SOV_pact_enabled }
		}
		if = {
			limit = { check_variable = { world_stage_metropolis > 100 } }
			effect_tooltip = { activate_mission = world_stage_phoney_war_countdown_axis }
		}
	}
	option = {
		name = worldstage.15.komin2
		trigger = {
			check_variable = { world_stage_coalition = 2 }
			has_global_flag = GER_SOV_pact_enabled
		}
		if = {
			limit = { check_variable = { world_stage_metropolis > 100 } }
			effect_tooltip = { activate_mission = world_stage_phoney_war_countdown_axis }
		}
	}
	option = {
		name = worldstage.15.allies
		trigger = { OR = { check_variable = { world_stage_coalition = 1 } check_variable = { world_stage_coalition = 5 } } }
		if = {
			limit = { check_variable = { world_stage_metropolis > 100 } }
			effect_tooltip = { activate_mission = world_stage_phoney_war_countdown_axis }
		}
	}
	option = {
		name = worldstage.15.other
		trigger = {
			OR = { check_variable = { world_stage_coalition = 4 } NOT = { has_variable = world_stage_coalition } }
		}
		if = {
			limit = { check_variable = { world_stage_metropolis > 100 } }
			effect_tooltip = { activate_mission = world_stage_phoney_war_countdown_axis }
		}
	}
}

# Invasion of Poland - Soviet Invasion
news_event = {
	id = worldstage.16
	title = worldstage.16.t
	desc = worldstage.16.d 
	picture = GFX_news_nazi_soviet_handshake_wide

	is_triggered_only = yes

	major = yes
	
	immediate = {
		hidden_effect = {
			world_stage_end_invasion_of_poland = yes
		}
	}
	
	option = {
		name = worldstage.16.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		custom_effect_tooltip = worldstage.16.tt_green
		custom_effect_tooltip = worldstage.16.tt_inactive
	}
	option = {
		name = worldstage.16.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		custom_effect_tooltip = worldstage.16.tt_green
		custom_effect_tooltip = worldstage.16.tt_inactive
	}
	option = {
		name = worldstage.16.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		custom_effect_tooltip = worldstage.16.tt_red
		custom_effect_tooltip = worldstage.16.tt_inactive
	}
	option = {
		name = worldstage.16.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		custom_effect_tooltip = worldstage.16.tt_orange
		custom_effect_tooltip = worldstage.16.tt_inactive
	}
}

# Invasion of Germany - Phoney War Ends!
news_event = {
	id = worldstage.21
	title = worldstage.21.t
	desc = worldstage.21.d 
	picture = GFX_news_ww2_saarland_wide

	is_triggered_only = yes

	major = yes
	
	immediate = {
		hidden_effect = {
			103 = {
				set_temp_variable = { french_forces = world_stage_power }
				clamp_temp_variable = { var = french_forces min = 0 max = 90 }
				round_temp_variable = french_forces
				subtract_from_variable = { world_stage_power = french_forces }
			}
			101 = {
				set_temp_variable = { german_forces = world_stage_power }
				divide_temp_variable = { german_forces = 2 }
				round_temp_variable german_forces
				clamp_temp_variable = { var = german_forces min = 0 max = 60 }
				subtract_from_variable = { world_stage_power = german_forces }
			}
			6 = { # proxy for Western Germany
				set_state_flag = theater_is_active
				add_to_variable = { world_stage_power_deployed_by^103 = french_forces }
				add_to_variable = { world_stage_power_deployed_by^101 = german_forces }
				set_variable = { coalition_side_attack = 1 }
				world_stage_state_update_current_day = yes
			}
			news_event = worldstage.53
		}
	}
	
	option = {
		name = worldstage.21.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		hidden_effect = {	6 = { set_temp_variable = { ger_for = world_stage_power_deployed_by^101 } }
							6 = { set_temp_variable = { fra_for = world_stage_power_deployed_by^103 } } }
		effect_tooltip  = {
			custom_effect_tooltip = theater_scope_westphalia
			custom_effect_tooltip = world_stage_activate_theater_tt
			custom_effect_tooltip = metropolis_scope_france
			subtract_from_variable = {
				103.world_stage_power = fra_for
				tooltip = world_stage_deploy_power_westphalia_space
			}
			custom_effect_tooltip = metropolis_scope_germany
			subtract_from_variable = {	#
				101.world_stage_power = ger_for
				tooltip = world_stage_deploy_power_westphalia_space
			}
		}
	}
	option = {
		name = worldstage.21.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		hidden_effect = {	6 = { set_temp_variable = { ger_for = world_stage_power_deployed_by^101 } }
							6 = { set_temp_variable = { fra_for = world_stage_power_deployed_by^103 } } }
		effect_tooltip  = {
			custom_effect_tooltip = theater_scope_westphalia
			custom_effect_tooltip = world_stage_activate_theater_tt
			custom_effect_tooltip = metropolis_scope_france
			subtract_from_variable = {
				103.world_stage_power = fra_for
				tooltip = world_stage_deploy_power_westphalia_space
			}
			custom_effect_tooltip = metropolis_scope_germany
			subtract_from_variable = {	#
				101.world_stage_power = ger_for
				tooltip = world_stage_deploy_power_westphalia_space
			}
		}
	}
	option = {
		name = worldstage.21.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		hidden_effect = {	6 = { set_temp_variable = { ger_for = world_stage_power_deployed_by^101 } }
							6 = { set_temp_variable = { fra_for = world_stage_power_deployed_by^103 } } }
		effect_tooltip  = {
			custom_effect_tooltip = theater_scope_westphalia
			custom_effect_tooltip = world_stage_activate_theater_tt
			custom_effect_tooltip = metropolis_scope_france
			subtract_from_variable = {
				103.world_stage_power = fra_for
				tooltip = world_stage_deploy_power_westphalia_space
			}
			custom_effect_tooltip = metropolis_scope_germany
			subtract_from_variable = {	#
				101.world_stage_power = ger_for
				tooltip = world_stage_deploy_power_westphalia_space
			}
		}
	}
	option = {
		name = worldstage.21.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		hidden_effect = {	6 = { set_temp_variable = { ger_for = world_stage_power_deployed_by^101 } }
							6 = { set_temp_variable = { fra_for = world_stage_power_deployed_by^103 } } }
		effect_tooltip  = {
			custom_effect_tooltip = theater_scope_westphalia
			custom_effect_tooltip = world_stage_activate_theater_tt
			custom_effect_tooltip = metropolis_scope_france
			subtract_from_variable = {
				103.world_stage_power = fra_for
				tooltip = world_stage_deploy_power_westphalia_space
			}
			custom_effect_tooltip = metropolis_scope_germany
			subtract_from_variable = {	#
				101.world_stage_power = ger_for
				tooltip = world_stage_deploy_power_westphalia_space
			}
		}
	}
}

# The Blitzkrieg!
news_event = {
	id = worldstage.24
	title = worldstage.24.t
	desc = worldstage.24.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes #show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	option = {
		name = worldstage.24.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		hidden_effect = {	5 = { set_temp_variable = { ger_for = world_stage_power_deployed_by^101 } }
							5 = { set_temp_variable = { fra_for = world_stage_power_deployed_by^103 } } }
		effect_tooltip  = {
			custom_effect_tooltip = theater_scope_alsace
			custom_effect_tooltip = world_stage_activate_theater_tt
			custom_effect_tooltip = metropolis_scope_france
			subtract_from_variable = {
				103.world_stage_power = fra_for
				tooltip = world_stage_deploy_power_alsace_space
			}
			custom_effect_tooltip = metropolis_scope_germany
			subtract_from_variable = {	#
				101.world_stage_power = ger_for
				tooltip = world_stage_deploy_power_alsace_space
			}
		}
	}
	option = {
		name = worldstage.24.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		hidden_effect = {	5 = { set_temp_variable = { ger_for = world_stage_power_deployed_by^101 } }
							5 = { set_temp_variable = { fra_for = world_stage_power_deployed_by^103 } } }
		effect_tooltip  = {
			custom_effect_tooltip = theater_scope_alsace
			custom_effect_tooltip = world_stage_activate_theater_tt
			custom_effect_tooltip = metropolis_scope_france
			subtract_from_variable = {
				103.world_stage_power = fra_for
				tooltip = world_stage_deploy_power_alsace_space
			}
			custom_effect_tooltip = metropolis_scope_germany
			subtract_from_variable = {	#
				101.world_stage_power = ger_for
				tooltip = world_stage_deploy_power_alsace_space
			}
		}
	}
	option = {
		name = worldstage.24.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		hidden_effect = {	5 = { set_temp_variable = { ger_for = world_stage_power_deployed_by^101 } }
							5 = { set_temp_variable = { fra_for = world_stage_power_deployed_by^103 } } }
		effect_tooltip  = {
			custom_effect_tooltip = theater_scope_alsace
			custom_effect_tooltip = world_stage_activate_theater_tt
			custom_effect_tooltip = metropolis_scope_france
			subtract_from_variable = {
				103.world_stage_power = fra_for
				tooltip = world_stage_deploy_power_alsace_space
			}
			custom_effect_tooltip = metropolis_scope_germany
			subtract_from_variable = {	#
				101.world_stage_power = ger_for
				tooltip = world_stage_deploy_power_alsace_space
			}
		}
	}
	option = {
		name = worldstage.24.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		hidden_effect = {	5 = { set_temp_variable = { ger_for = world_stage_power_deployed_by^101 } }
							5 = { set_temp_variable = { fra_for = world_stage_power_deployed_by^103 } } }
		effect_tooltip  = {
			custom_effect_tooltip = theater_scope_alsace
			custom_effect_tooltip = world_stage_activate_theater_tt
			custom_effect_tooltip = metropolis_scope_france
			subtract_from_variable = {
				103.world_stage_power = fra_for
				tooltip = world_stage_deploy_power_alsace_space
			}
			custom_effect_tooltip = metropolis_scope_germany
			subtract_from_variable = {	#
				101.world_stage_power = ger_for
				tooltip = world_stage_deploy_power_alsace_space
			}
		}
	}
}

# The Blitzkrieg - France Falls to Blitzkrieg
country_event = {
	id = worldstage.25
	title = worldstage.25.t
	desc = worldstage.25.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	immediate = {
		hidden_effect = {
			every_possible_country = {
				limit = { tag = KOB }
				news_event = { id = worldstage_surrender.103 hours = 24 random = 24 }
			}
		}
	}

	option = {
		name = worldstage.25.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			if = { limit = { country_exists = KOB }	KOB = { add_war_support = -0.1 } }
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = -0.05 }
		}
		custom_effect_tooltip = metropolis_scope_vichy
		custom_effect_tooltip = join_coalition_axis_good
	}
	option = {
		name = worldstage.25.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			if = { limit = { country_exists = KOB }	KOB = { add_war_support = -0.1 } }
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = -0.05 }
		}
		custom_effect_tooltip = metropolis_scope_vichy
		if = {
			limit = { has_global_flag = GER_SOV_pact_enabled }
			custom_effect_tooltip = join_coalition_axis_good
		} else = {
			custom_effect_tooltip = join_coalition_axis
		}
	}
	option = {
		name = worldstage.25.allies1
		trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } }
			tag = KOB
		}
		add_war_support = -0.1
		effect_tooltip = {
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = -0.05 }
		}
		custom_effect_tooltip = metropolis_scope_vichy
		custom_effect_tooltip = join_coalition_axis_bad
	}
	option = {
		name = worldstage.25.allies2
		trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } }
			NOT = { tag = KOB }
		}
		effect_tooltip = {
			if = { limit = { country_exists = KOB }	add_war_support = -0.1 }
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = -0.05 }
		}
		hidden_effect = { add_war_support = -0.05 }
		custom_effect_tooltip = metropolis_scope_vichy
		custom_effect_tooltip = join_coalition_axis_bad
	}
	option = {
		name = worldstage.25.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
			if = { limit = { country_exists = KOB }	add_war_support = -0.1 }
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = -0.05 }
		}
		custom_effect_tooltip = metropolis_scope_vichy
		custom_effect_tooltip = join_coalition_axis
	}
}

# The Blitzkrieg - France Resists
country_event = {
	id = worldstage.26
	title = worldstage.26.t
	desc = worldstage.26.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	option = {
		name = worldstage.26.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			if = { limit = { country_exists = KOB }	add_war_support = 0.1 }
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = 0.05 }
		}
	}
	option = {
		name = worldstage.26.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			if = { limit = { country_exists = KOB }	add_war_support = 0.1 }
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = 0.05 }
		}
	}
	option = {
		name = worldstage.26.allies1
		trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } }
			tag = KOB
		}
		add_war_support = 0.1
		effect_tooltip = {
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = 0.05 }
		}
	}
	option = {
		name = worldstage.26.allies2
		trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } }
			NOT = { tag = KOB }
		}
		effect_tooltip = {
			if = { limit = { country_exists = KOB }	add_war_support = 0.1 }
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = 0.05 }
		}
		hidden_effect = { add_war_support = 0.05 }
	}
	option = {
		name = worldstage.26.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
			if = { limit = { country_exists = KOB }	add_war_support = 0.1 }
			every_country = { limit = { NOT = { tag = KOB } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } } add_war_support = 0.05 }
		}
	}
}

# HIDDEN EVENT Phoney War Ends!
country_event = {
	id = worldstage.53
	title = worldstage.53.t
	desc = worldstage.53.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	hidden = yes
	
	immediate = {
		clr_global_flag = phoney_war_rages_on
		if = {
			limit = { country_exists = REI }
			every_country = {
				limit = { check_variable = { var:world_stage_metropolis = { world_stage_coalition = 1 } } }
				REI = {	declare_war_on = { target = PREV type = annex_everything } }
			}
			
		} else = {
			random_country = {
				limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
				set_temp_variable = { axis_leader = THIS.id}
				every_country = {
					limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
					var:axis_leader = {	declare_war_on = { target = PREV type = annex_everything } }
				}
			}
		}
	}	
}

# URSS is expelled from the League of Nations
news_event = {
	id = worldstage.54
	title = worldstage.54.t
	desc = worldstage.54.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes
	
	immediate = {
		set_global_flag = SOV_expelled_from_lon
		every_country = {
			limit = { check_variable = { world_stage_metropolis = 104 } }
			set_variable = { world_stage_coalition = 2 }
		}
		every_state = {
			limit = { check_variable = { theater_owner = 104 } }	# proxy for sovietunion
			set_variable = { theater_owner_coalition = 2 }
		}
	}
	
	option = {
		name = worldstage.54.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			
		}
	}
	option = {
		name = worldstage.54.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			
		}
		if = {
			limit = { tag = FER has_game_rule = { rule = censored_or_uncensored_german_flag option = UNCENSORED } }
			custom_effect_tooltip = worldstage.54.special
		}
	}
	option = {
		name = worldstage.54.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		effect_tooltip = {
			
		}
	}
	option = {
		name = worldstage.54.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
			
		}
	}
}

# The End of the League of Nations
news_event = {
	id = worldstage.55
	title = worldstage.55.t
	desc = worldstage.55.d 
	picture = GFX_news_lon_ends_wide

	is_triggered_only = yes

	major = yes
	
	immediate = {
		hidden_effect = {
			log = "Begone!, League of Nations!"
			every_country = {
				limit = { has_idea = SS_lon_member }
				remove_ideas = SS_lon_member
			}
			every_country = {
				limit = { has_idea = SS_lon_member_japan }
				remove_ideas = SS_lon_member_japan
			}
			clr_global_flag = leagueofnations_exists
			set_global_flag = SOV_already_expelled
			# the 'Great Swithceroo of Coalitions" happens here
			# first: run specific tags
			# second: run tags that may contain relevant infomation
			# third: run proxy metropolis for off-map countries with no tags in game
			# first:
			OSA = { set_variable = { world_stage_coalition = 1 } }
			KOB = { set_variable = { world_stage_coalition = 1 } }
			FER = { set_variable = { world_stage_coalition = 2 } }		# URSS was already expelled from LoN at this point but we'll run the command again just in case the FER player did not play his part 
			REI = { set_variable = { world_stage_coalition = 3 } }
			115 = { set_variable = { world_stage_coalition = 1 } }		# Poland is off map
			120 = { set_variable = { world_stage_coalition = 3 } }		# Vichy France is off map
			# second:
			every_country = {
				limit = { has_country_flag = will_join_allies }
				set_variable = { world_stage_coalition = 1 }
			}
			every_country = {
				limit = { has_country_flag = will_join_komintern }
				set_variable = { world_stage_coalition = 2 }
			}
			every_country = {
				limit = { check_variable = { world_stage_coalition = 6 } }
				set_variable = { world_stage_coalition = 3 }
			}
			every_country = {
				limit = {
					NOT = { has_country_flag = will_join_allies has_country_flag = will_join_komintern }	# every one that belongs to LoN but has not side in WW2
					check_variable = { world_stage_coalition = 5 }
				}
				set_variable = { world_stage_coalition = 4 }
			}
			# updating proxy metropolises for 1st and 2nd
			every_country = {
				limit = { has_variable = world_stage_metropolis }
				world_stage_update_metropolis = yes
			}
			# updating proxy states for 1st and 2nd
			every_state = {
				limit = { has_variable = world_stage_metropolis }
				log = "[THIS.GetMetropolisName]'s owned theater"
				every_state = {
					limit = { check_variable = { theater_owner = PREV.world_stage_metropolis } }
					log = "[THIS.GetTheaterName]: previous coalition [?theater_owner_coalition]"
					set_variable = { theater_owner_coalition = PREV.world_stage_coalition }
					log = "[THIS.GetTheaterName]: new coalition [?theater_owner_coalition]"
				}
			}
			# updating proxy states and metropolis for 3rd
			every_state = {
				limit = { has_variable = world_stage_metropolis }
				if = { limit = { check_variable = { world_stage_coalition = 5 } } set_variable = { world_stage_coalition = 4 } }	# leagueofnations becomes unaligned
				if = { limit = { check_variable = { world_stage_coalition = 6 } } set_variable = { world_stage_coalition = 3 } }	# pactofsteel becomes axis
			}
			every_state = {
				limit = { has_variable = theater_owner }
				if = { limit = { check_variable = { theater_owner_coalition = 5 } } set_variable = { theater_owner_coalition = 4 } }	# leagueofnations becomes unaligned
				if = { limit = { check_variable = { theater_owner_coalition = 6 } } set_variable = { theater_owner_coalition = 3 } }	# pactofsteel becomes axis
			}
			# create on-map factions
			if = {
				limit = { country_exists = OSA }
				OSA = {
					if = { limit = { is_in_faction = yes is_faction_leader = no } leave_faction = yes }
					if = { limit = { is_in_faction = no } create_faction = coalition_name_allies_short }
					every_other_country = {
						limit = { check_variable = { world_stage_coalition = 1 } }
						OSA = { add_to_faction = PREV }
					}
				}
			} else = {
				random_country = {
					limit = { check_variable = { world_stage_coalition = 1 } }
					if = { limit = { is_in_faction = yes is_faction_leader = no } leave_faction = yes }
					if = { limit = { is_in_faction = no } create_faction = coalition_name_allies_short }
					set_temp_variable = { coalitionleader = THIS.id }
					every_other_country = {
						limit = { check_variable = { world_stage_coalition = 1 } }
						var:coalitionleader = { add_to_faction = PREV }
					}
				}
			}
			if = {
				limit = { country_exists = FER }
				FER = {
					if = { limit = { is_in_faction = yes is_faction_leader = no } leave_faction = yes }
					if = { limit = { is_in_faction = no } create_faction = coalition_name_komintern_short }
					every_other_country = {
						limit = { check_variable = { world_stage_coalition = 2 } }
						REI = { add_to_faction = PREV }
					}
				}
			} else = {
				random_country = {
					limit = { check_variable = { world_stage_coalition = 2 } }
					if = { limit = { is_in_faction = yes is_faction_leader = no } leave_faction = yes }
					if = { limit = { is_in_faction = no } create_faction = coalition_name_komintern_short }
					set_temp_variable = { coalitionleader = THIS.id }
					every_other_country = {
						limit = { check_variable = { world_stage_coalition = 2 } }
						var:coalitionleader = { add_to_faction = PREV }
					}
				}
			}
			if = {
				limit = { country_exists = REI }
				REI = {
					if = { limit = { is_in_faction = yes is_faction_leader = no } leave_faction = yes }
					if = { limit = { is_in_faction = no } create_faction = coalition_name_axis_short }
					every_other_country = {
						limit = { check_variable = { world_stage_coalition = 3 } }
						REI = { add_to_faction = PREV }
					}
				}
			} else = {
				random_country = {
					limit = { check_variable = { world_stage_coalition = 3 } }
					if = { limit = { is_in_faction = yes is_faction_leader = no } leave_faction = yes }
					if = { limit = { is_in_faction = no } create_faction = coalition_name_axis_short }
					set_temp_variable = { coalitionleader = THIS.id }
					every_other_country = {
						limit = { check_variable = { world_stage_coalition = 3 } }
						var:coalitionleader = { add_to_faction = PREV }
					}
				}
			}
			3 = { set_variable = { coalition_side_attack = 3 } }	# Change attacker on Poland
		}
	}
	
	option = {
		name = worldstage.55.allies
		trigger = { OR = { check_variable = { world_stage_coalition = 1 } check_variable = { world_stage_coalition = 5 } } }
		effect_tooltip = {
			custom_effect_tooltip = worldstage.55.lon_tt
			custom_effect_tooltip = worldstage.55.allies_tt
		}
	}
	option = {
		name = worldstage.55.komin
		trigger = { check_variable = { world_stage_coalition = 2 } }
		effect_tooltip = {
			custom_effect_tooltip = worldstage.55.lon_tt
			if = {
				limit = { NOT = { has_global_flag = SOV_already_expelled } }
				custom_effect_tooltip = worldstage.55.komin_tt
			}
		}
	}
	option = {
		name = worldstage.55.axis
		trigger = { OR = { check_variable = { world_stage_coalition = 3 } check_variable = { world_stage_coalition = 6 } } }
		effect_tooltip = {
			custom_effect_tooltip = worldstage.55.lon_tt
			custom_effect_tooltip = worldstage.55.axis_tt
		}
	}
	option = {
		name = worldstage.55.other
		trigger = { OR = { check_variable = { world_stage_coalition = 4 } NOT = { has_variable = world_stage_coalition } } }
		effect_tooltip = {
			custom_effect_tooltip = worldstage.55.lon_tt
		}
	}
}

########################################################################
########################## worldstage_automatic ########################
########################################################################

# theater ended: defender won (defender event)
state_event = {
	id = worldstage_automatic.1
	title = worldstage_automatic.1.t
	desc = worldstage_automatic.1.d 
	picture = GFX_news_ww2_battle

	is_triggered_only = yes
	
	major = yes
	
	show_major = {
		AND = { check_variable = { ROOT.theater_owner_coalition = THIS.world_stage_coalition } }	### add rules for kominter/allies friendship
	}
	
	option = { name = worldstage_automatic.1.a custom_effect_tooltip = worldstage_automatic.1.tt }
}

# theater ended: defender won (attacker event)
state_event = {
	id = worldstage_automatic.2
	title = worldstage_automatic.2.t
	desc = worldstage_automatic.2.d 
	picture = GFX_news_ww2_dead_soldiers

	is_triggered_only = yes
	
	major = yes
	
	show_major = {
		AND = { check_variable = { ROOT.coalition_side_attack = THIS.world_stage_coalition } }	### add rules for kominter/allies friendship
	}
	
	immediate = {	# closes window, if it is open
		if = {
			limit = { check_variable = { ROOT.theater_id = current_theater }  }
			set_variable = { current_theater = 0 }
		}
	}
	
	option = { name = worldstage_automatic.2.a custom_effect_tooltip = worldstage_automatic.2.tt }
}

# theater ended: defender won (neutral event)
state_event = {
	id = worldstage_automatic.3
	title = worldstage_automatic.3.t
	desc = worldstage_automatic.3.d 
	picture = GFX_news_ww2_dead_soldiers

	is_triggered_only = yes
	
	major = yes
	
	show_major = {
		NOT = {
			has_country_flag = hide_worldstage_notification
			AND = { check_variable = { ROOT.theater_owner_coalition = THIS.world_stage_coalition } }	### add rules for kominter/allies friendship
			AND = { check_variable = { ROOT.coalition_side_attack = THIS.world_stage_coalition } }	### add rules for kominter/allies friendship
		}
	}
	
	immediate = {	# closes window, if it is open
		if = {
			limit = { check_variable = { ROOT.theater_id = current_theater }  }
			set_variable = { current_theater = 0 }
		}
	}
	
	option = { name = worldstage_automatic.3.a custom_effect_tooltip = worldstage_automatic.3.tt }
}

# theater ended: attacker won (defender event)
state_event = {
	id = worldstage_automatic.4
	title = worldstage_automatic.4.t
	desc = worldstage_automatic.4.d 
	picture = GFX_news_ww2_dead_soldiers

	is_triggered_only = yes
	
	major = yes
	
	show_major = {
		AND = { check_variable = { ROOT.theater_owner_coalition = THIS.world_stage_coalition } }	### add rules for kominter/allies friendship
	}
	
	immediate = {	# closes window, if it is open
		if = {
			limit = { check_variable = { ROOT.theater_id = current_theater }  }
			set_variable = { current_theater = 0 }
		}
	}
	
	option = { name = worldstage_automatic.4.a custom_effect_tooltip = worldstage_automatic.4.tt }
}

# theater ended: attacker won (attacker event)
state_event = {
	id = worldstage_automatic.5
	title = worldstage_automatic.5.t
	desc = worldstage_automatic.5.d 
	picture = GFX_news_ww2_battle

	is_triggered_only = yes
	
	major = yes
	
	show_major = {
		AND = { check_variable = { ROOT.coalition_side_attack = THIS.world_stage_coalition } }	### add rules for kominter/allies friendship
	}
	
	immediate = {	# closes window, if it is open
		if = {
			limit = { check_variable = { ROOT.theater_id = current_theater }  }
			set_variable = { current_theater = 0 }
		}
	}
	
	option = { name = worldstage_automatic.5.a custom_effect_tooltip = worldstage_automatic.5.tt }
}

# theater ended: attacker won (neutral event)
state_event = {
	id = worldstage_automatic.6
	title = worldstage_automatic.6.t
	desc = worldstage_automatic.6.d 
	picture = GFX_news_ww2_dead_soldiers

	is_triggered_only = yes
	
	major = yes
	
	show_major = {
		NOT = {
			has_country_flag = hide_worldstage_notification
			AND = { check_variable = { ROOT.theater_owner_coalition = THIS.world_stage_coalition } }	### add rules for kominter/allies friendship
			AND = { check_variable = { ROOT.coalition_side_attack = THIS.world_stage_coalition } }	### add rules for kominter/allies friendship
		}
	}
	
	immediate = {	# closes window, if it is open
		if = {
			limit = { check_variable = { ROOT.theater_id = current_theater }  }
			set_variable = { current_theater = 0 }
		}
	}
	
	option = { name = worldstage_automatic.6.a custom_effect_tooltip = worldstage_automatic.6.tt }
}

# SCOPE TEST	### FOR DEBUG DELETE LATER	### FOR DEBUG DELETE LATER	### FOR DEBUG DELETE LATER
state_event = {
	id = worldstage_automatic.7
	title = worldstage_automatic.7.t
	desc = worldstage_automatic.7.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes
	
	major = yes
	
	show_major = {
		OR = {
			NOT = { has_country_flag = hide_worldstage_notification }
			AND = { check_variable = { ROOT.theater_owner = THIS.world_stage_metropolis } }
		}
	}
	option = {
		name = "test"
		log = "ROOT [ROOT.GetName]"
		log = "THIS [THIS.GetName]"
		log = "PREV [PREV.GetName]"
	}
}	### FOR DEBUG DELETE LATER	### FOR DEBUG DELETE LATER	### FOR DEBUG DELETE LATER


########################################################################
########################## worldstage_surrender ########################
########################################################################

# these events are for Western Exclaves, when deciding whether or not to capitulate or fight

# FRANCE SURRENDERS # imagine my shock!
country_event = {
	id = worldstage_surrender.103
	title = worldstage_surrender.103.t
	desc = worldstage_surrender.103.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = no	# this is KOB-only
	
	immediate = {
		hidden_effect = {
			clr_global_flag = world_stage_france_exists
			set_global_flag = world_stage_vichy_exists
			every_state = {
				limit = { check_variable = { theater_owner = 103 } }
				set_variable = { theater_owner = 120 }
				set_variable = { theater_owner_coalition = 3 }
			}
			8 = { set_variable = { theater_owner = 101 } set_variable = { theater_owner_coalition = 3 } }
			every_state = {
				limit = { has_variable = theater_owner }
				set_variable = { world_stage_power_deployed_by^120 = world_stage_power_deployed_by^103 }
				divide_variable = { world_stage_power_deployed_by^120 = 4 }
				set_variable = { world_stage_power_deployed_by^103 = 0 }
			}
			103 = { set_variable = { world_stage_power = 0 } }
		}
	}

	option = {
		name = worldstage_surrender.103.a	# fight, prefered human option
		trigger = { is_puppet = no }		# puppet don't get to decide
		every_possible_country = {
			limit = { tag = KOB }
			every_possible_country = {
			limit = { tag = KOB }
				custom_effect_tooltip = lose_access_to_trade_resources
				clr_country_flag = tc_kobe_has_access
			}
		}
		if = {
			limit = { country_exists = KOB }
			random_country = {
				limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
				white_peace = {
					tag = KOB
					message = worldstage_surrender.103.kob
				}
				add_to_faction = KOB
			}
		}
		custom_effect_tooltip = metropolis_scope_vichy
		custom_effect_tooltip = join_coalition_axis
		hidden_effect = {
			if = {
				limit = { country_exists = KOB }
				country_event = { id = worldstage_surrender.1031 days = 3 random_hours = 48 }
			}	
		}
		ai_chance = { base = 0 }
	}
	option = {
		name = worldstage_surrender.103.b	# surrender, prefered AI option
		trigger = { is_puppet = no }		# puppet don't get to decide
		every_possible_country = {
			limit = { tag = KOB }
			set_politics = {
				ruling_party = fascism
				elections_allowed = no
				last_election = "1939.09.1"
				election_frequency = 48
				#long_name = TAG_party_long
				#name = TAG_party
			}
			set_variable = { world_stage_metropolis = 120 }	# Vichy France
		}
		custom_effect_tooltip = metropolis_scope_vichy
		custom_effect_tooltip = join_coalition_axis
		hidden_effect = {
			if = {
				limit = { country_exists = KOB }
				country_event = { id = worldstage_surrender.1032 days = 3 random_hours = 48 }
			}	
		}
		ai_chance = { base = 100 }
	}
	option = {
		name = worldstage_surrender.103.c
		trigger = { is_puppet = yes }		# puppet don't get to decide
		if = {
			limit = { OVERLORD = { OR = { has_government = fascism has_government = neutrality has_government = autocracy } } }
			every_possible_country = {
				limit = { tag = KOB }
				set_politics = {
					ruling_party = fascism
					elections_allowed = no
					last_election = "1939.09.1"
					election_frequency = 48
					#long_name = TAG_party_long
					#name = TAG_party
				}
				set_variable = { world_stage_metropolis = 120 }	# Vichy France
			}
			if = {
				limit = { country_exists = KOB }
				random_country = {
					limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
					white_peace = {
						tag = KOB
						message = worldstage_surrender.103.kob
					}
					add_to_faction = KOB
				}
			}
			hidden_effect = {
				if = {
					limit = { country_exists = KOB }
					country_event = { id = worldstage_surrender.1032 days = 1 }
				}	
			}
		} else = {
			every_possible_country = {
			limit = { tag = KOB }
				every_possible_country = {
				limit = { tag = KOB }
					custom_effect_tooltip = lose_access_to_trade_resources
					clr_country_flag = tc_kobe_has_access
				}
			}
			hidden_effect = {
				if = {
					limit = { country_exists = KOB }
					country_event = { id = worldstage_surrender.1031 days = 1 }
				}	
			}
		}
		custom_effect_tooltip = metropolis_scope_vichy
		custom_effect_tooltip = join_coalition_axis
		ai_chance = { base = 100 }
	}
}

# KOBE IS FREE FRANCE
country_event = {
	id = worldstage_surrender.1031
	title = worldstage_surrender.1031.t
	desc = worldstage_surrender.1031.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	option = {
		name = worldstage_surrender.1031.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } NOT = { tag = KOB } }
	}
	option = {
		name = worldstage_surrender.1031.kob
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } tag = KOB }
	}
	option = {
		name = worldstage_surrender.1031.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
	}
	option = {
		name = worldstage_surrender.1031.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
	}
	option = {
		name = worldstage_surrender.1031.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
	}
}

# KOBE IS VICHY FRANCE
country_event = {
	id = worldstage_surrender.1032
	title = worldstage_surrender.1032.t
	desc = worldstage_surrender.1032.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	option = {
		name = worldstage_surrender.1032.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
	}
	option = {
		name = worldstage_surrender.1032.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
	}
	option = {
		name = worldstage_surrender.1032.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } NOT = { tag = KOB } }
	}
	option = {
		name = worldstage_surrender.1032.kob
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } tag = KOB }
	}
	option = {
		name = worldstage_surrender.1032.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
	}
}

#########################
######################### THE ONES BELLOW MAY BE DEPRICATED
#########################
#########################
#########################

### MONGOLIA MEDDLING
# ROC completes 'ROC_aid_mongolia'
news_event = {
	id = worldstage.1
	title = worldstage.1.t
	desc = worldstage.1.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes
	
	option = {
		name = worldstage.1.axis
		trigger = {
			OR = { tag = ROC has_government = fascism }
		}
	}
	option = {
		name = worldstage.1.komin
		trigger = {
			OR = { tag = FER has_government = communism }
		}
	}
	option = {
		name = worldstage.1.other
		trigger = {
			NOT = {
				has_government = fascism
				has_government = communism
				tag = ROC
				tag = FER
			}
		}
	}
}

# ROC wins in Mongolia
news_event = {
	id = worldstage.2
	title = worldstage.2.t
	desc = worldstage.2.d
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes
	
	immediate = {
		if = {
			limit = { has_global_flag = leagueofnations_exists NOT = { has_global_flag = china_aligned_axis } }
			set_variable = { global.theater_owner_mongolia = 5 }
		}
		if = {
			limit = { has_global_flag = leagueofnations_exists has_global_flag = china_aligned_axis }
			set_variable = { global.theater_owner_mongolia = 6 }
		}
		if = {
			limit = { NOT = { has_global_flag = leagueofnations_exists has_global_flag = china_aligned_axis } }
			set_variable = { global.theater_owner_mongolia = 4 }
		}
		if = {
			limit = { NOT = { has_global_flag = leagueofnations_exists } has_global_flag = china_aligned_axis }
			set_variable = { global.theater_owner_mongolia = 3 }
		}
	}
	
	option = {
		name = worldstage.2.axis
		trigger = {
			OR = { has_government = fascism tag = ROC }
		}
		effect_tooltip = {
			add_world_stage_power_chi_5 = yes
		}
	}
	option = {
		name = worldstage.2.komin
		trigger = {
			OR = { has_government = communism tag = FER }
		}
		effect_tooltip = {
			add_world_stage_power_chi_5 = yes
		}
	}
	option = {
		name = worldstage.2.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
				tag = ROC
				tag = FER
			}
		}
		effect_tooltip = {
			add_world_stage_power_chi_5 = yes
		}
	}
}

# SOV wins in Mongolia
news_event = {
	id = worldstage.3
	title = worldstage.3.t
	desc = worldstage.2.d
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes
	
	immediate = {
		if = {
			limit = { OR = { has_global_flag = SOV_expelled_from_lon NOT = { has_global_flag = leagueofnations_exists } } }
			set_variable = { global.theater_owner_mongolia = 2 }
		}
		if = {
			limit = { has_global_flag = leagueofnations_exists NOT = { has_global_flag = SOV_expelled_from_lon } }
			set_variable = { global.theater_owner_mongolia = 5 }
		}
	}
	
	option = {
		name = worldstage.3.axis
		trigger = {
			has_government = fascism
		}
		effect_tooltip = {
			add_world_stage_power_sov_5 = yes
		}
	}
	option = {
		name = worldstage.3.komin
		trigger = {
			has_government = communism
		}
		effect_tooltip = {
			add_world_stage_power_sov_5 = yes
		}
	}
	option = {
		name = worldstage.3.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		effect_tooltip = {
			add_world_stage_power_sov_5 = yes
		}
	}
}
### SPANISH CIVIL War

# Spanish Civil War - Start
news_event = {
	id = worldstage.4
	title = worldstage.4.t
	desc = worldstage.4.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes
	
	immediate = {
		set_global_flag = world_stage_theater_spanish_cw_is_active
	}
	
	option = {
		name = worldstage.4.axis
		trigger = {
			has_government = fascism
		}
	}
	option = {
		name = worldstage.4.komin
		trigger = {
			has_government = communism
		}
	}
	option = {
		name = worldstage.4.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
	}
}

# Spanish Civil War - Italian Help
news_event = {
	id = worldstage.5
	title = worldstage.5.t
	desc = worldstage.5.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	immediate = {
		add_to_variable = { global.FAL_strength_spain_bonus = 5 }
	}
	
	option = {
		name = worldstage.5.axis
		trigger = {
			has_government = fascism
		}
		effect_tooltip = {
			add_to_variable = {
				global.FAL_strength_spain_bonus = 5
				tooltip = world_stage_add_help_fal_power
			}
		}
	}
	option = {
		name = worldstage.5.komin
		trigger = {
			has_government = communism
		}
		effect_tooltip = {
			add_to_variable = {
				global.FAL_strength_spain_bonus = 5
				tooltip = world_stage_add_help_fal_power
			}
		}
	}
	option = {
		name = worldstage.5.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		effect_tooltip = {
			add_to_variable = {
				global.FAL_strength_spain_bonus = 5
				tooltip = world_stage_add_help_fal_power
			}
		}
	}
}

# Spanish Civil War - International Brigades
news_event = {
	id = worldstage.6
	title = worldstage.6.t
	desc = worldstage.6.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	immediate = {
		add_to_variable = { global.REP_strength_spain_bonus = 5 }
	}
	
	option = {
		name = worldstage.6.axis
		trigger = {
			has_government = fascism
		}
		effect_tooltip = {
			add_to_variable = {
				global.FAL_strength_spain = 5
				tooltip = world_stage_add_help_rep_power
			}
		}
	}
	option = {
		name = worldstage.6.komin
		trigger = {
			has_government = communism
		}
		effect_tooltip = {
			add_to_variable = {
				global.FAL_strength_spain = 5
				tooltip = world_stage_add_help_rep_power
			}
		}
	}
	option = {
		name = worldstage.6.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		effect_tooltip = {
			add_to_variable = {
				global.FAL_strength_spain = 5
				tooltip = world_stage_add_help_rep_power
			}
		}
	}
}

# Spanish Civil War - German Assistance
news_event = {
	id = worldstage.7
	title = worldstage.7.t
	desc = worldstage.7.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	# immediate: none, effect handled by focus
	
	option = {
		name = worldstage.7.axis
		trigger = {
			has_government = fascism
		}
		effect_tooltip = {
			add_to_variable = {
				global.FAL_strength_spain_bonus = 10
				tooltip = world_stage_add_help_fal_power
			}
		}
	}
	option = {
		name = worldstage.7.komin
		trigger = {
			has_government = communism
		}
		effect_tooltip = {
			add_to_variable = {
				global.FAL_strength_spain_bonus = 10
				tooltip = world_stage_add_help_fal_power
			}
		}
	}
	option = {
		name = worldstage.7.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		effect_tooltip = {
			add_to_variable = {
				global.FAL_strength_spain_bonus = 10
				tooltip = world_stage_add_help_fal_power
			}
		}
	}
}

# Spanish Civil War - Republican Desertion
news_event = {
	id = worldstage.8
	title = worldstage.8.t
	desc = worldstage.8.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	immediate = {
		add_to_variable = { global.FAL_strength_spain = 1 }
		add_to_variable = { global.REP_strength_spain = -1 }
	}
	
	option = {
		name = worldstage.8.axis
		trigger = {
			has_government = fascism
		}
		effect_tooltip = {
			custom_effect_tooltip = country_name_falange
			add_to_variable = {
				global.FAL_strength_spain = 1
				tooltip = world_stage_add_local_power
			}
			custom_effect_tooltip = country_name_republica
			add_to_variable = {
				global.REP_strength_spain = -1
				tooltip = world_stage_add_local_power
			}
		}
	}
	option = {
		name = worldstage.8.komin
		trigger = {
			has_government = communism
		}
		effect_tooltip = {
			custom_effect_tooltip = country_name_falange
			add_to_variable = {
				global.FAL_strength_spain = 1
				tooltip = world_stage_add_local_power
			}
			custom_effect_tooltip = country_name_republica
			add_to_variable = {
				global.REP_strength_spain = -1
				tooltip = world_stage_add_local_power
			}
		}
	}
	option = {
		name = worldstage.8.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		effect_tooltip = {
			custom_effect_tooltip = country_name_falange
			add_to_variable = {
				global.FAL_strength_spain = 1
				tooltip = world_stage_add_local_power
			}
			custom_effect_tooltip = country_name_republica
			add_to_variable = {
				global.REP_strength_spain = -1
				tooltip = world_stage_add_local_power
			}
		}
	}
}

# Spanish Civil War - Republican Infighting 
news_event = {
	id = worldstage.9
	title = worldstage.9.t
	desc = worldstage.9.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	immediate = {
		add_to_variable = { global.REP_strength_spain = -1 }
	}
	
	option = {
		name = worldstage.9.axis
		trigger = {
			has_government = fascism
		}
		effect_tooltip = {
			custom_effect_tooltip = country_name_republica
			add_to_variable = {
				global.REP_strength_spain = -1
				tooltip = world_stage_add_local_power
			}
		}
	}
	option = {
		name = worldstage.9.komin
		trigger = {
			has_government = communism
		}
		effect_tooltip = {
			custom_effect_tooltip = country_name_republica
			add_to_variable = {
				global.REP_strength_spain = -1
				tooltip = world_stage_add_local_power
			}
		}
	}
	option = {
		name = worldstage.9.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		effect_tooltip = {
			custom_effect_tooltip = country_name_republica
			add_to_variable = {
				global.REP_strength_spain = -1
				tooltip = world_stage_add_local_power
			}
		}
	}
}

# Spanish Civil War - Guernica
news_event = {
	id = worldstage.10
	title = worldstage.10.t
	desc = worldstage.10.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	immediate = {
		add_to_variable = { global.REP_strength_spain = -1 }
	}
	
	option = {
		name = worldstage.10.axis
		trigger = {
			has_government = fascism
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_falange }
			add_doctrine_cost_reduction = {
				cost_reduction = 0.5
				category = air_doctrine
			}
		}
		effect_tooltip = {
			custom_effect_tooltip = country_name_republica
			add_to_variable = {
				global.REP_strength_spain = -1
				tooltip = world_stage_add_local_power
			}
		}
	}
	option = {
		name = worldstage.10.komin
		trigger = {
			has_government = communism
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_falange }
			add_doctrine_cost_reduction = {
				cost_reduction = 0.5
				category = air_doctrine
			}
		}
		effect_tooltip = {
			custom_effect_tooltip = country_name_republica
			add_to_variable = {
				global.REP_strength_spain = -1
				tooltip = world_stage_add_local_power
			}
		}
	}
	option = {
		name = worldstage.10.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_falange }
			add_doctrine_cost_reduction = {
				cost_reduction = 0.5
				category = air_doctrine
			}
		}
		effect_tooltip = {
			custom_effect_tooltip = country_name_republica
			add_to_variable = {
				global.REP_strength_spain = -1
				tooltip = world_stage_add_local_power
			}
		}
	}
}

# Spanish Civil War - Another Round
country_event = {
	id = worldstage.11
	title = worldstage.11.t
	desc = worldstage.11.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	option = {
		name = worldstage.11.axis
		trigger = {
			has_government = fascism
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_falange }
			army_experience = 5
		}
	}
	option = {
		name = worldstage.11.komin
		trigger = {
			has_government = communism
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_republica }
			army_experience = 5
		}
	}
	option = {
		name = worldstage.11.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_republica }
			army_experience = 5
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_falange }
			army_experience = 5
		}
	}
}

# Spanish Civil War - Falange Wins
country_event = {
	id = worldstage.12
	title = worldstage.12.t
	desc = worldstage.12.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	immediate = { set_variable = { global.theater_owner_spain = 0 } }
	
	option = {
		name = worldstage.12.axis
		trigger = {
			has_government = fascism
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_falange }
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = air_doctrine
			}
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = land_doctrine
			}
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = naval_doctrine
			}
		}
	}
	option = {
		name = worldstage.12.komin
		trigger = {
			has_government = communism
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_republica }	# maybe check a tag....
			# GETS EXILED REPUBLICAN GENERALS
		}
	}
	option = {
		name = worldstage.12.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_falange }
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = air_doctrine
			}
			add_doctrine_cost_reduction = {
				cost_reduction = 0.9
				category = land_doctrine
			}
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = naval_doctrine
			}
		}
	}
}

# Spanish Civil War - Repblica Wins
country_event = {
	id = worldstage.13
	title = worldstage.13.t
	desc = worldstage.13.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	immediate = { set_variable = { global.theater_owner_spain = 0 } }
	
	option = {
		name = worldstage.13.axis
		trigger = {
			has_government = fascism
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_falange }	# maybe check a tag....
			# GETS EXILED FALANGIST GENERALS
		}
	}
	option = {
		name = worldstage.13.komin
		trigger = {
			has_government = communism
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_republica }
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = air_doctrine
			}
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = land_doctrine
			}
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = naval_doctrine
			}
		}
	}
	option = {
		name = worldstage.13.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		if = {
			limit = { has_country_flag = world_stage_spanish_cw_helped_republica }
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = air_doctrine
			}
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = land_doctrine
			}
			add_doctrine_cost_reduction = {
				cost_reduction = 0.99
				category = naval_doctrine
			}
		}
	}
}

# Spanish Civil War - Soviet Assistance
news_event = {
	id = worldstage.14
	title = worldstage.14.t
	desc = worldstage.14.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	# immediate: none, effect handled by focus
	
	option = {
		name = worldstage.14.axis
		trigger = {
			has_government = fascism
		}
		effect_tooltip = {
			add_to_variable = {
				global.REP_strength_spain_bonus = 10
				tooltip = world_stage_add_help_rep_power
			}
		}
	}
	option = {
		name = worldstage.14.komin
		trigger = {
			has_government = communism
		}
		effect_tooltip = {
			add_to_variable = {
				global.REP_strength_spain_bonus = 10
				tooltip = world_stage_add_help_rep_power
			}
		}
	}
	option = {
		name = worldstage.14.other
		trigger = {
			NOT = {
				has_government = communism
				has_government = fascism
			}
		}
		effect_tooltip = {
			add_to_variable = {
				global.REP_strength_spain_bonus = 10
				tooltip = world_stage_add_help_rep_power
			}
		}
	}
}

# Invasion of Poland - Poland Resists		#### CURRENTLY NOT USED IN GAME
country_event = {
	id = worldstage.17
	title = worldstage.17.t
	desc = worldstage.17.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	immediate = {
		
	}
	
	option = {
		name = worldstage.17.axis1
		trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } }
			NOT = { has_global_flag = GER_SOV_pact_enabled }
		}
	}
	option = {
		name = worldstage.17.axis2
		trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } }
			has_global_flag = GER_SOV_pact_enabled
		}
	}
	option = {
		name = worldstage.17.komin1
		trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } }
			NOT = { has_global_flag = GER_SOV_pact_enabled }
		}
	}
	option = {
		name = worldstage.17.komin2
		trigger = {
			var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } }
			has_global_flag = GER_SOV_pact_enabled
		}
	}
	option = {
		name = worldstage.17.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
	}
	option = {
		name = worldstage.17.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
	}
}



# Invasion of Poland - The Emp... the French! Strike Back		#### CURRENTLY NOT USED IN GAME
country_event = {
	id = worldstage.20
	title = worldstage.20.t
	desc = worldstage.20.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	option = {
		name = worldstage.20.a1				# Attack!
		custom_effect_tooltip = "not from devs: this event does not have effects"
	}
	option = {
		name = worldstage.20.a2				# Hold!
		custom_effect_tooltip = "not from devs: this event does not have effects"
	}
}

# Germany Invades Soviet Union! # has Molotov-Ribentrop
news_event = {
	id = worldstage.33
	title = worldstage.33.t
	desc = worldstage.33.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	immediate = {
		# soviets are caught with their pants down...
		set_temp_variable = { sov_forces_value = global.world_stage_power_sov }
		divide_temp_variable = { sov_forces_value = 8 }
		round_temp_variable = sov_forces_value
		set_variable = { global.SOV_strength_poland = sov_forces_value }
		subtract_from_variable = { global.world_stage_power_sov = sov_forces_value }
	}
	
	option = {
		name = worldstage.33.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			if = {	limit = { NOT = { tag = REI } }
				custom_effect_tooltip = world_stage_theater_poland_is_active_second_tt
				custom_effect_tooltip = country_name_germany
				add_to_variable = {
					global.ENG_strength_poland = global.GER_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
					tooltip = world_stage_deploy_power_poland
				}
				add_to_variable = {
					global.ENG_strength_poland = global.GER_strength_poland_bonus			# I'm using ENG_poland because it's supposed to be zero, then localisation works
					tooltip = world_stage_bonus_power_poland
				}
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				global.ENG_strength_poland = global.SOV_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
		}
	}
	option = {
		name = worldstage.33.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_poland_is_active_second_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland_bonus			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_bonus_power_poland
			}
			if = {	limit = { NOT = { tag = FER } }
				custom_effect_tooltip = country_name_russia
			}
			add_to_variable = {
				global.ENG_strength_poland = global.SOV_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
		}
	}
	option = {
		name = worldstage.33.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_poland_is_active_second_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland_bonus			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_bonus_power_poland
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				global.ENG_strength_poland = global.SOV_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
		}
	}
	option = {
		name = worldstage.33.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_poland_is_active_second_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland_bonus			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_bonus_power_poland
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				global.ENG_strength_poland = global.SOV_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
		}
	}
}

# Germany Invades Soviet Union! # do not have Molotov-Ribentrop
news_event = {
	id = worldstage.34
	title = worldstage.34.t
	desc = worldstage.34.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	immediate = {
		# the soviets would never be caught off guard like that...
#		set_temp_variable = { sov_forces_value = global.world_stage_power_sov }
#		divide_temp_variable = { sov_forces_value = 5 }
#		round_temp_variable = sov_forces_value
#		set_variable = { global.SOV_strength_poland = sov_forces_value }
#		subtract_from_variable = { global.world_stage_power_sov = sov_forces_value }
	}
	
	option = {
		name = worldstage.34.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			if = {	limit = { NOT = { tag = REI } }
				custom_effect_tooltip = world_stage_theater_poland_is_active_second_tt
				custom_effect_tooltip = country_name_germany
				add_to_variable = {
					global.ENG_strength_poland = global.GER_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
					tooltip = world_stage_deploy_power_poland
				}
				add_to_variable = {
					global.ENG_strength_poland = global.GER_strength_poland_bonus			# I'm using ENG_poland because it's supposed to be zero, then localisation works
					tooltip = world_stage_bonus_power_poland
				}
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				global.ENG_strength_poland = global.SOV_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
		}
	}
	option = {
		name = worldstage.34.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_poland_is_active_second_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland_bonus			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_bonus_power_poland
			}
			if = {	limit = { NOT = { tag = FER } }
				custom_effect_tooltip = country_name_russia
			}
			add_to_variable = {
				global.ENG_strength_poland = global.SOV_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
		}
	}
	option = {
		name = worldstage.34.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_poland_is_active_second_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland_bonus			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_bonus_power_poland
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				global.ENG_strength_poland = global.SOV_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
		}
	}
	option = {
		name = worldstage.34.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_poland_is_active_second_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
			add_to_variable = {
				global.ENG_strength_poland = global.GER_strength_poland_bonus			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_bonus_power_poland
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				global.ENG_strength_poland = global.SOV_strength_poland			# I'm using ENG_poland because it's supposed to be zero, then localisation works
				tooltip = world_stage_deploy_power_poland
			}
		}
	}
}

# Germany Overwhelms Soviets in Poland	# AFTER BREAKING MOLOTOV-RIBENTROP PACT # BARBAROSSA!
news_event = {
	id = worldstage.37
	title = worldstage.37.t
	desc = worldstage.37.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	immediate = {
		set_global_flag = world_stage_theater_smolensk_is_active	# goes straight to Smolensk, 'bypasses' Belarus
		add_to_variable = {global.world_stage_power_ger = 5 }
		add_to_variable = {global.world_stage_power_sov = -5 }
		add_to_variable = { global.GER_strength_smolensk = global.GER_strength_poland }
		add_to_variable = { global.AXIS_strength_smolensk_bonus = 75 }
		set_temp_variable = { sov_forces_value = global.world_stage_power_sov }
		divide_temp_variable = { sov_forces_value = 4 }
		round_temp_variable = sov_forces_value
		add_to_variable = { global.SOV_strength_smolensk = sov_forces_value }
		subtract_from_variable = { global.world_stage_power_sov = sov_forces_value }
		set_variable = { global.theater_owner_poland = 3 }
		set_variable = { global.theater_owner_belarus = 3 }
	}
	
	option = {
		name = worldstage.37.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_smolensk_is_active_tt
			if = {	limit = { NOT = { tag = REI } }
				custom_effect_tooltip = country_name_germany
			}
			add_to_variable = {
				placeholder_var = global.GER_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
			add_to_variable = {
				placeholder_var = global.AXIS_strength_smolensk_bonus			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_bonus_power_smolensk
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_add_power
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_remove_power
			}
			add_to_variable = {
				placeholder_var = global.SOV_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
		}
	}
	option = {
		name = worldstage.37.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_smolensk_is_active_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				placeholder_var = global.GER_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
			add_to_variable = {
				placeholder_var = global.AXIS_strength_smolensk_bonus			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_bonus_power_smolensk
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_add_power
			}
			if = {	limit = { NOT = { tag = FER } }
				custom_effect_tooltip = country_name_russia
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_remove_power
			}
			add_to_variable = {
				placeholder_var = global.SOV_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
		}
	}
	option = {
		name = worldstage.37.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_smolensk_is_active_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				placeholder_var = global.GER_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
			add_to_variable = {
				placeholder_var = global.AXIS_strength_smolensk_bonus			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_bonus_power_smolensk
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_add_power
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_remove_power
			}
			add_to_variable = {
				placeholder_var = global.SOV_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
		}
	}
	option = {
		name = worldstage.37.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_smolensk_is_active_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				placeholder_var = global.GER_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
			add_to_variable = {
				placeholder_var = global.AXIS_strength_smolensk_bonus			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_bonus_power_smolensk
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_add_power
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_remove_power
			}
			add_to_variable = {
				placeholder_var = global.SOV_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
		}
	}
}

# German Suprise Attack Fails
news_event = {
	id = worldstage.38
	title = worldstage.38.t
	desc = worldstage.38.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	immediate = {
		set_global_flag = world_stage_theater_belarus_is_active		# Germany wins in poland but the offensive slows down in Belarus
		add_to_variable = {global.world_stage_power_ger = 5 }
		add_to_variable = {global.world_stage_power_sov = -5 }
		add_to_variable = { global.GER_strength_smolensk = global.GER_strength_poland}
		add_to_variable = { global.AXIS_strength_smolensk_bonus = 50 }
		set_temp_variable = { sov_forces_value = global.world_stage_power_sov }
		divide_temp_variable = { sov_forces_value = 4 }
		round_temp_variable = sov_forces_value
		add_to_variable = { global.SOV_strength_smolensk = sov_forces_value }
		subtract_from_variable = { global.world_stage_power_sov = sov_forces_value }
		set_variable = { global.theater_owner_poland = 3 }
	}
	
	option = {
		name = worldstage.38.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_smolensk_is_active_tt
			if = {	limit = { NOT = { tag = REI } }
				custom_effect_tooltip = country_name_germany
			}
			add_to_variable = {
				placeholder_var = global.GER_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
			add_to_variable = {
				placeholder_var = global.AXIS_strength_smolensk_bonus			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_bonus_power_smolensk
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_add_power
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_remove_power
			}
			add_to_variable = {
				placeholder_var = global.SOV_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
		}
	}
	option = {
		name = worldstage.38.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_smolensk_is_active_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				placeholder_var = global.GER_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
			add_to_variable = {
				placeholder_var = global.AXIS_strength_smolensk_bonus			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_bonus_power_smolensk
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_add_power
			}
			if = {	limit = { NOT = { tag = FER } }
				custom_effect_tooltip = country_name_russia
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_remove_power
			}
			add_to_variable = {
				placeholder_var = global.SOV_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
		}
	}
	option = {
		name = worldstage.38.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_smolensk_is_active_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				placeholder_var = global.GER_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
			add_to_variable = {
				placeholder_var = global.AXIS_strength_smolensk_bonus			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_bonus_power_smolensk
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_add_power
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_remove_power
			}
			add_to_variable = {
				placeholder_var = global.SOV_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
		}
	}
	option = {
		name = worldstage.38.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_smolensk_is_active_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				placeholder_var = global.GER_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
			add_to_variable = {
				placeholder_var = global.AXIS_strength_smolensk_bonus			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_bonus_power_smolensk
			}
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_add_power
			}
			custom_effect_tooltip = country_name_russia
			add_to_variable = {
				placeholder_var = 5										# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_remove_power
			}
			add_to_variable = {
				placeholder_var = global.SOV_strength_smolensk			# placeholder_var = 0, tooltips gets correct value
				tooltip = world_stage_deploy_power_smolensk
			}
		}
	}
}

# Germans Advance Through Belarus - Front advance to Smolensk (Barbarossa without Mololv-Ribenpoop)
news_event = {
	id = worldstage.39
	title = worldstage.39.t
	desc = worldstage.39.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	immediate = {
		set_global_flag = world_stage_theater_smolensk_is_active
		set_variable = { global.GER_strength_smolensk = global.GER_strength_belarus }
		clear_variable = global.GER_strength_belarus
		set_temp_variable = { sov_forces_value = global.world_stage_power_sov }
		divide_temp_variable = { sov_forces_value = 4 }
		round_temp_variable = sov_forces_value
		set_variable = { global.SOV_strength_smolensk = sov_forces_value }
		subtract_from_variable = { global.world_stage_power_sov = sov_forces_value }
		clear_variable = global.SOV_strength_belarus
		#if = {	# <--------------------------------------------------------------------------- HERE! LOOK AT ME! FINISH ME! TODO! TO-DO!
		#	limit = { sov still fights in ukraine}
		#	add strategic advantage to axis
		#}
		set_variable = { global.theater_owner_belarus = 3 }
	}
	
	option = {
		name = worldstage.39.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			if = {	limit = { NOT = { tag = REI } }
				
			}
			
		}
	}
	option = {
		name = worldstage.39.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			
		}
	}
	option = {
		name = worldstage.39.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		effect_tooltip = {
			if = {	limit = { NOT = { tag = KOB } }
				
			}
		}
	}
	option = {
		name = worldstage.39.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
		
		}
	}
}

# Invasion of Norway! # Operation Weserbung
news_event = {
	id = worldstage.45
	title = worldstage.45.t
	desc = worldstage.45.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	immediate = {
		set_variable = { global.theater_owner_norway = 1 }
	}
	
	option = {
		name = worldstage.45.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			if = {
				limit = { NOT = { tag = REI } }
				custom_effect_tooltip = world_stage_theater_norway_is_active_tt
				custom_effect_tooltip = country_name_germany
				add_to_variable = {
					placeholder_var = 60
					tooltip = world_stage_deploy_power_norway
				}
				add_to_variable = {
					placeholder_var = 30
					tooltip = world_stage_bonus_power_norway
				}
			}
#			custom_effect_tooltip = country_name_france
#			add_to_variable = {
#				placeholder_var = 5
#				tooltip = world_stage_bonus_power_norway
#			}
#			custom_effect_tooltip = country_name_england
#			add_to_variable = {
#				placeholder_var = 5
#				tooltip = world_stage_bonus_power_norway
#			}
		}
	}
	option = {
		name = worldstage.45.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_norway_is_active_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				placeholder_var = 60
				tooltip = world_stage_deploy_power_norway
			}
			add_to_variable = {
				placeholder_var = 30
				tooltip = world_stage_bonus_power_norway
			}
#			custom_effect_tooltip = country_name_france
#			add_to_variable = {
#				placeholder_var = 5
#				tooltip = world_stage_bonus_power_norway
#			}
#			custom_effect_tooltip = country_name_england
#			add_to_variable = {
#				placeholder_var = 5
#				tooltip = world_stage_bonus_power_norway
#			}
		}
	}
	option = {
		name = worldstage.45.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_norway_is_active_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				placeholder_var = 60
				tooltip = world_stage_deploy_power_norway
			}
			add_to_variable = {
				placeholder_var = 30
				tooltip = world_stage_bonus_power_norway
			}
#			custom_effect_tooltip = country_name_france
#			add_to_variable = {
#				placeholder_var = 5
#				tooltip = world_stage_bonus_power_norway
#			}
#			custom_effect_tooltip = country_name_england
#			add_to_variable = {
#				placeholder_var = 5
#				tooltip = world_stage_bonus_power_norway
#			}
		}
	}
	option = {
		name = worldstage.45.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_norway_is_active_tt
			custom_effect_tooltip = country_name_germany
			add_to_variable = {
				placeholder_var = 60
				tooltip = world_stage_deploy_power_norway
			}
			add_to_variable = {
				placeholder_var = 30
				tooltip = world_stage_bonus_power_norway
			}
#			custom_effect_tooltip = country_name_france
#			add_to_variable = {
#				placeholder_var = 5
#				tooltip = world_stage_bonus_power_norway
#			}
#			custom_effect_tooltip = country_name_england
#			add_to_variable = {
#				placeholder_var = 5
#				tooltip = world_stage_bonus_power_norway
#			}
		}
	}
}

# Italy Joins the War
news_event = {
	id = worldstage.48
	title = worldstage.48.t
	desc = worldstage.48.d 
	picture = GFX_news_ww2_starts_wide

	is_triggered_only = yes

	major = yes
	
	immediate = {
		set_global_flag = italy_joined_ww2
		set_global_flag = world_stage_theater_lybia_is_active
		set_global_flag = world_stage_theater_alpes_is_active
		#set_global_flag = world_stage_theater_ethiopia_is_active
		set_variable = { global.theater_owner_italy = 3 }
		set_variable = { global.theater_owner_sicily = 3 }
	}
	
	option = {
		name = worldstage.48.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_lybia_is_active_tt
			custom_effect_tooltip = world_stage_theater_alpes_is_active_tt
			#custom_effect_tooltip = world_stage_theater_ethiopia_is_active_tt
		}
	}
	option = {
		name = worldstage.48.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_lybia_is_active_tt
			custom_effect_tooltip = world_stage_theater_alpes_is_active_tt
			#custom_effect_tooltip = world_stage_theater_ethiopia_is_active_tt
		}
	}
	option = {
		name = worldstage.48.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_lybia_is_active_tt
			custom_effect_tooltip = world_stage_theater_alpes_is_active_tt
			#custom_effect_tooltip = world_stage_theater_ethiopia_is_active_tt
		}
	}
	option = {
		name = worldstage.48.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
		effect_tooltip = {
			custom_effect_tooltip = world_stage_theater_lybia_is_active_tt
			custom_effect_tooltip = world_stage_theater_alpes_is_active_tt
			#custom_effect_tooltip = world_stage_theater_ethiopia_is_active_tt
		}
	}
}

########################################################################
########################## worldstage_surrender ########################
########################################################################

# CHINA SURRENDER
country_event = {
	id = worldstage_surrender.2
	title = worldstage_surrender.2.t
	desc = worldstage_surrender.2.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	immediate = {
		clr_global_flag = world_stage_china_exists
		set_variable = { global.CHI_strength_alsace = 0 }
		set_variable = { global.CHI_strength_westphalia = 0 }
		set_variable = { global.CHI_strength_france = 0 }
		set_variable = { global.CHI_strength_germany = 0 }
		set_variable = { global.CHI_strength_poland = 0 }
		set_variable = { global.CHI_strength_belarus = 0 }
		set_variable = { global.CHI_strength_smolensk = 0 }
		set_variable = { global.CHI_strength_russia = 0 }
		set_variable = { global.CHI_strength_norway = 0 }
		set_variable = { global.CHI_strength_lybia = 0 }
		set_variable = { global.CHI_strength_ethiopia = 0 }
		set_variable = { global.CHI_strength_egypt = 0 }
		set_variable = { global.CHI_strength_italy = 0 }
		set_variable = { global.CHI_strength_siberia = 0 }
		set_variable = { global.CHI_strength_mongolia = 0 }
		set_variable = { global.CHI_strength_tibet = 0 }
		set_variable = { global.CHI_strength_mongolia = 0 }
		set_variable = { global.CHI_strength_bengal = 0 }
		set_variable = { global.CHI_strength_india = 0 }
		set_variable = { global.CHI_strength_china = 0 }
		set_variable = { global.CHI_strength_normandy = 0 }
		set_variable = { global.CHI_strength_sealion = 0 }
		set_variable = { global.CHI_strength_urals = 0 }
		set_variable = { global.CHI_strength_guanxi = 0 }
		set_variable = { global.CHI_strength_alpes = 0 }
		set_variable = { global.CHI_strength_autria = 0 }
		set_variable = { global.CHI_strength_england = 0 }
		set_variable = { global.CHI_strength_netherlands = 0 }
	}
	
	option = {
		name = worldstage_surrender.2.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } NOT = { tag = ROC } }
	}
	option = {
		name = worldstage_surrender.2.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } NOT = { tag = ROC } }
	}
	option = {
		name = worldstage_surrender.2.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } NOT = { tag = ROC } }
	}
	option = {
		name = worldstage_surrender.2.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } NOT = { tag = ROC } }
	}
	option = {
		name = worldstage_surrender.2.fight
		trigger = { tag = ROC }
		custom_effect_tooltip = lose_access_to_trade_resources
		clr_country_flag = tc_fengtian_has_access
	}
	option = {
		name = worldstage_surrender.2.surrender
		trigger = { tag = ROC }
		set_temp_variable = { global.winner_tag = THIS.id }
		if = {
			limit = { OR = { has_global_flag = china_aligned_allies has_global_flag = china_aligned_komintern } }
			if = {
				limit = {
					any_country = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
				}
				random_country = {
					limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
					set_temp_variable = { global.winner_tag = THIS.id }
					log = "A: [?global.winner_tag.GetName]"
				}
			} else = {
				random_country = {
					limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
					set_temp_variable = { global.winner_tag = THIS.id }
					log = "B: [?global.winner_tag.GetName]"
				}
			}
			if = {
				limit = { NOT = { global.winner_tag = ROC} }	# aka, there was someone with the conditions above
				log = "C"
				var:global.winner_tag = {
					5 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = global.winner_tag } }
					218 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = var:global.winner_tag } }
					228 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = var:global.winner_tag } }
					233 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = var:global.winner_tag } }
					234 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = var:global.winner_tag } }
					puppet = ROC
				}
			}
			hidden_effect = {
				every_country = {
					limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } has_war_with = ROC }
					white_peace = ROC
				}
			}
		} else = {
			if = {
				limit = {
					any_country = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } is_faction_leader = yes }
				}
				random_country = {
					limit = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } is_faction_leader = yes }
					set_temp_variable = { global.winner_tag = THIS.id }
				}
			} else = {
				random_country = {
					limit = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } }
					set_temp_variable = { global.winner_tag = THIS.id }
				}
			}
			if = {
				limit = { NOT = { var:global.winner_tag = ROC} }	# aka, there was someone with the conditions above
				var:global.winner_tag = {
					5 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = var:global.winner_tag  add_compliance = 100 } }
					218 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = var:global.winner_tag add_compliance = 100 } }
					228 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = var:global.winner_tag add_compliance = 100 } }
					233 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = var:global.winner_tag add_compliance = 100 } }
					234 = { if = { limit = { controller = { tag = ROC } } transfer_state_to = var:global.winner_tag add_compliance = 100 } }
					puppet = ROC
				}
			}
			hidden_effect = {
				every_country = {
					limit = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } has_war_with = ROC }
					white_peace = ROC
				}
			}
		}
	}
}

# GERMANY SURRENDER
country_event = {
	id = worldstage_surrender.3
	title = worldstage_surrender.3.t
	desc = worldstage_surrender.3.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	immediate = {
		clr_global_flag = world_stage_germany_exists
		set_variable = { global.GER_strength_alsace = 0 }
		set_variable = { global.GER_strength_westphalia = 0 }
		set_variable = { global.GER_strength_france = 0 }
		set_variable = { global.GER_strength_germany = 0 }
		set_variable = { global.GER_strength_poland = 0 }
		set_variable = { global.GER_strength_belarus = 0 }
		set_variable = { global.GER_strength_smolensk = 0 }
		set_variable = { global.GER_strength_russia = 0 }
		set_variable = { global.GER_strength_norway = 0 }
		set_variable = { global.GER_strength_lybia = 0 }
		set_variable = { global.GER_strength_ethiopia = 0 }
		set_variable = { global.GER_strength_egypt = 0 }
		set_variable = { global.GER_strength_italy = 0 }
		set_variable = { global.GER_strength_siberia = 0 }
		set_variable = { global.GER_strength_mongolia = 0 }
		set_variable = { global.GER_strength_tibet = 0 }
		set_variable = { global.GER_strength_mongolia = 0 }
		set_variable = { global.GER_strength_bengal = 0 }
		set_variable = { global.GER_strength_india = 0 }
		set_variable = { global.GER_strength_china = 0 }
		set_variable = { global.GER_strength_normandy = 0 }
		set_variable = { global.GER_strength_sealion = 0 }
		set_variable = { global.GER_strength_urals = 0 }
		set_variable = { global.GER_strength_guanxi = 0 }
		set_variable = { global.GER_strength_alpes = 0 }
		set_variable = { global.GER_strength_autria = 0 }
		set_variable = { global.GER_strength_england = 0 }
		set_variable = { global.GER_strength_netherlands = 0 }
	}
	
	option = {
		name = worldstage_surrender.3.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } NOT = { tag = REI } }
	}
	option = {
		name = worldstage_surrender.3.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } NOT = { tag = REI } }
	}
	option = {
		name = worldstage_surrender.3.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } NOT = { tag = REI } }
	}
	option = {
		name = worldstage_surrender.3.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } NOT = { tag = REI } }
	}
	option = {
		name = worldstage_surrender.3.fight
		trigger = { tag = REI }
		ai_chance = { base = 0 }
		custom_effect_tooltip = lose_access_to_trade_resources
		clr_country_flag = tc_yawatahama_has_access
	}
	option = {
		name = worldstage_surrender.3.surrender
		trigger = { tag = REI }
		ai_chance = { base = 1 }
		hidden_effect = {
			every_country = {
				limit = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } has_war_with = REI }
				white_peace = REI
			}
		}
		if = {
			limit = {
				any_country = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } is_faction_leader = yes }
			}
			random_country = {
				limit = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } is_faction_leader = yes }
				puppet = REI
			}
		} else = {
			random_country = {
				limit = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } }
				puppet = REI
			}
		}
	}
}

# RUSSIA SURRENDER
country_event = {
	id = worldstage_surrender.4
	title = worldstage_surrender.4.t
	desc = worldstage_surrender.4.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	immediate = {
		clr_global_flag = world_stage_russia_exists
		set_variable = { global.SOV_strength_alsace = 0 }
		set_variable = { global.SOV_strength_westphalia = 0 }
		set_variable = { global.SOV_strength_france = 0 }
		set_variable = { global.SOV_strength_germany = 0 }
		set_variable = { global.SOV_strength_poland = 0 }
		set_variable = { global.SOV_strength_belarus = 0 }
		set_variable = { global.SOV_strength_smolensk = 0 }
		set_variable = { global.SOV_strength_russia = 0 }
		set_variable = { global.SOV_strength_norway = 0 }
		set_variable = { global.SOV_strength_lybia = 0 }
		set_variable = { global.SOV_strength_ethiopia = 0 }
		set_variable = { global.SOV_strength_egypt = 0 }
		set_variable = { global.SOV_strength_italy = 0 }
		set_variable = { global.SOV_strength_siberia = 0 }
		set_variable = { global.SOV_strength_mongolia = 0 }
		set_variable = { global.SOV_strength_tibet = 0 }
		set_variable = { global.SOV_strength_mongolia = 0 }
		set_variable = { global.SOV_strength_bengal = 0 }
		set_variable = { global.SOV_strength_india = 0 }
		set_variable = { global.SOV_strength_china = 0 }
		set_variable = { global.SOV_strength_normandy = 0 }
		set_variable = { global.SOV_strength_sealion = 0 }
		set_variable = { global.SOV_strength_urals = 0 }
		set_variable = { global.SOV_strength_guanxi = 0 }
		set_variable = { global.SOV_strength_alpes = 0 }
		set_variable = { global.SOV_strength_autria = 0 }
		set_variable = { global.SOV_strength_england = 0 }
		set_variable = { global.SOV_strength_netherlands = 0 }
	}
	
	option = {
		name = worldstage_surrender.4.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } NOT = { tag = FER } }
	}
	option = {
		name = worldstage_surrender.4.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } NOT = { tag = FER } }
	}
	option = {
		name = worldstage_surrender.4.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } NOT = { tag = FER } }
	}
	option = {
		name = worldstage_surrender.4.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } NOT = { tag = FER } }
	}
	option = {
		name = worldstage_surrender.4.fight
		trigger = { tag = FER }
		ai_chance = { base = 1 }
		custom_effect_tooltip = lose_access_to_trade_resources
		clr_country_flag = tc_khabarovsky_has_access
	}
	option = {
		name = worldstage_surrender.4.surrender
		trigger = { tag = FER }
		ai_chance = { base = 1 }
		set_temp_variable = { global.winner_tag = THIS.id }
		if = {
			limit = {
				any_country = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
			}
			random_country = {
				limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
				set_temp_variable = { global.winner_tag = THIS.id }
			}
		} else = {
			random_country = {
				limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
				set_temp_variable = { global.winner_tag = THIS.id }
			}
		}
		if = {
			limit = { NOT = { var:global.winner_tag = FER} }	# aka, there was someone with the conditions above
			var:global.winner_tag = {
				186 = { if = { limit = { controller = { tag = FER } } transfer_state_to = var:global.winner_tag add_compliance = 100 } }
				187 = { if = { limit = { controller = { tag = FER } } transfer_state_to = var:global.winner_tag add_compliance = 100 } }
				222 = { if = { limit = { controller = { tag = FER } } transfer_state_to = var:global.winner_tag add_compliance = 100 } }
				225 = { if = { limit = { controller = { tag = FER } } transfer_state_to = var:global.winner_tag add_compliance = 100 } }
				215 = { if = { limit = { controller = { tag = FER } } transfer_state_to = var:global.winner_tag add_compliance = 100 } }
				puppet = FER
			}
		}
		hidden_effect = {
			every_country = {
				limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } has_war_with = FER }
				white_peace = FER
			}
		}
	}
}

# ENGLAND SURRENDER
country_event = {
	id = worldstage_surrender.5
	title = worldstage_surrender.5.t
	desc = worldstage_surrender.5.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	immediate = {
		clr_global_flag = world_stage_england_exists
		set_variable = { global.ENG_strength_alsace = 0 }
		set_variable = { global.ENG_strength_westphalia = 0 }
		set_variable = { global.ENG_strength_france = 0 }
		set_variable = { global.ENG_strength_germany = 0 }
		set_variable = { global.ENG_strength_poland = 0 }
		set_variable = { global.ENG_strength_belarus = 0 }
		set_variable = { global.ENG_strength_smolensk = 0 }
		set_variable = { global.ENG_strength_russia = 0 }
		set_variable = { global.ENG_strength_norway = 0 }
		set_variable = { global.ENG_strength_lybia = 0 }
		set_variable = { global.ENG_strength_ethiopia = 0 }
		set_variable = { global.ENG_strength_egypt = 0 }
		set_variable = { global.ENG_strength_italy = 0 }
		set_variable = { global.ENG_strength_siberia = 0 }
		set_variable = { global.ENG_strength_mongolia = 0 }
		set_variable = { global.ENG_strength_tibet = 0 }
		set_variable = { global.ENG_strength_mongolia = 0 }
		set_variable = { global.ENG_strength_bengal = 0 }
		set_variable = { global.ENG_strength_india = 0 }
		set_variable = { global.ENG_strength_china = 0 }
		set_variable = { global.ENG_strength_normandy = 0 }
		set_variable = { global.ENG_strength_sealion = 0 }
		set_variable = { global.ENG_strength_urals = 0 }
		set_variable = { global.ENG_strength_guanxi = 0 }
		set_variable = { global.ENG_strength_alpes = 0 }
		set_variable = { global.ENG_strength_autria = 0 }
		set_variable = { global.ENG_strength_england = 0 }
		set_variable = { global.ENG_strength_netherlands = 0 }
	}
	
	option = {
		name = worldstage_surrender.5.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } NOT = { tag = OSA } }
	}
	option = {
		name = worldstage_surrender.5.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } NOT = { tag = OSA } }
	}
	option = {
		name = worldstage_surrender.5.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } NOT = { tag = OSA } }
	}
	option = {
		name = worldstage_surrender.5.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } NOT = { tag = OSA } }
	}
	option = {
		name = worldstage_surrender.5.fight
		trigger = { tag = OSA }
		ai_chance = { base = 0 }
		custom_effect_tooltip = lose_access_to_trade_resources
		clr_country_flag = tc_osaka_has_access
	}
	option = {
		name = worldstage_surrender.5.surrender
		trigger = { tag = OSA }
		ai_chance = { base = 1 }
		hidden_effect = {
			every_country = {
				limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } has_war_with = OSA }
				white_peace = OSA
			}
		}
		if = {
			limit = {
				any_country = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
			}
			random_country = {
				limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
				puppet = OSA
			}
		} else = {
			random_country = {
				limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
				puppet = OSA
			}
		}
	}
}

# ITALY SURRENDER
country_event = {
	id = worldstage_surrender.6
	title = worldstage_surrender.6.t
	desc = worldstage_surrender.6.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	immediate = {
		clr_global_flag = world_stage_italy_exists
		set_variable = { global.AXIS_locals_france = 0 }
		set_variable = { global.AXIS_locals_lybia = 0 }
		set_variable = { global.AXIS_locals_ethiopia = 0 }
		set_variable = { global.AXIS_locals_egypt = 0 }
		set_variable = { global.AXIS_locals_italy = 0 }
		set_variable = { global.AXIS_locals_alpes = 0 }
	}
	
	option = {
		name = worldstage_surrender.6.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
	}
	option = {
		name = worldstage_surrender.6.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } }
	}
	option = {
		name = worldstage_surrender.6.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } }
	}
	option = {
		name = worldstage_surrender.6.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } }
	}
}

# NETHERLANDS SURRENDER
country_event = {
	id = worldstage_surrender.7
	title = worldstage_surrender.7.t
	desc = worldstage_surrender.7.d 
	picture = GFX_news_ww2_starts

	is_triggered_only = yes

	major = yes
	
	immediate = {
		clr_global_flag = world_stage_netherlands_exists
		set_variable = { global.NET_strength_alsace = 0 }
		set_variable = { global.CHI_strength_westphalia = 0 }
		set_variable = { global.CHI_strength_france = 0 }
		set_variable = { global.CHI_strength_germany = 0 }
		set_variable = { global.CHI_strength_poland = 0 }
		set_variable = { global.CHI_strength_belarus = 0 }
		set_variable = { global.CHI_strength_smolensk = 0 }
		set_variable = { global.CHI_strength_russia = 0 }
		set_variable = { global.CHI_strength_norway = 0 }
		set_variable = { global.CHI_strength_lybia = 0 }
		set_variable = { global.CHI_strength_ethiopia = 0 }
		set_variable = { global.CHI_strength_egypt = 0 }
		set_variable = { global.CHI_strength_italy = 0 }
		set_variable = { global.CHI_strength_siberia = 0 }
		set_variable = { global.CHI_strength_mongolia = 0 }
		set_variable = { global.CHI_strength_tibet = 0 }
		set_variable = { global.CHI_strength_mongolia = 0 }
		set_variable = { global.CHI_strength_bengal = 0 }
		set_variable = { global.CHI_strength_india = 0 }
		set_variable = { global.CHI_strength_china = 0 }
		set_variable = { global.CHI_strength_normandy = 0 }
		set_variable = { global.CHI_strength_sealion = 0 }
		set_variable = { global.CHI_strength_urals = 0 }
		set_variable = { global.CHI_strength_guanxi = 0 }
		set_variable = { global.CHI_strength_alpes = 0 }
		set_variable = { global.CHI_strength_autria = 0 }
		set_variable = { global.CHI_strength_england = 0 }
		set_variable = { global.CHI_strength_netherlands = 0 }
	}
	
	option = {
		name = worldstage_surrender.7.axis
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } NOT = { tag = HIR } }
	}
	option = {
		name = worldstage_surrender.7.komin
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } NOT = { tag = HIR } }
	}
	option = {
		name = worldstage_surrender.7.allies
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } NOT = { tag = HIR } }
	}
	option = {
		name = worldstage_surrender.7.other
		trigger = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 4 } } NOT = { tag = HIR } }
	}
	option = {
		name = worldstage_surrender.7.fight
		trigger = { tag = HIR }
		ai_chance = { base = 0 }
		custom_effect_tooltip = lose_access_to_trade_resources
		clr_country_flag = tc_hirado_has_access
		add_ideas = HIR_main_land_refugees
	}
	option = {
		name = worldstage_surrender.7.surrender
		trigger = { tag = HIR }
		 ai_chance = { base = 1 }
		if = {
			limit = { has_global_flag = netherlands_aligned_axis }
			hidden_effect = {
				every_country = {
					limit = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } has_war_with = HIR }
					white_peace = HIR
				}
			}
			if = {
				limit = {
					any_country = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } is_faction_leader = yes }
				}
				random_country = {
					limit = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } is_faction_leader = yes }
					puppet = HIR
				}
			} else = {
				random_country = {
					limit = { OR = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 1 } } var:world_stage_metropolis = { check_variable = { world_stage_coalition = 2 } } } }
					puppet = HIR
				}
			}
		} else = {
			hidden_effect = {
				every_country = {
					limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } has_war_with = HIR }
					white_peace = HIR
				}
			}
			if = {
				limit = {
					any_country = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
				}
				random_country = {
					limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } is_faction_leader = yes }
					puppet = HIR
				}
			} else = {
				random_country = {
					limit = { var:world_stage_metropolis = { check_variable = { world_stage_coalition = 3 } } }
					puppet = HIR
				}
			}
		}
	}
}

#######################################################################
############################ worldstage_news ##########################
#######################################################################

news_event = {	# Ataturk Dies
	id = worldstage_news.1
	title = worldstage_news.1.t
	desc = worldstage_news.1.d 
	picture = GFX_worldstage_news_ataturk

	is_triggered_only = yes

	major = yes major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	option = {
		name = worldstage_news.1.a
		trigger = { unification_candidate = yes }
	}
	option = {
		name = worldstage_news.1.b
		trigger = { unification_candidate = no }
	}
}

news_event = {	# Vargas' Coup
	id = worldstage_news.2
	title = worldstage_news.2.t
	desc = worldstage_news.2.d 
	picture = GFX_worldstage_news_vargas

	is_triggered_only = yes

	major = yes major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }

	option = {
		name = worldstage_news.2.a
		trigger = { has_government = fascism }
	}
	option = {
		name = worldstage_news.2.b
		trigger = { NOT = { has_government = fascism has_government = communism } }
	}
	option = {
		name = worldstage_news.2.b
		trigger = { has_government = communism }
	}
}

news_event = {	# EcuadorianPeruvian War
	id = worldstage_news.3
	title = worldstage_news.3.t
	desc = worldstage_news.3.d 
	picture = GFX_worldstage_news_peru_ecuador

	is_triggered_only = yes

	major = yes major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	option = {
		name = worldstage_news.3.a
		trigger = { OR = { tag = OKI tag = AMC } }
	}
	option = {
		name = worldstage_news.3.b
		trigger = { NOT = { tag = OKI tag = AMC } }
	}
}

news_event = {	# Italy Occupies Albania
	id = worldstage_news.4
	title = worldstage_news.4.t
	desc = worldstage_news.4.d 
	picture = GFX_worldstage_news_albania

	is_triggered_only = yes

	major = yes major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	option = {
		name = worldstage_news.4.a
		trigger = { has_government = fascism }
	}
	option = {
		name = worldstage_news.4.b
		trigger = { NOT = { has_government = fascism } }
	}
}

news_event = {	# Metaxas' Coup
	id = worldstage_news.5
	title = worldstage_news.5.t
	desc = worldstage_news.5.d 
	picture = GFX_worldstage_news_metaxas_coup

	is_triggered_only = yes

	major = yes major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	option = {
		name = worldstage_news.5.a
		trigger = { has_government = fascism }
	}
	option = {
		name = worldstage_news.5.b
		trigger = { NOT = { has_government = fascism } }
	}
}

news_event = {	# Metaxas' Death
	id = worldstage_news.6
	title = worldstage_news.6.t
	desc = worldstage_news.6.d 
	picture = GFX_worldstage_news_metaxas_death

	is_triggered_only = yes

	major = yes major = yes show_major = { NOT = { has_country_flag = hide_worldstage_notification } }
	
	option = {
		name = worldstage_news.6.a
		trigger = { OR = {  has_government = fascism has_government = netruality has_government = autocracy } }
	}
	option = {
		name = worldstage_news.6.b
		trigger = { OR = { has_government = democratic has_government = democratic_socialism has_government = communism } }
	}
}