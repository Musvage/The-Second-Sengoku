################################################################
########            Hotfix 1.5.4 "Cornflakes"           ########
################################################################
- Added information dialogs to comply with the EU General Data Protection Regulation (GDPR).
- Fixed an issue common in China where takeover of nation territory from events and during war would drop all foreign occupation.
- Fixed a crash in some mods when an admiral would gain spotting traits in a certain order.


################################################################
########            Hotfix 1.5.3 "Cornflakes"           ########
################################################################

##################################
# AI
##################################
- Improved ai use of planes and air missions

##################################
# Bugfix
##################################
- Hotjoining in multiplayer or loading saves no longer breaks the 3d model viewer
- 3d model viewer has some improved UI work and avoids overlap on designer icon in tech screen
- Manchukuo assertiveness focus now grants new puppet level as expected
- Restored diplomatic information of friends and enemies list immediately after reloading a save.
- Prevented extreme cases of unoccupied countries with no remaining war support from immediately surrendering to an enemy in an offensive war after winning a separate defensive war.


##################################
# Stability & Performance
##################################
- Added safety layers to rendering that should hopefully avoid some crashes on OSX and on AMD gfx cards
- Added a performance optimization tied to non-existant nations calculating strategies, was more apparent on big mods
- Fixed a rare crash when a country tried to declare a war on a puppet of another country that is in the same faction as aggressor.
- Fixed a rare CTD case when someone accepts invitation to a war when they shouldn't have.

################################################################
########            Patch 1.5.2 "Cornflakes"            ########
################################################################

##################################
# Feature
##################################
- Now it's possible to view the 3d models in the division designer and in the tech view. Also in the division designer, it's possible to choose a preferred 3d model to be used by that template.
- Free Battleships DLC that never really worked, has been moved into the base game.
- Holding shift now creates army group fronts without creating sub army fronts

##################################
# AI
##################################
- Garrison order improvements
- Fixed AI not using its military factories to their fullest when it is not in need of equipment. Now it will produce stuff as long as it has enough resources
- an AI chinese warlord that is at war with Japan will now be very eager to join the united front.
- Added AI strategies to the Baltics and Finland to make them more eager to join Germany's faction if Germany has chosen "Safeguard the Baltics" and/or "Support the Finns".
- Made german AI focus more on non-civilian construction between 1937-40
- Some improvements for naval leader assignment to reduce reshuffling.


##################################
# UI
##################################
- Listed save games now has proper "hover mouse over" effect
- Fixed army insignia positioning.
- New portrait of Von Lettow-Vorbeck for GER.
- The colored background on army groups along the bottom of the screen now intercept mouse clicks, not letting them click through to the map and select stuff.
- Popup windows for declaration of war, peace, and a few others will now auto-close after timeout when running a hands-off or any other case with human AI turned on.
- Added a confirmation pop up while assigning every unit in army to a different army's front orders  
- Added drag & drop to reorder theater groups & pinned regions
- Added drag & drop to reorder armies & army groups  
- Soviet scorched earth tactics decision now has a tooltip showing the effect
- moved check for low popular support in PRC tree to a scripted trigger to make bypass tooltips more appealing
- Scorched Earth decisions are now hidden if they would have no effect
- When choosing divisions to use as volunteers, the interface should now keep selection when game is running. Would previously deselect all, as the interface was refreshed.
- Tooltip for creating ocuntry leaders with traits look similar to how traits are displayed in the country view.
- Added timer icon showing that low efficiency can be due to air wings recently arriving in a region.
- Added an explanatory tooltip to Manchukuo seize arms decisions.
- "Field marshal traits now go red if assigned to command an army. Added tooltip that explains it when the trait is hovered.
- Added an advisor tooltip to "The Unthinkable" option.
- Fixed some trait squeezing problems in combat log screen when there are too many traits.
- Added order highlighting when mouse hovers over army shields in theater or plan execute/stop buttons 


##################################
# Modding
##################################
- Removed duplicate static_modifiers script. the ones in modifiers folder is what we use now
- transfer_navy and transfer_ship effects can now use scope targets for their target (e.g target = FROM)
- Mods marked as dependencies are now loaded in the correct order
- Added on daily action (use cautiously!)
- Added validation of equipment bonus when ideas are loaded.
- Added cancel_if_not_visible parameter to decisions. Cancels a decision if it's visible trigger is false.
- Generating the exact same type of wargoal against the same country now ignores the effect.
- Enabled equipment bonus validation for modders
- Added define to tweak color of invalid trait "TRAIT_INVALID_FOR_ASSIGNMENT_COLOR".
- Added modifiers static_anti_air_damage_factor and static_anti_air_hit_chance_factor.
- Now it is possible to create your own interfaces with mods. Windows, buttons, textfields, and it's actions can now be scripted.
- Value triggers are now accessible as dynamic variables.


##################################
# Database
##################################
- Updated game credits.
- "Danzig or War" now gives core in Danzig.
- "Reassert Eastern Claims" now gives core on Memel.
- Sun Tzu Reborn achievement is now possible to achieve (requires level 9 Field Marshal).
- Communist Byzantium now has the correct flag.
- "Expand the Imperial Guards"-spawned troops for MAN are no longer locked
- Industrial Land Appropriation no longer repeatable for the same state.
- Fixed date requirements for AI values for Ichi Go and Test the Soviets decisions (AI was not prevented from taking these before certain dates).
- Reworked Anschluss bypass conditions.
- Fixed correct state for "Ostwall" forts.
- Fixed art for Japanese Last Stand command power ability.
- "Support the Anti-Fascist War" and "Guns for the Anti-Fascist War" decisions are now targeted decisions.
- Adjusted Polish and German provinces and states to make historical German WW1 borders possible, as well as adding Oder-Neisse line.
- Adjusted Vojvodina and Serbia states to make Austro-Hungarian borders more historical.
- Renamed "Alsace" to "Alsace-Lorraine", and "Lorraine" to "Franche-Comte"
- Added 1x BB tech bonus to French focus "Capital Ship Focus" to bring it in line with "Carrier Focus".
- ai strategy databases are reloadable now
- enabled Japanese equipment names for Manchukuo
- fixed a few naming issues in German name list
- A nationalist China losing a power struggle will now get a cosmetic tag to distinguish it from new nationalist China. If a warlord who has previously taken over nationalists loses a power struggle, they will lose their cosmetic tag. This should fix the 3 China issue.
- changed flavor name of a Manchukuo rifle after two hour discussion of Manchurian small arms development
- added Paul von Lettow-Vorbeck as a general to Imperial Germany
- Updated 'The People Have Stood Up' achievement to better fit description in steam.
- Updated 'My Ships Don't Lie' achievement to fit description in steam.
- Fixed a duplicate name of a German destroyer
- Fixed a few naming inconsitencies in French Division Namelists and Added new Namelist for late-war French Armored Divisions
- Elsass-Lothringen and victory points now renamed back to their French counterparts of France wins the war and retakes it.
- Several text translations has been added and improved.
- Fixed some inconsistencies in name lists for French-speaking countries.
- Renamed Communist Roman Empire to Communitas Proletariique Romani.
- Removed Zhang Lan as Nationalist Chinese Democratic leader due to previous communist committments (replaced with Weng Wenhao)
- Soviet volunteer group and flying tiger focuses now bypass if someone else has already completed that focus to avoid doubles.


##################################
# Balance
##################################
- Whampoa College National Focus now also adds 1 planning point to existing leaders as well as new ones
- Starting land doctrine techs now have normal tech base costs (so now at 50% of before)
- Slightly rebalanced chance of French intervention resulting from Return of the Kaiser.
- Production bonus can go negative now and slow down your equipment production
- Generals gains less XP as combats drag on (down to 10% in a month)
- Generals gains more XP if they are dealing more damage compared to enemies (up to 4x while you are doing 4x damage compared to enemy)
- added an option to Chinese provocation event that allows Japan to withdraw from the continent
- Winter War peace treaty no longer hands over Petsamo (SOV will have to get that the hard way)
- Neutral ideology is now allowed for puppets.
- Halved the extra wounding chance on the reckless trait
- Cautious trait now reduces chance to get wounded (making it the polar opposite of reckless).
- Changed mobilization impact from positive war support to 30 % (up from 3%)
- japanese ideology advisors are now only locked behind focuses for Waking the Tiger DLC owners
- Reworked the Assertiveness Branch of the Manchukuo Tree: 
   - added a decision unlocked from taking control of the railroads that gives 4 CIV factories over the course of a year
   - removed factories from legislative council, purge general affairs and control the railroads
   - purge the general affairs council now removes Kwantung veto
   - bolster nationalism now allows recruiting bandits. if bandits are still active in the country, taking these decisions removes the spirit
   - added a decision to local arms procurement that adds an idea giving dramatically reduced cost for small arms at the cost of reduced reliability
   - removed autonomy gain from Assertiveness focus (made no sense)
   - added a decision to five people armies allowing the raising (and disbanding) of Manchu Banners, represented by 5 large infantry divisions
   - added a decision to the purge general affairs council allowing player to pay command power to seize Japanese army depots in the case of war, giving increasingly large injections of equipment into stockpile and corresponding attack and defense penalties to Japan for a limited time
   - reduced the impact of bolster nationalism spirit﻿
- "Changed Command Power cost for Communist China's Infiltration decisions (-0.01 => -0.2) and the Nationalist/Japanese counter (-0.05 => -0.1).
- Increased command power cost (-0.02 => -0.2) for gaining army support in preparation for a civil war. Old values were not rebalanced properly after major system rework."
- Added surrender limit penalty when at low war support. Scales from 0 to -30%.
- Reduced air superiority stat of strategic bombers.(1 => 0.01)
- Increased heavy fighters air superiority (1 => 1.25), so they are better at something that isn't shooting bombers...
- Lowered impact on speed due to enemy air superiority (-0.5 => -0.3).
- Lowered impact on defense due to enemy air superiority (-0.5 => -0.35).
- Changed cap of "Air support" modifier from CAS assisting land unit in combat from 21% to 35%.
- Division anti air reduces damage to the division caused by close air support attacks, in proportion to the AA's ability to shoot down planes.
- Corrected AA damage reduction tooltip to show numbers in red.
- Reduced factory output penalty from long march spirit for PRC (now -15%/-5%, down from -25%/-10%).
- Changed penalty from Chinese idea Illegal Regime (-0.35 => -0.2)
- Last 3 radar techs now increase aim of static AA guns by 20% each.
- Each intermediary AA tech now adds 8% damage reduction from enemy bombers.
- Each AA equipment unlock now increases static AA damage output by 10%.
- Air bases now take 50% less damage from bombing.
- Reduced negative production modifier for Canada and Australia's version of the great depression (for TfV owners).
- The German War Economy Focus now requires 50% war support.
- MEFO bills base cost reduced by 0.05 PP, added -5% Consumer Goods, and increased build speed bonuses to 25%.
- Rebalanced Nationalist Chinese Focuses: Welfare Focuses now give 10 War Support (up from 5), Democracy Focuses that gave stability or War Support have been increased to give 10 instead of 5, added a military factory each to expanding the Taiyuan and Hanyan Arsenals.
- Balanced temperatures for commando trait to < -15 or > 27.
- Chinese Scorched Earth Tactics and Industrial Evacuation Focuses reduced to 35 days.
- Made MEFO PP cost now be substracted -after- modifiers to PP are applied, resulting in a more logical tooltip, and a net PP increase for the player compared to how it was before.


##################################
# Bugfix
##################################
- Improved Spanish translations.
- Took map wrap-around line in the Pacific into account when computing a state's center point, correcting East Siberia's center from its previous position in the Norwegian Sea.
- Stopped the Focus.IgnorePrerequisites cheat from being used in an ironman game by first turning it on in a normal game.
- Prevented various exploit methods which could pull divisions out of naval transfer convoy combat by cancelling or changing division orders.
- Fixed incorrect default of convoy efficiency when writing persistent data, which had a small chance of causing out-of-syncs.
- Fixed daily change in party popularity being inaccurate.
- Changing of ruling party to unaligned now cancel all boost party popularity
- Naval combat report will now only appear if any damage has been dealt
- Fixed naval combat report not mentioning some losses when merging with older ones in the same province
- Fixed planes shot by carrier fighters not showing in the strategic air view.
- Fixed port strikes with no participating planes
- Fixed planes shot by carrier fighters not showing in the strategic air view.
- Air permission can no longer be obtained from both side of a war and observe similar restrictions as land volunteer.
- Added nb used convoys and nb free convoys to the checksum for OOS detection
- German historical DLC now properly enabled all picture replacements for events
- Fixed a loading order issue that could mess up some triggers for ideas on starting the game
- Japanese surrender events for MAN/CHI no longer incorrectly mentions transferring Korea to MAN/CHI control.
- Return of the Kaiser event when rescuing him through war now triggers upon control of Holland state; previously triggered from capitulation which could bug out if Holland was not in a faction when it surrendered.
- MEFO bills are no longer removed if Anschluss is rushed before the bills are extended a second time.
- Drastically increased the WT generation required for UK to want to kick Imperial Germany out of its faction when having taken the "Alliance with the Shade" focus. Germany now needs to have created 81% more WT than the faction average, up from 34%.
- "Support Anti-Fascist War" decision for USA now correctly removes off-map factories again after the duration ends.
- Fixed some possible problems with text save games while writing arrays
- Fixed a crash after user directory is cleared using the launcher while there are enabled mods in it
- Fixed research all cheat not working for some of the researches
- Fixed a bunch of typos
- Added localization for 'send attaché' action in diplomacy tab/country list screen
- Fixed UI scale glitches with equipment stockpile line graphs
- added a bypass for Build up manchurian army focus in japanese focus tree
- added a bypass for Communist Chinese focus if low_popular support spirit is not present
- fixed critical spelling error in bombing damage modifier tooltip
- fix for unlocalised bypass requirement in Soviet Advisers focus
- the opinion bonus from Italian befriend Japan focus is now correctly applied to Japan
- integrate the warlord army decision now transfers any generals and only creates leaders if the target has not taken personal leadership focus
- Fixed general selection menu stating that Field Marshal can "command 5 armies" when it should be "24 division".
- Fixed tooltip for how many divisions a corps commander can control showing up when trying to assign a Field Marshal.
- Fixed invalid equipment bonus for PRC_peoples_war, PRC_maoism, CZE_naval_focus and bofors.
- Ichi go spirit targeted modifier now works against all the Chinese nations.
- Added attache relation gfx for diplomacy view
- Command power cost on abilities now displays 2 decimals.
- Fixed tooltip for integrate warlord decisions using a flag with wrong localisation.
- Fixed integrate warlord decisions effect running immediately instead of after 90days.
- Re-added localisation for custom tooltips in Chinese Industry Relocation decisions.
- Removed auto call for faction members when a country is the target of war declaration.
- Navies on convoy escort missions now try to help allies if there are no friendly convoys to help.
- Fixed 'org loss while moving' leader modifier not being applied
- Volunteers sent to a countries which became enemies, will now be sent back home (so your divisions don't fight on both sides of the conflict).
- Fixed yet another grammatical issue in texts about the attaches.
- XP is now awarded in the case of unit being destroyed with nowhere to run and for overruns it is awarded to units both in current and in destination province if enemies.
- Fixed bug where a cavalry 3d models didn't get a proper winter camo
- Fixed volunteers not properly being sent back to their rightful owner.
- Corrected British division namelist to use brackets instead of apostrophes.
- Changed scavenger trait to additive modifier
- Fixed a broken bypass in Japanese Liberate Manchuria focus.
- Changed completion trigger for 'Fuhrer directive 21' mission to include allies controlling the required states.
- Added scripted trigger for a state being controlled by ROOT country or an ally to them.
- Fixed Austria-Hungary being formed multiple times as a result of ""Rekindle Imperial Sentiment"" focus.
- Fixed Austria-Hungary news event referring to ""Austria-Hungary taking the lead"". Now correctly refers to country's old tag.
- Re-Forming Austria_Hungary now flips government to Unaligned and makes Otto von Habsburg country leader.
- Hungary can now choose ""Tade Deal with Germany"" focus with non-Fascist Germany.
- ""Break the Anglo-French Colonial Hegemony"" focus now also correctly gives claims on Palau, Papua, and Samoa.
- ""Reinstate Imperial Possessions"" and ""Reintegrate Luxemburg and Alsace-Lorraine"" focuses are now also available if France is puppeted or if Germany owns Alsace-Lorraine.
- ""Reinstate Imperial Possessions"" and ""Reintegrate Luxemburg and Alsace-Lorraine"" focuses now rename Alsace-Lorraine to Elsass-Lothringen, Strasbourg to Strassburg, and Mulhouse to Mulhausen.
- Greater Hungary can no longer be formed if Austria-Hungary was formed via the ""Rekindle Imperial Sentiment""-spawned decision.
- Fixed panzer_leader trait not gaining xp if a non-armor unit was participating in the combat. Now it gains xp if more than 40% of the army under the leader control's is armored at the time of the combat.
- Reworked the AI's pathfinding algorithms, so it should now take more reasonable routes, when it comes to combinations of land and naval transportations.
- The battle plan window is now hidden in naval and air map mode.
- Fixed drag and drop causing 'new army' portrait to ignore clicks
- Added temporary penalty for assigning airplanes to a new region or receiving reinforcements.
- It's no longer possible to capture naval/air equipment when it gets destroyed in land combat.
- More fixes in the texts translations.
- Fixed a wrong tooltip in Manchukuo Five People Armies focus.
- Fixed two wrong cavalry division names in British name lists.
- "Danzig for Guarantees" now renames Poznan to Posen, if accepted.
- Added bypasses for "Align Hungary" and "Align Romania" focuses, if they are in Germany's faction.
- "Reinstate Imperial Possessions" and "Reintegrate Luxemburg and Alsace-Lorraine" now also transfer Alsace-Lorraine to Germany.
- Nuking now uses the highest VP in the state when calculating war support penalty instead of specific province nuked. Multiplier from infrastructure is now calculated before they are destroyed.
- Drawing defensive orders now takes army groups into account when counting divisions, so it displays the correct number of divisions that will be assigned.
- Fixed tooltip of panzer_leader trait for the xp gain.
- Fixed cancel_trigger for timed decisions not removing, but instead executing remove_effect if the mission was completed.
- Fixed guaranteeing nations not being auto-called into war when neither the guaranteeing country nor the attacking country are in factions.
- Yalta Conference event now should allocate correct states to DDR and Poland.
- MEFO bills now gives a 20% construction speed bonus to military factories, dockyards, forts and coastal forts, air and naval bases, AA buildings, and Radar stations, instead of -20% consumer goods.
- MEFO bills now renew every 180 days instead of every 90 days.
- MEFO bills - Slightly increased the base political power cost and the political power cost ramp-up.
- Unaligned Germany now loses MEFO bills when the German civil war begins (but is not required to pay for them). MEFO bills and mission are now transferred to the Nazi side of the civil war.
- Unaligned/Democratic Germany now gets a temporary "Rebuild the Nation" National Spirit that gives -20% consumer goods bonus for 365 days, when completing the "Rebuild the Nation" national focus.
- "Rebuild the Nation" national focus now takes 70 days to complete, up from 35 days.
- Previous "Rebuild the Nation" national spirit has now been renamed to "National Revitalization".
- Fix issue where scripted events that try to add countries to a civil war were silently doing nothing if world tension is too low. The world tension check should not automatically apply to scripted events; the country should just be directly added to the war, which is now once again the case.
- Fixed nuke events referencing the wrong states/leaders.
- Fixed a spelling error in a tooltip for Attaches.
- Fixed navy leaders not gaining xp.
- Fixed a news event referencing a Hungarian king that didn't necessarily exist.
- Added an appropriate Apostrophe to King's Own Cavalry division.
- Warlords that have inherited the Incompetent Officer national spirit from Nationalist China can now take the decision to get rid of it.
- The Japanese kodoha national focus path will now only invite Japan to the axis once.
- Countries on the winning side of a war but occupied by a different faction can no longer be marked as untouched, allowing them to be annexed or puppeted by the occupiers even if the actual enemies never did any damage to them.
- Unit leaders go into cooldown when you disband the army now.
- Capped minimum supply consumption to 0.05, so it's no longer possible to get it negative and suffer huge penalties.
- Forced countries entering into a dependency relation to cancel any war relation they have between them.
- Fixed the Call Ally diplomatic action to have the recipient join the correct war.
- Clarified Treaty with USSR" requiring "Anti-Soviet Pact" to not have been taken.
- Army group orders now does not mention number of unit information in them.
- Made the call ally tooltip properly indicate when a civil war is not joinable by an ally due to low world tension, just as it already does for the other country if they want to initiate a join war action.
- Call to war and join war actions in the diplomacy screen no longer show every individual war relation in the list of wars, but just the primary one.
- Allowed a country to be invited into peace conferences even if some of their faction allies are at war with the winners of the war, as long as the country being invited is at peace with all the winners and at war with the losers.
- Fixed a bug that caused a navy leaders not gaining experience.
- Fixed killing encircled units not giving intended amount of flat experience gain.
- 3d model viewer > Camera moves a bit towards up when you zoom into the model.
- 3d model viewer > multiple technology views being open at the same time, are no longer showing the same model.
- 3d model viewer > Fixed unit models shown on map, not being updated for allies when you select a custom model
- 3d model viewer > Several other improvements.
- 3d model viewer > Reduced min zoom levels for 3d model viewer.
- 3d model viewer > Non infantry equipments does not use fallback infantry models in tech window anymore.
- Fixed drag and drop for armies in the same army group.
- Fixed bug in a war relations being broken after loading a save.
- Fixed war members calculation that incorrectly excluded friends in a war due to not being in the main faction, which could incorrectly lead to premature capitulations.
- Fixed Dispersed Industry IV translation.


##################################
# Stability & Performance
##################################
- Fixed small memory leak.
- Fixed uninitialized variable in graphical settings, which in theory could cause an undefined game behaviour.
- Fixed CTD when loading a savegames which was related to the air wings.
- Fixed OOS caused by "local resistance" data not being properly cleared.
- Improved initial loading time a bit. The naval distance calculations are much faster, and is done only once (or whenever a game changes has been detected that could affect the naval distance calcluations). At every next game start, the loading process skips the naval distance calculations by just loading the cached data.
- Fixed peace conference behavior and crash in the case that one or more of the winners have been occupied by a different winning faction.
- Fixed SS recruitment crashing the game under very specific circumstances.
- Fixed CTD when asking a lend lease to some AI countries within the first day of the game.
- Puppets surrender with their overlords and any other majors even if they have been in the war for fewer days than normally required to surrender. This fixes a crash elsewhere when transferring the puppet in a peace conference.
- Attempt to gracefully skip over opponents who are no longer at war with each other when cleaning up war relations at the conclusion of a peace conference.  This avoids crashes when multiple peace conferences get initiated and completed simultaneously, especially due to scripted white peace events.
- Ensured all buildings in the newly-changed Polish and German states are present in those states, to avoid crashes.
- Fixed CTD on create_unit effect with invalid template name. Now shows an error instead.
- Mod files created through the launcher tool, are now UTF8-BOM to avoid errors when using the file later.



################################################################
########            Patch 1.5.1 "Cornflakes"            ########
################################################################

##################################
# AI
##################################
- "Desperate AI" improvements, ai know does not switch escape provinces as long as last one valid and fixed a case where it can try to escape a province that is also desperate
- fixed a case where armor divisions were being allowed in defense fronts


##################################
# UI
##################################
- Fixed positioning of add army portrait btn.
- Fixed Zaibatsus Challenged tooltip issue.
- Fixed balance, tooltips, and events for ideology switching decisions.
- Fixed border clash focus icons lost gfx
- Added infantry tech level 3 3D model. Copies lvl 2 version.
- Fix construction showing more building levels to be repaired than what was constructed.
- fixed naval production gui not updating when you switch equipment
- fixed ui scaling no longer breaking tooltips
- added tooltip that explains increased capacity for garrison orders
- Fixed battle plan tools going behind army list stopping you from training on small screens
- Danzig for Guarantees now mentions getting Poznan as well.
- fix for minimap positioning with UI scaling
- fixed drag and drop not working with ui scale
- Division Designer > Better layout, with instant preview when mouse over the edited battalion.
- Aligned division count on badge in theatre view to match army badge.
- Right click on an army group leader portrait while having unassigned divisions, will assign them to it's sub groups in a smart way.
- Added bunch of generic focus icons.
- Added icons for German CV CAS tech level 3, with a flavour names.
- Fixed icon for generic focus for tank production.
- Added icon for attack switzerland focus.
- Minimap is now working with scaled interface.
- Fixed a missing picture in a stability event.
- Adjusted trade window resource quantity label to be large enough to show more than three digits instead of wrapping.
- Updated leader promotion message to clarify that the decrease in skills will be temporary.
- From now, the default view for the selected armies, is the one that lists all the divisions (not armies within it's army group).


##################################
# Modding
##################################
- Added cancel_trigger to all types of decisions. cancel_trigger will not run remove_effect when true.
- Missions now use cancel_trigger to abort before completion and remove_trigger to remove and run remove effect if the decision stays in the interface.
- Added modifier army_org_regain
- Fixed "random variables" being broken with tooltips
- fixed an issue where mods were loaded in wrong order and couldnt overwrite DLC
- When using the effect add_offsite_building in a wrong way, the error log will warn about it.
- Added error logs for invalid wargoals in create_wargoal & declare_war_on effects.
- Event scripts may now use "GetRulingPartyLong" to print the full name of it.
- Mods with badly scripted effect, which could cause the countries to declare war on itself, will be just silently ignored.


##################################
# Database
##################################
- removed a focus from PRC 1939 start that caused an error
- Fix for two wrong division name lists in the 1939 start
- Event pictures "communists cheer" and "American hunger strike" now have interface entries
- unlocked Chennault as adviser for manchukuo and reduced cost for him
- Reenabled generic tank manufacturer idea for countries without
- Returned Samoa to its (then) rightful owner
- "Forced loans" decision is now repeatable.
- Assertiveness focus now bypasses if manchukuo is already free.
- Communist Japan can now only call for Soviet Volunteers once
- Unaligned Germany's Anti-Comintern Pact no longer invites India and China and other Asian minors that don't border SOV.
- Blow the Suez Canal event now has correct localisation.
- "Object to Attachés" decision is now more limited and its effects now depend on relative strength of nations.
- AST and SAF no longer locked out of Appeasement tree by Germany opposing Hitler.
- Adjusted bypass requirements for "Danzig for Guarantees", "Safeguard the Baltic", and "Support the Finns".
- "Schlieffen Once More" is now available in case of Franco-British Union.
- Added some missing (and fixed some existing) text translations to Russian.
- Political advisors unlocked from PRC/CHI focus trees, are now available to warlords that take over the government.
- Fixed some missing event pictures in Japanese border war.
- Added plenty of missing texts translations in various languages.
- Added bypasses to the "Japanese Non-Aggression Pact" focuses.
- "Collaboration with the Japanese" focus, is now available for subjects (was blocking Manchukuo otherwise).
- Fixed a typo and a missing event picture in some PRC event.


##################################
# Balance
##################################
- Germany should no longer lose 50% of its equipment upon starting the Oppose Hitler civil war.
- Communist Chinese focus tree, now get's some infantry equipment production bonuses, for better gameplay balance.
- Balanced XP gain bit. Overall speed is now faster. Earlier levels cost a bit more and late levels are now more reachable.
- Slight buff to PRC focus Yannan base area (+1 infra, +1 building slot).


##################################
# Bugfix
##################################
- Prevented exploit of tech swapping military doctrines by starting level 2 tech in the current branch before switching to a different branch.
- Fixed Chinese Industry Relocation decisions to check for control of state.
- Changed remove_trigger to cancel_trigger for Political Struggle decisions to avoid sudden influx of points when someone claimed national leadership
- Reinstate Imperial Possessions no longer removes core for Alsace from France.
- Fixed not creating combats while moving into provinces that has combats that you can't join (where both are enemies)
- Made "Triumph for X" decisions non-repeatable.
- fix for double inflation spirit appearing under certain circumstances
- their cores are no longer lost when you puppet a nation (fixes soups in peace deals when AI cant liberate for example)
- Now guarantees can be mutual (fixes a path in japanese focus tree)
- Fixed frontlines around wastelands sometime disappearing.
- JAP nuke surrender decision now clears global flags
- PRC that takes over through political struggle will not inherit negative spirits from China
- added bypass checks for Confrontation with the warlords focus
- blocked taking national leadership if subject or leader is subject
- Fixed a case which could prevent nations from ever surrendering
- Manchukuo now loses Kwantung Veto when released through the Japanese focus tree.
- Changed local_org_regain to army_org_regain for communist china's spirits
- added bypass checks to Finish the Fight focus for japan
- Fixed planes being engaged in combat in another region than the one they are assigned to
- Added recalculation of support points if a state involved in the struggle changes controller
- Fixed an issue where states would show as being part of the strugle, though they were controlled by an enemy nation.
- Fixed female unit leaders being converted to males on save/reload
- Surprise Attack Plan idea for civil wars is now functional.
- Creating a Manchurian Airforce focus will now bypass if MAN does not exist
- Enabled increase Airlift decision for a China that is in the United Front
- Fate of the Imperial Family no longer requires Manchukuo to exist.
- Decision to escalate to a border conflict is now cancelled if in faction with the target
- Fixed issue where decisions updating decisions to remove could skip an element in the array if one was supposed to be removed
- fixed an issue where Manchuko's Assertiveness branch broke if Japan went with support Kodoha (lost Puyi, lost special autonomy level)
- Forcefully removing support for opposition in a state now properly reduces the gloabl support for the leader of China
- Added bypass trigger to Japanese focus Triparte Pact if either Germany or Italy is not fascist or Japan is at war with either of them
- Secret CIA reference now actually works (maybe. but thats CLASSIFIED)
- Removed max trait limit from unit leaders
- Fix for awake and angry achievement not working
- fixed a US resource decision pointing to the wrong state
- Adjusted Wilhelm II and von Mackensen minimum/average death dates.
- Fixed the never ending "connecting..." message when you fail to connect to a multiplayer session. The max timeout is 30sec, but now it will finally say "Failed to connect".
- Fixed attaches adding ideas twice on save/load.
- Fixed a double-Stalin-bug. If a player right click on a country with a leader, and then on your own country that is missing a leader portrait, it still shows the previous country portrait.
- Battleplans > Fixed bug in defensive orders being auto merged when painting them.
- Fixed a number of issues with Romania in base game without DLCs enabled.
- Fix for wrong event being fired from SAF decision.
- "Fall of Cairo" event now gives correct Italian leader
- Fixed "replace_path" not working for mods downloaded from the workshop.
- Socialism with Chinese Characteristics no longer creates a faction if player is already in one.
- Fixed missing occupying country name in the tooltip.
- Various generals generated from focus trees (or other effects) now has correctly scripted skill levels.
- Overall garrison order improvements.
- Fixed a bug where strikes from demobilization would be impossible to remove by restarting demobilization mission immediately on timeout.
- German focus to "align Hungary or Romania", now bypass if the country does not exist or is already a subject of another country. Effect from focus to integrate them now only gives factories to the country that becomes a puppet of Germany.
- It is now possible to bookmark with Ctrl+(1-9), not only a divisions, but also a selected province or a strategic region.
- Reverted Nazi Germany getting back their old focus tree if they won the German Civil War (because it broke a lot of things).
- South Africa now has referendum decision available if they went "South Africa First".
- "Test the soviets" decision should no longer require split-second timing for it to work.
- Poland now more inclined to ally Germany, and less inclined to ally UK, after giving up Danzig for guarantees.
- The amounts of air wings being sent as volunteers are now updated properly, and should no longer go negative.
- Fixed typo in the tooltip of command power description.
- Fixed some division names in German historical name list.
- Referendum decisions now have proper triggers, and will correctly display after Political Discourse is Opened, or ideology support is above 60%.
- "Test the Soviets" will now only execute a negative effect for Soviet Union if they actually lose.
- Splitted demobilization missions into two separate decisions, to fix an issue with strikes spirit getting stuck.
- Manchukuo "Five People Armies" - spawned divisions are no longer locked.
- Fixed some XP gain problems for unit leaders. Multiple leaders can gain XP from same combats now and XP gain does not depend on number of units in army (it depends only on number of units in combat) which should increase overall XP gain.
- Fixed command_power_gain modifier (which are currently being used in inflitration) behaving unexpectedly and causing too much effect on daily command power gain.
- "Expand Civil Support" and "Expand Military Support" decisions, are now removed when a civil war starts, even if still active.
- JAP, RAJ, SAF, ITA, and SOV revolters will no longer get their 'old' focus tree back if they miraculously win the civil war, because it broke many things.
- As unaligned, it is now possible to cancel boost party popularity
- Fixed bug where a revolter country not getting any manpower from conscription at the start of civil war.
- Fixed playing unit sounds from foreign countries during border conflicts & consolidate.
- Fixed Manchukuo puppet levels to progress properly in assertiveness branch.
- Prevented SendAttacheAction from being accepted if the originator can no longer afford it.
- Removed equipment penalty for Kaiserreich Germany in the Civil War, too.
- Fixed bug in AI calculating priorities for divisions distribution along the front.
- Fixed bug in calculating division speed bonuses from leaders.
- Fixed bug in assigning names to some divisions from the new division-names-list system, when loading a '39 scenario.
- Fixed small technical issue with assigning countries to factions while loading the save game.
- Added linebreak to swap_ideas effect, so the tooltip doesn't look broken.
- Fixed a number of incorrectly scripted war goals.


##################################
# Stability & Performance
##################################
- fixed an OOS that is caused by triggering same event twice
- added CTD safety checks to deployment destruction to avoid random crashes
- Prevented using the Continue button to load an old save from a previous and incompatible save version.
- Possibly fixed new game launch crash with modded initial state where it tries to instantly peace out countries at war
- Better handling of error messages from the DirectX function calls (so now if something goes wrong with rendering, we see what is it about).
- Fixed CTD when selecting planes on a non-owned carrier after a civil war.
- Fixed CTD related to the new division names system.
- Fixed CTD in our code responsible for parsing (searching) the folders and files.
- Fixed CTD when using event add_ofssite_building when it would put the building level below zero.
- Performance improvement caused by add_relation_modifier (seen especially when played with specific mods that use it a lot).
- Added extra safety checks to prevent potential CTDs when joining to a MP session.
- Filtered out superficial unit and country leader values when calculating checksum, to avoid false positive OOS.
- Fixed possible OOS cause when client and host have different sets of leader portraits or names (DLCs and MODs may cause that each player in the session has different portraits/names).
- Added hotjoin and error code details to telemetry for OOS events, which will help us with tracking OOSes that happens to the players.
- Fixed potential OOS if only some of the players are using mods with unit names (related to the ace generation).
- Fixed CTD on Austro-Hungarian Unification.
- Fixed CTD in unit pathfinding, when player is playing badly created mods, where some provinces may exist without a controller or owner.


################################################################
########            Update 1.5 "Cornflakes"             ########
################################################################

##################################
# Waking The Tiger Expansion
##################################
- New Focus trees for China, PRC and Warlords
- New alt-history branches for Japanese focus tree
- New alt-history branches for German focus tree
- Lots of new gainable and assignable traits and commander overview screen
- 9 new Command Power Abilities let commanders activate bonuses and abilities on their divisions at the cost of a new resource: Command Power
- Added many Decisions to go with the new (free) Decisions mechanic.
- Several new decisions allowing you to form new nations such as the Roman Empire, Gran Colombia and others
- Several new decisions allowing you to do "special projects" that require industry (such as excavating for resources etc)
- Added winter and desert looks to units that they swap to once acclimatized (both for vehicles and infantry)
- Its now possible to capture enemy equipment in battle. Maintenance companies and tech help with this
- Can now send airwings as volunteers
- Its now possible to prioritize what your strategic bombers target (makes those target smore likely to be hit)
- Can now assign transport planes to air supply units
- New diplomatic action: Send Attaché. Places an attaché in receivers nation that gives advantages to both sides
- New Consolidate forces action allows you to merge understrength divisions together and retain experience and equipment
- Can now select custom insignias for your armies (both historical and ahistorical. Some are also nation specific)
- Added a toggleble minimap
- Can now ping in two different ways (defensive and offensive) on the map or minimap to your allies in multiplayer
- Its now possible to destroy stockpiled equipment (has a 3 month timer to avoid exploiting scorched earth)
- New Border Conflict mechanics where you can have battles over states or other advantages through the decision system (available to unlock from the new asian focus trees)
- New 3d models for the different chinese infantry, cavalry, artillery as well as airplane models
- Revamped battle sound system making combat sounds EXTREMELY METAL
- 3 new thematic musical tracks
- Added 18 new achievements

##################################
# Free Features and Important
##################################
- New Stability and War Support mechanics replace National Unity to better model the state of your nation and many decisions and changes to go with these
- New focus tree for Japan
- Overhauled and expanded German focus tree: added new focuses for the Industrial, Air, Naval, and Fascist paths, and improved certain existing ones.
- Added Chain of Command - Can now put Field Marshals in charge of Generals leading armies to get bonuses from both
- Generals now have 4 skill values - Attack, Defense, Planning, Logistics instead of a single skill.
- Traits are no longer lost on promotion of commanders
- Commanders can (and usualy do) start with new personality traits
- Added Decisions - a middle ground between focus trees and events allowing tons of moddability and mechanics
- Added many Decisions to go with the new Decisions mechanic.
- Added Acclimatization core mechanic letting troops get used to harsh climate
- Can now dedicate some Command Power to improve air efficiency in a zone using Extra Ground Crews ability
- Added "kick from faction" diplomatic action (for SPAAAAARTA!!! /Podcat am I 2011 meme:ing again?)
- New historical template namelists. Increased immersion when meeting AI and a lot of power to letting player control how things get named
- New retreat mechanic. We now separate between withdrawing and forced retreat meaning you dont get overruna nd crushed when ordering retreat on units and falling back wil lrequire a lot less microing
- New interface for looking at lost and sunk ships
- Massively improved production interface with more filters, collapsing, drag and drop and allowing more than 15 factories to be assigned to a single line
- New War overview with factions, filters, sorting. It also has a summarized war overview which we recommend. Wars are now much more fluid to be able to handle 3-way wars and avoid lots of issues in the past with war merging etc.
- Several new Refinery techs allow you to control how much rubber and oil is outputted
- Infrastructure now effect how much resources can be extracted. Build up an area to unlock more, bomb it to hurt output
- Special forces are now limited to a % of your army, or a minimum count of battalions
- Several new techs allow you to bonus special forces or control quantity vs quality
- Can now attach air wings to armies and they will follow them and do missions


##################################
# AI
##################################
- Made sure checks for if a country is AI controlled respects human_ai so AI does not alter behavior when observed.
- Fixed issue where AI was unable to assign divisions in different areas with no land connection.
- Fixed number of stats issue for AI that could cause bad behavior.
- Fixed a few issues in AI template evaluation.
- Added focus weight list to AI strategy plan. 0.0 blocks from picking.
- Added scriptable trait priority for AI strategy plans.
- AI strategy plans now include scriptable idea scores.
- Slight AI front rebalance to help out allies more when self is not really threatened.
- AI should now micro attack naval invasion targets if they land next to it.
- Made AI activate invasion plans if they have a front as well (meaning they have landed).
- Made AI more proactive in redrawing their plans as they advance.
- AI now actively stops resending units on naval invasions when they are low on org.
- AI should now take leader stat levels into account when picking them
- Unitcontroller will now use strategic redeployment for all movements while country is not threatened, even for player.
- Added a generic ai template for suppression divisions
- Added strategies for most countries to train some suppression divisions (more for countries that tend to conquer a lot)
- AI will now create an area defence order (for the non-devs: “Garrison order”) specifically for suppression of resistance (the old area defence order is still used for defence of ports and VPs)
- Fixed bug where unitcontroller was failing to distribute divisions correctly in a garrison order
- Improved the AI logic for prioritizing construction/repair of buildings
- AI should now be able to cancel and change execution level based on units having low org or str (was previously considering a unit "strong" if it had high org OR str, now it will be considered "strong" if it has high org AND str)
- Made unitcontroller less likely to send divisions to supply areas that would put them over the supply limit (before they would only not send divisions to supply areas that were ALREADY over supply)
- Added an AI strategy to CHI to not mess with SOV (prevents CHI from asking FIN to join their faction when SOV attacks FIN)
- Major change to how area defence order units are moved around, they should now stay in their positions more and when moving be much better at picking nearby units to move
- fix for ahistorical wars between ENG and YUG: ENG will only declare war in ahistorical mode, YUG will attempt to side with Germany in the coup if at war with ENG to avoid being kicked out of faction
- added an AI strategy plan that make minor European countries less keen to ally with China while at war
- AI PRC will not ally Japan in historical mode, even if at war with Nationalists as well
- fix for wrong focus being checked in an AI modifier in Soviet tree
- added strategy plan for fascist European minors to nudge them away from Japan if fascist Japan forms its own faction (you will join the Axis and you will like it!)
- Massively decreased SOV AI's want to use special AT templates to soft block them from wasting XP. Also improved the SOV AT template if they do end up using them in the future.
- Taught the AI to not fight over units for its garrisons. Now sorts garrison orders correctly to priority
- AI should be way better when it comes to garrison orders and guard the coastline
- Fascist AI will now puppet nation in a peace deal if it controls the surrounding land
- Made AI consider bit more things than only their amount of dockyards for if they wanna focus naval
- Tweaked how willing ai is to help out on allied fronts
- Reworked how unit controller calculates which states get what divisions for a garrison
- Some changes to templates and production strategy for Japan.
- Britain will now avoid piling in on the dutch and belgian borders during the attack on france to avoid stuff bogging down and them losing their troops (“AI smarter than historical”-count: 1)
- Ai Germany will now call in Italy to help against France after low countries capitulate rather than wait until all of france does
- Japan will now stay away from sending volunteers to most European majors until late game
- The Ai now checks single province fronts to see if enemy is encircled when evaluating their strength
- blocked some fascist majors from too much volunteering
- Japan will now focus more on naval production once it has enough civilian industry for 2 lines of construction
- Japan starts out with aiming for a cheaper less punchy template for infantry until 1940, unless vs player china in which case SPARE NO EXPENSE
- Germany now focuses a bit more on making suppression divisions after Poland falls
- Added safety check to avoid Germany starting to justify vs Poland because of timing after getting claims
- Portugal should now avoid restrictive trade laws. let the tungsten flow!
- tweaked china build strategy to make it focus on safer areas
- nationalist china more likely to pick good infantry minister earlier
- Chinese AI will now try to go more short term with techs, focusing on free bonuses, shunning AT and late doctrines, they will also prefer people's army doctrine
- Italy and Germany now more keen to send volunteers to Spain
- Chinese ai now will be more likely to research support weapons
- minor AI is now allowed to support its master in war with expeditionaries even if not neighboring as long as they are linked by another in the faction
- changed expeditionary and volunteer ai code to be more reliable and better at picking best units with least disruption
- made USA lend lease strategies more flexible in case of non fascist germany
- Japan now considers China weak from start of game, but may change its mind if things go badly
- AI now more likely to research radios in war and past mid 1939
- AI is now able to remove support battalions that don't match its wanted template
- Tweaked some garrison templates where ai got stuck and never completed them
- Generic nations are now able to progress to a larger 40-width division template once they have a large stockpile, and it’s past 1938
- AI is now allowed to go more in the red on equipment building for transitional upgrades in the field
- AI no longer keeps ruining its training of divisions by canceling and adding new ones and will only remove divisions in the order of least trained now
- AI now correctly applies strategy limits for equipment, so German strategic bombing program is now properly canceled (“AI smarter than historical”-count: 2)
- Fixed an issue where production shortage was not properly calculated if there was a big stockpile for AI
- AI will now keep track of bottlenecks and manage deployment queue so it fills up faster and also increase its needs in line to not starve itself
- The ai will now be careful with upgrades in the field if it means too long time to fulfill the lack of some equipment(at the moment 50 days)
- Ai will now avoid doing template changes that will hurt its manpower buffer on deployed units
- Germany will no longer wastefully produce light tanks once its decided to start phasing them out and will burn through its buffer instead (for real this time!)
- AI will now be able to justify wargoals on nations while still at war if they have a sufficiently high antagonize score (>2000)
- AI will now care a bit about garrison costs rather than not at all if it had lowest reinforcement prio
- fixed issues where AI refused to update deployment with best templates
- AI is now able to remove battalions it doesnt want in the middle of its templates (rather than on edges only)
- Tweaked ai template matching so its more consistent and wont get stuck on minor differences
- ai should now queue up less units at once
- reduced german armor production focus a bit
- increased german fighter production a bit
- AI Germany should no longer use its wargoals against the low countries until Poland is fully capitulated
- AI will now send expeditionary forces to allies in need if they don’t need those troops (would only do under a particularly lucky star before).
- fixed an issue where Ai would eventually give away all its troops as expeditionaries. it now respects a percentage limit (this fix has absolutely nothing to do with the one above)
- Fixed incorrect AI strategies in german focus tree
- AI now can overfill their carriers if they have the doctrines that reduces penalties
- Added unit pools for AIs, which are used to make AI avoid grabbing units that would cause dangerous naval transfers and also make it less likely to assign units from areas that are not accessible to front
- Added Desperate Mode(tm) for AI where it will try to break out from low supply or to a port rather than slowly perish
- Improvements with AI front assignments & unit controller that should reduce shuffling
- Various AI scoring tweaks for fronts to make AI assign units more logically
- Disabled ai taking pp costing actions when there are high prio decisions/ideas
- Fixed some non-severe potential enemies being evaluated as too dangerous by AI
- Fixed an issue that would cause ai to shuffle units constantly on the way towards the front
- Improved a couple cases AI recreates fronts when it is not really have to
- Added in some crazy experimental code
- Commented out some crazy code
- fixed ai under-manning fronts that it shouldn't
- AI now uses more detailed checks for when to activate plans
- Improvements to ai unit assignments, ai now tries to fill provinces one by one
- Fixed a typo that could make ai prioritize armies incorrectly
- Added a new scoring system for distributing units between different armies of a front
- AI is now a bit more reluctant to change size of war fronts
- Fixed some naval pathing issues for ai (picking correct ports to use)
- AI's front assignment should be more stable on savegame load now
- Fixed some problems with joninig wars, made ai less shy towards enemy of allies in peace time
- made add_ai_strategy effect persistent, fixes cases where ai would forget its strategy on save load
- fixed a case where ENG would kick GER from faction while they are actually cool with each other
- AI will now be a bit more careful about its front setup before joining wars in some cases
- AI considers enemies of faction members as threat, bumps the threat of its fronts in such cases
- AI now prios manpower laws if it is going war but has not enough manpower to support its army
- Fixed FRA attacking through maginot, again (bad France bad!)
- ai handles manpower evaluation a little better now
- non major countries now at least builds half amount of units required to build
- made low prio templates be more ok for garrisons

##################################
# UI
##################################
- Disable Join and Host buttons in the multiplayer window, and other checks to prevent joining or hosting a game if a player name is blank. This blocks abusers who spam a lobby and cannot be kicked.
- Production screen tooltips and some UI items no longer flicker on daily update
- Changed province tooltip to show current weather with gameplay impact as well as temperature.
- Effect for SOV focus NKVD divisions now displays effective change in tooltip instead.
- Added scrollbar to faction window if there are too many factions
- new portraits for ITA and FRA communist leaders as well as MON leader
- added new SHX leader portrait
- Commonwealth countries now use British portraits for generic generals and admirals
- new icons for Polish infantry weapons
- new icons for US infantry weapon
- added a number of new leader portraits for Costa Rica, Guatemala, Honduras, Nepal, Uruguay, Nicaragua)
- Added tooltip and ability to pan to the naval combat by the right click on the mapicon
- Added lobby button shown during the peace conference
- Fixed the bug when air bases was not deselected after opening country view
- Removed ability to reshape orders in air mapmode
- Added popup for puppet nation when the master creates a faction.
- Fixed so garrison settings are available even if you don't have any states selected.
- Added new leader portraits for MAN and MEN. Puyi no longer looks like a potato.
- Added Leader portrait for ICE
- Unit details view now shows stats calculated using current manpower rather than max
- buttons using orientation=center should no longer wander over the interface if updated several times
- focus icons now properly centered no matter their size (new internal bug prio level = ocd)
- Tooltip for deployments blocked from training will now say if too low on equipment rather than say its manpower for both equipment lack and manpower lack
- Map icons for air no longer show wrong tooltip shortcut
- Scenario selector window during startup is now bypassed if there is only a single scenario available (useful for mods that typically only have one)
- Capital map icons (stars) has a cut off so you can the pretty screenshots
- Added linebreak after trade modifiers tooltip.
- Swapped order of selection for navies and armies in naval map mode

##################################
# Modding
##################################
- Added focus weight list to AI strategy plan that has effect. 0.0 blocks from picking.
- Added scriptable trait priority for AI strategy plans.
- AI strategy plans now include scriptable idea scores.
- Decision descriptions can now have tag and ideology specific variants, just like decision names.
- Trade route colors are now configurable in the 00_graphics.lua file.
- Added effect to change focus tree, that also retains already completed shared focuses
- Unsupported (incompatible) mods now are auto disabled during game startup when:
- It's first time a new game version being launched
- The game crashed in the last session.
- Added error log when some div.template in OOB refers to unavailable unit nameslist.
- Fixed "party_popularity@xxx" script support function, to return a value in range 0.0-1.0 instead of 0-100, so we keep consistency in the scripts, and avoid problems.
- Fixed so the decisions now can create corps commanders through the effects.
- Bookmarked countries can now be scripted to be shown based on a trigger.
- Overriding name of an idea now uses the override key for description.
- Added unit_leader_event effect. Displays a portrait of the affected leader in the event window. Selects current units for leader when picture is clicked. Pan too units when clicked again. Selecting leader picture in event opens details if leader has no units.
- Fixed extra spaces and comma in tooltip for equipment bonuses when using show_ideas_tooltip.
- Added any and all trigger for for unit leaders. all_unit_leader any_unit_leader all_army_leader any_army_leader all_navy_leader any_navy_leader
- Added basic effect for scoping to unit leader. random_unit_leader every_unit_leader random_army_leader every_army_leader random_navy_leader every_navy_leader
- Added localisation support for unit leaders. GetName (returns full name), GetLastName (returns last name), GetNationality (returns TAG.GetAdjective of nationality), GetRank (returns General or Field Marshal), GetHerHim (returns her or him, depending on gender), GetHerselfHimself (returns herself or himself, depending on gender), GetHerHis (returns her or his, depending on gender), GetHerHisCap (returns Her or His, depending on gender), GetHersHis (returns hers or his, depending on gender), GetHersHisCap (returns Hers or His, depending on gender), GetSheHe (returns she or he, depending on gender), GetSheHeCap (returns She or He, depending on gender), GetWomanMan (returns woman or man, depending on gender).
- Added female = yes to create unit leader effects.
- Added triggers to unit leader scope: has_id, is_assigned, num_units, is_field_marshal, has_trait, tag, skill
- Added transfer_navy effect. Transfers the entire navy of scope country to target country.
- Fixed modify_state_flag, which was looking for the wrong scope
- Added flag triggers and effects to unit leader scope. set_unit_leader_flag, modify_unit_leader_flag, clr_unit_leader_flag, has_unit_leader_flag
- Added unit leader effects. promote_leader, Promotes scope general to field marshal. set_nationality, Sets nationality of scope unit leader.
- Added scoping to the country from a unit leader using OWNER.
- Added add_command_power effect.
- Added trigger has_decision. Looks for a selected decision that is active in the interface.
- Added compare triggers command_power command_power_daily
- Decision naming scheme is consistent with cosmetic tag naming. TAG_id_ideology, TAG_id, id_ideology
- Added effect modify_building_resources. Modifies how many resources a building outputs for scope country only.
- Added support for equality when checking a country flag value.
- Added trigger is_fully_controlled_by. Use in a state scope to see if target country fully controls the state.
- Added trigger political_power_daily.
- Fixed "is_coastal = no" being a stupid liar! (returning true for coastal states).
- Added variables to get level of AF, IC and infra from scope state. arms_factory_level industrial_complex_level infrastructure_level.
- Change add_building_construction to round variables instead of floor.
- Added support for variables to remove_building
- Target for diplomatic_relation can now take a scope and event targets.
- Added global_every_army_leader effect. Runs effect on every army leader in the world.
- Added keep_unit_leaders_trigger to civilwar effect. Unit leaders that match the trigger will not be randomly distributed.
- Added has_active_mission trigger. Checks if specified mission is currently active.
- Added remove_mission effect. Removes specified mission. Refreshes decisions interface.
- Added has_attache_from and has_attache triggers.
- Added recall_attache effect.
- Added set_truce effect
- Added effect tooltip to technology tooltip.
- Added is_capital trigger.
- Added Effect activate_targeted_decision: Adds targeted decision against specified target tag. Reactivates fire_only_once decisions.
- Fixed a crash in region trigger
- Added cheat to ignore focus prerequisites: Focus.IgnorePrerequisites. Lets you complete a focus in the middle of a tree. Will NOT make you complete the focus instantly (use fa for that)
- Added trigger amount_manpower_in_deployment_queue.
- Added variable support to AI base chance for events
- Added ruling_party as argument for party_popularity variable.
- Added script variables num_controlled_states num_owned_states num_core_states num_owned_controlled_states.
- Added effect activate_decision. Does the same as if the decision was select from the UI.
- Added static game variable days_mission_timeout@mission_id to find how many days are left on a specific mission.
- Added GetOldName GetOldNameDef GetOldNameDefCap GetOldAdjective GetOldAdjectiveCap to get a country's name prior to last name change.
- Added GetNameDefCap.
- Added generate_wargoal_tension_against targeted modifier.
- Added variable support for effects: send_equipment add_manpower.
- Added variable support for triggers: has_equipment has_manpower has_army_experience has_air_experience has_navy_experience.
- Fixed ic_ratio reversed tooltip and not supporting scopes and event targets in tooltip.
- Added on action for on_peaceconference_ended.
- Added effect to round a variable.
- National focus can now handle multiple position offsets.
- Added leave_faction effect. Works similarly to remove_from_faction, except YOU dump THEM before THEY can break up with YOU!
- Added support to reverse the direction of ai_strategies
- white_peace effect now only peaces out targeted nations, their factions and subjects
- the send_volunteer_factor modifier now is only affecting the calculation looking at your own nation, not the size of the receiver (meaning it acts like you have a bigger army)
- added a new enabled trigger on templates to better control when Ai should consider them good enough to use
- AI Template picking now also includes templates score in matches when going for best template so its possible to have 2 separate infantry templates and AI will pick the best. This can also be seen in the aiview tooltip on division designer screen.
- error handling of incorrect checked focuses in triggers now available if you use -debug start flag
- Added ai strategy for being more generous with spare units
- Added stockpile_ratio trigger allowing you to check the status of stockpiling for certain equipment versus how much is fielded
- add_ai_strategy effect can now handle event targets and scope targets for its id parameter
- added new ai strategy equipment_variant_production_factor that lets you set a production factor on specific equipment archetypes. so -100 means 0% of total logistics need for something to be produced
- added new equipment_production_min_factories strategy that lets you set minimum targets for factory assignment by archetype
- its now possible to see debugging scoring for ai templates and roles when tooltipping them in the template list in deployment with aiview
- added ai strategy (war_declare) for making a nation hold off on war declares even if everything else is fine
- focus.autocomplete now speed up player active focus if one is picked already
- weather modifers can now affect supply consumption
- added -quickstart experimental option that loads game at half the time by skipping stuff like map borders etc you wont need when iterating over UI/decisions etc. Don't play with it.
- Use cheatcode Decision.NoChecks to bypass decision checks. note that this also turns off costs on decisions.
- scriptable localization now has correct reload functionality
- added new ai strategy consider_weak which will make AI consider a target nation as weaker in certain evaluations (currently wargoal justifications)
- added better error handling to has_equipment trigger.
- can now have a description as part of instant tooltip on ideas. use <key>_instant_desc in localization files
- create_unit effect now handles owner = ROOT and other standard targets
- Added dont_defend_ally_borders, force_defend_ally_borders, ignore_claim strategies
- Added variables
- Added attack modifier vs specific countries
- Added on action for creating unit leaders
- New Modifiers cic_to_target_factor, mic_to_target_factor, extra_trade_to_target_factor, trade_cost_for_target_factor
- Added a warning for flag textures with wrong size
- Added "allowideas" command to let you pick ideas always
- added war_preparation strategy for AI letting it prepare against certain nations
- Added support for having national focuses that are shared between national focus trees

##################################
# Database
##################################
- Renamed Fascist Turkey from "Neo-Ottoman Empire" to "Turkish Empire", to not overlap with the name of a new formable nation.
- Added new loading screen quotes.
- Added Qingdao state.
- Unaligned and Democratic Germanies now also have a chance of integrating Austria, under certain conditions.
- Switching ideology is now handled through decisions rather than through MTTH events.
- Most old Ideology switching MTTH events have been disabled.
- Divisions spawned in Spanish Civil War are now 'locked' and impossible to edit or delete.
- Switched around aluminum values for French Guiana and Suriname to properly respect the historical levels in aluminum production of these regions. (This fix paid for by the “Justice for Suriname Association”. Chairman and sole member: @Bratyn)
- Generals may now become sick or wounded, suffering penalties to their stats for the duration.
- Edits to Lodz, Poznan, and Danzig states to make historical WW1 German borders possible.
- Took into account recently-revealed CIA data regarding certain high-profile country leaders featured in the game.
- Added a way to celebrate International Women's Day in the game.
- A French-Italian alliance is now possible and stable.
- Fascist France received a new focus to go to war with Germany if the latter is democratic.
- Added AI strategy plans to France and Italy.
- Removed script using national unity
- Changed default event timeout from 30 to 13 days
- Changed Soviet focus that instantly moves industry to use decisions instead.
- New infantry type, bicycle.
- Added generic propaganda decisions to build war support.
- Added missions for Soviet to hold Leningrad, Stalingrad and Moscow
- Added decisions where the player can increase stability in exchange for something else.
- Added decision for United Kingdom to call Portugal to faction.
- Added decision for United Kingdom to lease Azores from POR. Added events for accept/deny and event to transfer control back after the war.
- Added unit leader trait "Hidden Sympathies". Trait use in political decisions before igniting civil war.
- Added decisions for warlord to start borderwars against neighboring Chinese countries after selecting Border Clashes focus.
- Rearranged the Japanese Air Research tree for improved historical accuracy
- party names for Chinese parties
- changed PRC name and flag at game start to better represent history
- some small changes to Latvia based on user research
- added a number of important loading tips
- moved Anti-Colonialist Crusade events to decisions
- Medium tank designer trait now has "medium" at the front (to differentiate it from the generic tank designer with poorer stats)
- Cavalry advisor now boosts cavalry, motorised and mechanised (previously didn't boost mechanised, so upgrading from motorised to mechanised wasn't as good)
- Stravropol now called Stavropol
- USA focus tree now also uses relative positioning. This should now be working for all focus forests.
- Fixed incorrect path to portraits for communist Syrian leader
- Several chinese divisions now start at better equipment levels in '36
- Moved some factories in china towards inland so they are not lost as fast
- Mao is now younger and sexier
- repositioned naval bases in florida to avoid inland ships


##################################
# Audio
##################################
- Ambient battle sounds, are now better at freeing the played effects. (not leaving the memory leaks)
- Added more flavor to Combat Ambient with VO (graciously provided by the HoI dev team)
- Created and implemented new sound effects for moving aircrafts between stations and ordering to regions.
- Fixed invalid destroyer ship sound effects

##################################
# Balance
##################################
- Changed computations for convoy efficiency to be per region instead of per delivery route. Convoys now compute their efficiency by subtracting the efficiency losses all along their delivery route.
- Yugoslavia "Orthodox Church Support" now gives +25% PP instead of only +0.25.
- Germany now correctly already possesses the technology to build the "Admiral Hipper" cruiser class in 1936.
- Certain German advisers and military leaders now require a fascist government.
- Poland, Romania, and the Baltics now take guarantees and alliances into consideration when on the receiving end of Soviet pressure.
- Germany now starts with, and can extend, MEFO bills for rapid military build-up.
- "Anschluss", "Fate of Czechoslovakia", and "Fate of Yugoslavia" focuses now simulate capture of gold reserves by reducing MEFO bills cost.
- Adjusted 1939 start date to take into account MEFO bills and the new German focus tree.
- Adjusted old trees to take into account the possibility of Germany going anything other than Fascist.
- Non-aligned Vichy France is now possible.
- Adjusted the areas and forces Vichy France starts with to be more historically accurate.
- Refusing Japanese demands as China, in the Marco Polo Bridge Incident event, now gives a wargoal to Japan.
- Accepting Japanese demands as China, in the Marco Polo Bridge Incident event, now gives Japan a claim on Shanghai and a brief truce.
- Spanish Civil War ending events now remove the 'locked' divisions that were spawned at its start.
- Civil Wars now give some positive effects upon their conclusion that makes them overall less detrimental to a nation.
- French Spanish Civil War intervention focuses are now only 35 days long.
- Leftist France is now more likely to take the Spanish Civil War intervention focuses.
- Austria is now slightly less likely to go fascist.
- Added a minimum number of days of a war before anyone can surrender ( they can still capitulate whenever unless they would happen at the same time )
- Removed block preventing declarations of war that would lead to 3-way wars (...and let slip the dogs of waaaar!)
- Reduced air wing deployment time from 5 days to 2 days.
- Also reduced the acclimatization gain speed by about 8x, because after recent changes it was ultra fast.
- Locked Maori volunteers division template.
- Reichskommissariats and Reichsprotektorats now have a -50%/-25% penalty to recruitable population
- Hongkong is now a core of PRC
- added a starting general for each of the Chinese warlords
- added a generic special forces bonus to the special forces focus in the generic tree
- changed British rearmament focuses to no longer give factories in the most god-forsaken corners of the world
- Reworked a number of states in China, splitting up larger states into smaller ones. Overall number of population and number of factory slots has been adjusted accordingly
- Added German general Felix Steiner. Mit dem Angriff Steiners wird das alles in Ordnung kommen!
- removed a number of duplicate Manchurian Divisions from the Japanese OOB
- added a trait to Chiang Kai-Shek to give him +40% stability if in a defensive war (adds up to +10% stability after base stability hit)
- added decisions for Japan to surrender after losing the Asian mainland or getting nuked twice
- made a number of Japanese states non-core to avoid them being selected for factory placement in focuses
- Franco-British Union now gives Britain all French generals
- reduced war support for minor nations to prevent them from building giant armies
- Anschluss and Restoring AH peacefully now transfers all generals of those countries to the respective new owner
- Swapped France's historical order of FRA_alpine_forts and FRA_naval_doctrine focuses to give France a slightly better chance against Italy.
- Backhand Blow tactic is now locked (unlocked by Deep Battle and Modern Blitzkrieg doctrine trees).
- Tactical Withdrawal tactic is now locked (unlocked by the Superior Firepower trees).
- Chinese divisions which started at untrained now start at trained so players aren't inclined to disband them and train them from scratch (losing their unique names and wasting everyone's time)
- Hungary's DOD focus tree is now more responsive to countries being at war - diplomatic demands for territory will be bypassed if they are at war.
- USA will now support nations fighting against extremism
- Rebalanced starting military factories for Japan
- World tension generated from sending land volunteers reduced (Air volunteers do not affect WT).
- Base max planning reduced to 30%
- Grand Battle Plan doctrine tree planning bonuses reduced
- Urban Assault Specialist now costs 500 xp (was 700).
- Commando now also gains XP when fighting in hot climates.
- Leaders that had the Panzer Leader trait now have the Armor Officer trait
- German starting industry has been reduced to account for the MEFO bills that will pay for German industry buildup. It all makes sense in the end.
- Soviet Purged Officers idea now has impact on training and factories as well to slow down Soviet somewhat. their effect on volunteers is also a bit more flat
- Officers Purged spirit in soviet union now impacts how many volunteers can be sent abroad based on army size (decaying in effect by level)
- Continuous air production focus now gives 10% bonus rather than 20%
- Superior firepowers techs under Shock & Awe now only apply to infantry and artillery and with reduced bonuses
- Upgraded soviet NKVD spirit now gives 5% reinforcement rate bonus rather than 30%
- The Deep battle branch in Mass assault now give a total of +10% reinforcement rate
- The Mass Mobilization branch in Mass assault now give a total of +20% reinforcement rate with most of it coming from Human Wave Offensive
increased air attack for towed '36 anti-air from 17 to 19
- Made extreme weather modifiers stronger (except attrition) including increased supply usage from extreme heat
- Made Walter Model more defensive
- Lowered cost of mechanized to 8/10/12 from 12/13/14 to make them more attractive
- Added timed en-route penalty while switching generals
- Rebalanced Soft Attack:
- removed hidden bonuses to line artillery and tanks
- reduced number of guns in support artillery to 12
- support arty now 10% less penalty compared to regular
- artillery soft attack reduced between 15-30% depending on level (from 1.4 base)
- Self propelled arty soft attack reduced 20-30% depending on level (from 1.4 base)
- tank soft attack reduced 13-20% depending on model (from 1.4 base)

##################################
# Bugfix
##################################
- Combat leader portraits are now always properly updated.
- Fixed highlighting of taken army leaders in leader selection window.
- Fixed disappearing attack orders when editing.
- Fixed some modifier localizations.
- Fixed booboo that made units, in certain situations, withdraw from combats they should remain in.
- Portraits for leaders at the bottom now reload correctly.
- Removed the extra bit on top of the leader portraits in the bottom view for the create buttons.
- Fixed problem where it was not possible to create a new army from a selection of divisions already in an army.
- Fixed an issue with disappearing fronts and orders.
- Decreased max width of national focus detail view's prerequisite panel to having the same padding on the right as on the left, preventing text from occasionally overlapping the visual frame a little bit.
- Fixed the tooltip estimation of a naval transfer's chance of getting intercepted along the way. Used probabilistic math to determine overall chance that none of the random checks for interception will pass over the whole path, affected by movement speed since the checks occur hourly, and subtract that from 100% to get chance of interception.
- Fixed naval supply paths to correctly take into account actual versus needed convoy counts when determining convoy efficiency.
- A navy told to retreat to a distant province will no longer have its path truncated to just one province, and if it successfully retreats, it will clear its retreat flag and switch to normal movement as soon as it moves out of the original province where combat was taking place.
- Prevented divisions being transported over water from being given a new destination while their transport ships are in combat; this prevents the exploit of letting them magically escape from combat.
- Fixed alignment of a couple of tutorial glow rectangles.
- Fixed main menu background so that it preserves its aspect ratio even when enlarged to fill a 4K monitor.
- Removed potential for mismatch of casualty count display in war dialog and tooltips.
- Fake News will now no longer report Bulgaria "Accepted Romanian Demands", when Bulgaria in fact rejected them.
- "Pressure Yugoslavia" events will now check whether Yugoslavia is at war.
- Romanian Communist Revolutionary minister is now locked behind the 'Appoint Soviet Friendly Government' focus.
- Czechoslovak focus "Knowledge Sharing Teams" now correctly gives the 5th research slot if you have 4 research slots already.
- Fixed typos and other text errors.
- Fixed even more typos and text errors.
- Fixed more typos than we are willing to admit. (wait you just did! /Podcat)
- Fake News now no longer reports on "Germany being under attack", if Germany is only in a civil war.
- Clarified the tooltips for German naval focuses.
- Nations will no longer be pulled out of a faction when invited to another through a focus.
- The 1936 Olympics will no longer occur during a German civil war.
- Hindenburg no longer travels to the USA if Germany is in a civil war.
- Fixed issue where you could not occupy territory from countries after they had a civil war
- Fixed a bunch of issues with colonial flags in division deployment
- Fixed a case where volunteers would sometimes count twice in calculations
- Fixed bug where supply areas did not take edge control into account when building the path to the capital
- Fixed an issue where event flags would not be properly read in binary saves
- Hid a bug that caused rebasing airplane icons in east asia to appear far below the ground ( note, this only hides the bug by clamping the icon height to the water level, it does not fix the actual problem )
- Only majors in your faction that are at war with the country you are about to surrender to counts towards preventing minors from surrendering when they have major faction members who are still fighting ( previously faction members who were NOT in the war would also count )
- Might possibly have fixed an issue where the capitulation flag in the war overview screen was not shown/hidden correctly
- Ships in navies set to never auto-repair no longer flee if their strength drops below 99%. They now flee at 10% like if auto-repair is set to low
- Fixed issue where casualties would not go the correct country when killing volunteers
- Fixed an issue where war merged and warscore was lost for one side
- Combat tactics that are setup to end a combat phase will now correctly end the phase
- Several bug fixes in battleplans about: shrinking defensive lines, over-expanding defensive lines, and other overall messups.
- Fixed issues with defensive lines leaving gaps, and misbehaving when mixed army and army group's def.lines along the same front.
- 3d fleets should be now better at avoiding swimming through the ground.
- 3d fleets are now no longer so oversized.
- Made the radar circle effect prettier (more precise), and less annoying when there is lots of them overlapping each other.
- Crazy amount of fixes has been done to the new custom division names system.
- The movement arrow has now different color, when withdrawing.
- Movement arrows are now using normal maps (against static lighting for simplicity).
- Fixed combat withdrawing speed (no longer ultra slow, nearly stand still).
- Fixed naval combat retreating, so it finally works correctly (using the in-combat retreating mechanics, before actually moving the fleet away).
- Fixed drawing movement arrows in OpenGL.
- Fixed the custom texture override functionality so now it properly supports swapping textures for complex assets (that has more than 1 mesh). Feature used by the new feature of soldiers changing their camo.
- Fixed bug in strategic air superiority map colors, and land combats having air superiority penalty on both sides.
- Fixed bug in which the bonuses from tech to the acclimatization didn't worked.
- Fixed eternal problem of units being stuck in the naval transportation. Solves also the problem of units standing forever idle in the source ports.
- Fixed the behaviour of the units being navaly transported that can't reach their destination (bcoz for example impassable areas), will try to return home, before giving up and staying idle on the sea.
- Fixed issue with the theater data not being cleared after sending back the volunteers home.
- Fixed issues with battleplan freakouts for volunteers.
- When game was launched with "hoi4.exe -start_tag=ABC" it's now possible to go back to main menu without being pushed back to the game.
- Fixed badly offset rivers map.
- Fixed acclimatization console message from command "acc", so the confirmation values are between 0-100%.
- Historical division names > Interface bug > In division template editor, tooltiping names no longer gives tooltip from elements underneath.
- Historical division names > Fixed bug with missing names in the depl.lines after loading the save.
- Fixed very old issue with defensive lines being drawn with incorrect thickness offset.
- Several fixes to the battleplan system related to the new level of the orders from the Army Groups.
- Defensive lines no longer changes color to "beige" when holding ALT.
- No longer drawing frontlines when editing def.lines by holding ALT. Looks much cleaner.
- Production lines > Fixed bug that Click on Add new ship construction, added it always at the top instead of the bottom. Also made the scrollbar arrows up/down more responsive.
- Production lines > Fixed bug in lines being stuck (drag'n drop stopped working + many dangerous malfunctions happened) after adding new line at the top by holding SHIFT.
- Production lines > Fixed bug in not being able to assign any naval factories, caused by adding drag'n drop feature.
- Plenty of general fixes in drag'n drop of elements in production view.
- Fixed bug with disappearing Army group's battleplans.
- The game checksum now should be ALWAYS the same in the launcher as in the game. The cheating prohibition is no longer done by breaking the checksum version, but via the interface instead - the multiplayer button is locked, and the tooltip explains why.
- Setting the 1st option from the screen refresh rates list, actually does set that refresh rate.
- Right click with Alt+Ctrl and click to "Open" to open a interface element in the external editor, didn't worked on OSX until now.
- Fixed an issue where some diplomatic actions that does not require a response would have REPLYTEXT as localisation or an empty background.
- Fixed a crash when using set_autonomy_state on a country and its overlord in the same effect.
- Australian NF 'Support the Centre Party' and 'Empower the Workers' now requires colony/protectorate or higher instead of exact level.
- Carriers now recalculate their airbase capacity when changing owner.
- Fixed tooltip for supply consumption modifier showing as bad when negative.
- Fixed "Wrong root scope in has_government trigger." going in the error log when a country had a civil war.
- Fixed name for tech bonus from CHI_elite_mountaineers, CZE_inf_and_artillery_advancement, HUN_danuvia_submachine_guns, HUN_destroyers, HUN_carriers, ITA_armored_effort, ITA_naval_air_effort, NZL_form_the_rnzaf, ROM_air_defense, ROM_modern_destroyers, SAF_invite_soviet_advisers, USA_CAS, YUG_the_ik_3, YUG_heavy_fighter_proje, YUG_bomber_project, YUG_motorize_the_cavalr, YUG_motorized_logistics, YUG_armored_cavalry
- Changed name for tech bonus from equipment_effort, HUN_motorized_logistics, GER_coal_liquidization, RAJ_battaglione_azad_hindoustan
- Added name for tech bonus from USA_air_war_plans_division, USA naval focuses
- Fixed a bunch of double options appearing for news events in specific cases.
- Fixed some missing or wrong loc for event options.
- Enabled an event where italy can help yugoslavia during the London conference
- Added comma separation of focus names to focus with more than one mutual exclusive.
- Setting a country's autonomy to free no longer tooltips as the overlord going free.
- Using transfer_state effect against a country on its final state is now considered the same as annexing them.
- Vichy/Franco British Union no longer happens if France has pushed a fair bit into Germany or Italy.
- Fixed a bug in original_tag trigger, causing Spain to not gain recovering from civil war spirit.
- Fixed Soviet soldier using wrong rifle animation.
- Fixed an issue where civil wars would grab all controlled states instead of home area. Added cores state distribution for leftover states not connected to capital. Changed calculation for best capital to put lower priority on capital neighboring old one.
- fix for Vichy event not firing if Italy isn't in the war with France
- fix for incorrect Ranger trait description
- rephrased tooltip LOW_MANPOWER_STAT_EFFECT
- fixed an issue where Nationalist Spain did not have portraits for some military advisors
- locked Tizard mission if Britain is at war with US
- fixed an unattainable focus in RAJ focus tree
- fix for non-Mao leader losing Mao's trait
- fixed a Programmer english tooltip for coups
- fixed an issue with a non-western Character in Japanese Division names
- fix for Manchukuo not being called that in diplomatic options
- fixed an inaccurate description in Division Designer tooltip.
- fix for duplicate event option in Canadian event
- fix for missing uppercase in CZE/POL air wing names. Game once again playable
- fix for missing flag in MAN save games
- fix for stupid (may be temporary)
- fix for nuke events sometime not firing correctly
- fixed an issue where Germany could exert pressure on Yugoslavia even after Yugoslavia ceased to exist
- fix for strategic bomber air wings not getting flavor names
- fixed Yugoslavian independence war event to prevent it from firing if it would have no effect
- Fixed wing redeployment and air mission arrows wrapping around the globe.
- Fix for units manpower incorrectly affecting unit stats
- Now convoys transporting units
- Now country skips the turn in peace conference, if there are none humans controlling it
- Added caps for the equipment counts to avoid overflows
- Fixed the bug when save games were growing hugely due to combat logs not being properly cleared
- Now timed ideas continue being timed ideas even after civil war split
- Fixed the bug when it was possible to research 2 same techonologies at the same time
- Fix for occupation rules and master being always prioritized over puppet except owned province case
- Now only equipment produced in your own country will bring you autonomy points
- Improved randomization of the mission targets
- Fixing the bug when you could assign divisions for naval invasion above the limit
- Multiple nations air combats now are equivalent as they were usual 1 vs 1 combats
- Fixed a bug where saving and loading a game would cause event timeout to be reset
- Fixing an issue when unit stats were not properly updated after switching doctrine technology
- Puppet and leader can exchange territories no matter if they are in the same faction or not
- Fix convoy sometime being added twice to naval combats.
- For the umteenth time. Fixed formatting errors in the credits.
- Fixed small fleet intercepting too many convoys
- Fixed combat logs not showing caused equipment loss when it was lost to an encirclement
- Fixed some flags with incorrect size.
- Expeditionary forces in an army no longer block selected divisions from changing templates
- Partition of Poland event now requires that Germany not be a subject for USSR to hand over any territory
- EFFECT_ADD_CORE_OF now localised as "core of" instead of "core by"
- Refining concern is now upper case (it was Friday afternoon okay)
- Fix for mis-reporting of the number of available factory to build in the production view.
- Fixed multiplayer lobby filter by version (praise Xenu!)
- Fixed damaged shipyard always repairing ships at maximum speed
- Fixed localization issue in the diplomatic action panel.
- Fixed a localization error in New Zealand focuses.
- puppets can no longer grab back expeditionaries from their master
- You can no longer get benefit from having more equipment than manpower % for unit stat calculations
- If a player is kicked or disconnected in a peace conference their slot is now bypassed and the conference doesnt stall forever
- air xp gain from LL now also require an active LL relation, just like for land equipment
- Fixed terrain adjuster bonuses not working correctly
- Fixed faction map not being updated after diplomatic actions
- Fixed faction colors not being updated when a faction changes by an event
- Releasing states to a country/liberating a country is no longer possible if you are in control of all states you want to release.


##################################
# Stability & Performance
##################################
- Fixed CTD where unit can look like it is moving without having a path (yes, this was a strange one)
- Med various code safer to avoid theoretically possible but improbable crashes.
- Fixed a resource leak of the ambient battle sound which also led to heavy audio falloff computations after a long time of watching battles closely. Sound effect instances were being stopped but never destroyed.
- Added an error and prevented a crash if a supply area is missing
- Fixed crash when loading a savegame while in a peace conference
- Fixed crash when adding manpower to casualties when the killer was not at war with the owner of the manpower ( for instance volunteers ), casualties will now be added to the logicalcountry of the army in such situations
- Fixed memory leak due to old messages piling up over time that were never used
- Optimized the amount of calculations related to front systems (base mechanics required by the battleplans) used by the volunteers battleplans.
- Optimized a function that was doing a "country tag lookup" (an internal thing) which was a bottleneck at some moments of gameplay.
- Fixed CTD and by the way the inconsistency between the ordinary AI, and the volunteers AI.
- Lots of memory leaks fixes in general (Leaked memory means that the game consumes more and more RAM over the time).
- Fixed several CTDs in a new division names system.
- Fixed CTDs that occured after loading the older save games.
- Fixed CTD that sometimes happened when going back to main menu.
- Lots of memory fragmentation preventions and fixes. (A memory fragmentations may cause the game to crash after a very long sessions).
- A game consumes a little bit less of RAM now.
- Fixed CTDs related to the naval transportation code base.
- Fixed corrupted memory allocation attempt caused by the AI code.
- Fixed CTD in border combat code referring to a deleted unit.
- Fixed CTD when trying to naval transport a divisions but there is no naval route (regions being blocked).
- Fixed CTD in AI strategy referring to the leaders being deleted by spawning a civil war.
- Fixed invalid access to a deleted memory in the decision status (making very low probability for a CTD).
- Fixed CTD in going back to main menu. Airbase access code was referring to the carriers after deleting them.
- Huge optimizations in how we calculate the relative air superiority. This unlocks plenty of bottlenecks in: units, navies, air calculations (and much more)...
- Another large performance optimization in the naval unit transportation system.
- Optimized the amount of the network commands spammed by the AI.
- Small optimization in pathfinding for the naval transportation. Units ready to set off from the same location will get only 1 naval pathfind done and share the data.
- Optimized performance by about 20% in places by reworking the careless usage of "can battleplans be executed" function.
- Got rid of the several seconds stall on daily updates. Related to the sending/receiving volunteer forces.
- Fixed plenty of very long game freezes.
- Fixed CTD caused by switching the focus trees.
- Fixed CTD caused by incorrect re-assignment of the armies between the theatres.
- Fixed CTD if you launch the game "hoi4.exe -start_tag=ABC" where ABC is an invalid country tag.
- Fixed CTD due to lack of clearing border conflicts in states. Happened when return to main menu, and try starting new game.
- Fixed CTD in loading save games > Related to active leader abilities.
- Fixed crash that happens after loading older saves, or by removing some insignias in patches/mods.
- Fixed rare CTD after deleting defensive line.
- Fixed several Out of Sync bugs in MP.
- Fixed OOS from pinned strat.regions mismatch after hotjoin.
- Fixed invalid memory access, after returning to main menu. The nature of the problem didn't cause a CTD, but it was a very bad thing to have in code.
- More CTD protections when drawing battleplans.
- Fix for the OOS happening after certain joins
- Fixing CTD in subject relation view
- Fix for probable rehost CTD
- Fixed the major cause for the CTDs in the peace conference window
- Fixing CTD in balancing of military deployments during civil war spawning
- Fix crash upon clicking the load button with no savegame selected.
- Optimized AI update by sorting by time taken to update it last tick. Guarantees the biggest nations (SOV & GER) to be on separate threads
- Fixed a division by zero crash
- Fixed crash that happens on rare occasions when sending telemetry data
- added crash safety checks for invalid data on writing sunk ships to savegame
- Fixed CTD when naval transfering units during a peace conference annexing you (and killing said units at the same time as orders were given, as a side note also invented a time machine and solved world hunger.)
- Fixed memory overrun issue in ai front handling
- Portraits and other sprite updates are now cached to reduce ui strain
- Fixed an issue where deleted units could be put back into combats.
- fixed an issue where licensing information was not read in an MP safe format and could cause OOS
- Fixed a potential OOS when reading saved event scopes
- fixed CTD when tooltipping to cancel war justification right when it hits 100%
- added various savegame ctd safeties
- Various small ai performance improvements
- Fixed a history related OOS
- Fixed a CTD when selecting airplanes while getting annexed (but I promise it still respected your your fighting spirit)
- Improved reliability of hotjoin save transfer, in situations where the client is slow.
- Fixed hotjoin related OOS with resources and relations
- Fix for a freeze when you ended up in a civil war at war with your own puppets (o_O). Fix stops all inter-faction wars so modders need to be careful to kick ppl before war etc.


################################################################
###########            Hotfix 1.4.2 "Oak"            ###########
################################################################

##################################
# AI
##################################
- Added AI strategy to avoid some naval strategic regions
- AI now realises that puppets will also join the war when their overlord does ( fixes situation where China does not put any troops on their border with Japan's puppets )
- AI should now prefer even shorter naval routes when picking what ports to navally transfer between
- Nations with low manpower are now less likely to burn pp on relation boosting as they need it for laws
- AI should be less likely to waste PP on guarantees when low on manpower and at war
- Removed AI weight modifier is_in_faction from JAP axis leaning focus
- Tweaked ai weights for carrier plane research. AI will now always research the most modern carrier version available and not research any carrier planes if they don't have carriers, the US and Japan will also be more eager to research carrier planes and particularly so when at war with each other
- Tweaked AT gun research to take enemy armor values into account (AI will be more willing to research AT upgrades if facing an enemy with high armor divisions)
- AI will no longer research basic heavy tanks if it can already research improved heavy tanks
- AI now clears the trades that are not being fulfilled due to having no access to trade country
- Italy should now be more careful about transports across the Med
- Enemies of UK will now be wary of transporting through the english channel

##################################
# Modding
##################################
- Can now use "relation" as target for pp_spend_priority ai strategy
- Can now use "guarantee" as target for pp_spend_priority ai strategy

##################################
# Database
##################################
- Added flavor names for German named fighter squadrons
- Added namelist for FAA squadrons in the 800-list
- Added a number of shipnames to the German roster (thanks davewolf!)
- Added Night Witches to the Soviet “Women in Aviation” focus
- Added German historic airwing names after player feedback
- New icons for Italian small arms and truck
- New icons for French infantry weapons (prime condition, only dropped once)
- Added a flavor name for a Yugoslavian light cruiser class
- New leader portraits for Yemen, Haiti, Malaysia, Luxembourg, Indonesia/Dutch East Indies, El Salvador, Buthan, Cuba, Panama, Dominican Republic, Netherlands (alternative)
- Commonwealth leaders now fallback on British portraits if TfV is not activated

##################################
# Audio
##################################
- Adjusted volume on some of the airplane sound effects

##################################
# Balance
##################################
- First level Radar now have a much longer range to make initial investment more attractive
- Expanded bypass criteria for puppet Bulgaria focus to allow focus to bypass if Romania holds all of Bulgaria in a war
- Albania should now not fold to Italian pressure if in a faction with Yugoslavia
- Added bypass to anschluss if AUS is a puppet
- Turkey will now only join the Axis through the German focus if they are fascist.
- Anschluss event now takes guarantees into account
- Lowered upgrade bonus to self propelled AA variants air attack from 30% per level to 15% 
- Changed Demand Sudetenland focus to fire fallback event if England is a subject
- Changed South Tyrol to be a core of Austria 
- Nerfed CZE fascism gain through focus by 50%
- Reduced starting fascism in CZE to 5% (down from 25%)
- Fixed wrong tech bonus in a Romanian focus
- A country that initiates coup on an another country gets a bonus while inviting revolting country to its faction

##################################
# Bugfix
##################################
- Fixed an issue where frontlines could sometimes dissapear
- It is now ok to transfer resources from your territories through subjects at war time
- Fixed issue where declaring war on a puppet could pull the puppet into an existing war on the wrong side of the war
- Subjects are now added to a faction if their master is
- Convoys used for naval transfers are no longer locked in a state of being permanently "in use" when saving/loading while navally transferring
- Fixed issue where merged wars made it impossible to surrender because you were not marked as war leader
- License production description now updates properly
- Fixed bug where division size affected how much attrition they took and how their supply status was affected by being out of supply
- Fixed a bug where volunteers could appear in an impassible area
- Fix for incorrect use of has_government = fascist/communist instead of fascism/communism
- Fixed a horrific bordergore issue in Romanian "Split CZE" focus 
- Ensured that split CZE event chain did not result in CZE units sitting around after their country got annexed
- Doing the Indian focus "Battaglione Azad Hindoustan" should now fire the proper event for Italy rather than give them the option to collect money for the RAF
- Cheating on the Austria-Hungary Referendum and going with the annexation should no longer report that Hitler was assassinated. (the proper news event should fire instead)
- France now joins the Czech entente if they decide to support the Czechs and Czechs have their own faction
- Fixed a wrong tag in URG loc string
- Fixed Italy Befriend Bulgaria strategy not requiring Bulgaria to exist
- Reenabled Vichy France cosmetic tag in a cynical move to squeeze out a tiny bit of profit
- Fixed an event firing several times for Romania
- Fixed an issue with continuous naval/air production idea not being localised
- Fixed a situation that could cause an infinite loop of naval transports
- Made game several times less fun ( Fixed an exploit with nukes persisting after loading or starting new game )
- Design companies should no longer be lost when loading and older savegame in a new version

##################################
# Stability
##################################
- Fixed a division by zero CTD in airmissions when aircraft are fighting missiles
- Fixed various rare CTDs


################################################################
###########            Patch 1.4.1 "Oak"             ###########
################################################################

##################################
# Highlights & Important
##################################
- Units getting pushed back in naval invasions are now removed from the order so they won't automatically try it again (no more ping pong)
- Fixed the Stug tech icon to have correct barrel length
- Major rewrite of air combat system (the underlying stuff), should now have less wierd special cases and be easier to balance
- Fixed issue where generic leaders would be replaced randomly in the world due to mistake in focus tree
- Each wing of CAS should now be able to attack more than one combat removing the need to split them up in small wings

##################################
# AI
##################################
- Fixed a case where Chinese AI would delete units incorrectly due to supply evaluation
- Fixed case where AI would think that it was being encircled and would pile up its divisions in few provinces and abandon fronts
- Took care of another situation that cause indecisive units
- Made AI respect waiting after already sending lend lease requests
- A fix for front abandonment that makes it spread out the units being taken from other fronts
- Units getting pushed back in naval invasions are now removed from the order so they won't automatically try it again (no more ping pong)
- Several tweaks to allied AI to avoid "suicide invasions" agaisnt axis nations before they are at war with soviets
- Germany no longer wastes time prepping naval invasiosn vs france just before it takes around maginot
- Made sure AI cannot pick event options with weight 0 if another option with higher score exists
- AI now considers enemies as obstacles when planning invasions on nations its not yet at war with when comparing fleets leading for less wasted preparation
- ai can now cancel invasions that are bad if started during a time they were ok
- Fix for case where Germany would use too aggressive stance versus maginot line again
- Air AI can now evaluate zones for bombing and such more than 1-2 zones away
- Tweaked ai_chance for all CZE events to be saner
- If CZE exists when Germany demands Danzig from poland, they will now be very interested in joining the war rather than waiting for Germany to get around to beating them
- fixed ai scoring for volunteer only manpower law that meant hungary (maybe others?) could get stuck on Disarmed Nation.
- lowered prioritiy more for doctrines for ai if already researching one
- fixes for ai strategy files referencing the wrong focuses
- Tweaks to ai research weights, now considers 1940 fighters more important
- Spanish civil war spirit about recovery now has higher penalty for AI evaluation to join factions
- Fixed a case where AI would use the wrong execution mode and be overly aggressive when attackign maginot line
- AI should now be more active with CAS usage
- Fixed an issue where AI would not assign NAV to sea zones

##################################
# UI
##################################
- Fixed UI bug that made GER to never show tech bonuses
- Splitted "In Combat: x83" tooltip into two. Now In Combat shows default combat speed (x33) and movement gain from tactics is shown separately
- Double click in army list now deselects previous selection if shift is down
- Mission icons on the map should now include port strike
- Movement bonus from tactics were being shown in damage tooltip of a unit in battle window, remove it from tooltip.
- Added missing localization for base strike research bonuses
- Can now unassign aces with right-click like tooltip says
- Added a new text icon for cost in license production screen
- Added tooltip for air wing state
- Create airwing interface properly resets the right side when all planes are removed
- Tweaked license tooltip in production view to be somewhat clearer
- Changed Hungary 1936 bookmark to highlight restoration of Austria-Hungary 
- The person who unpaused the game is now shown in pause tooltip (if someone keeps unpausing annoyingly in MP)
- Changed license production cost icon in tool-tip
- Added description in add new air wing tool-tip
- fixed color issue for Israel
- fixed color issue with Korea
- Encirclement loses now displays on combat log. Manpower lost in convoys (which is shot by navy forces) now displayed as "Losses to enemy navy" in combat log tooltip.
- Added overrun casualties to combat log.
- Fixed air stats showing too small in wing detail view
- fix for CZE civil war not being advertised enough in focus tooltip
- added two more portraits (Japanese communist leader, Ecuador historical leader)
- Now you can mark all of the equipment as obsolete (even if base type) and equipment conversion is only done for obsolete equipment

##################################
# Modding
##################################
- Fixed a problem with the format for build_army strategy
- Fixed issue where scripted amounts for force_equipment_variants did nothing
- Added has_carrier_airwings_in_own_combat trigger for combatants

##################################
# Database
##################################
- Added missing localization for UNITS_VIEW_WINGS_COUNT in French
- Fixed missing faces for Congo
- Fixed a misspelled loc string in war goals
- Fixed the Stug tech icon to have correct barrel length
- Fixed some issues with ship names in 00_GER_names
- Made dead sea a lake
- Fixed a number of mistakes and inconsistencies in German OoB
- Improved several items of flavor text for CZE focuses
- added HMS Dreadnought to Royal Navy ship names 
- added cosmetic tag for Hungary if it elects a King but then changes ideology away from neutral (democratic, fascist branch) 
- fix for a missing event picture gfx that has been in since launch and wasn't noticed 
- fix for US missing air wing names for jets 
- East/west germany now get nicer colors and dont bug out
- Fixed incorrect portrait for Horthy when admiral
- fixed an issue with news event 311 refering to the wrong country 
- Added 4 new portraits for South america for historical leaders for Peru, Chile, Colombia, Paraguay
- Added new portrait for Bulgarian fascist leader
- Hooked in three new portraits for Baltic leaders (Police is still hunting for the set of identical triplets that were impersonating them) 
- Added proper Slovenian and Slovakian flags (honestly at this point I dont even know which one is correct /Podcat)
- Added pdxcon magic winner portrait to generic soviet portrait list 
- Dramatically improved communist Korea by using DPRK (best Korea) flag AGAIN
- Fixed 2 missing images in Romanian/hungarian events
- Added 4 new portraits (Iraq and Oman historical leaders, Italian and Japanese democratic leaders)
- Added renaming of YUG unaligned party to 'Monarchists' after Peter II takes the throne.
- Renamed Czech Export Focus national spirits to not resemble Export Focus law.
- Reenabled flavor names for German puppets for people without DoD in a cold and calculating move designed to maximize profits

##################################
# Balance
##################################
- Lowered the amount of ground based planes that can enter naval combats over time
- Reduced cost for giving core states back to our puppets
- Slightly increased fascist support in Hungary fascist king chain
- Rebalance of additional building slots for Serbian rail network focus
- Fixed a balance issue with Integrated/Serbian rail network focuses in Yugoslav tree
- Fix for air accidents being scaled depending on the number of wing 
- Increased manpower requirements for CZE alliance with Germany focuses by 50k each
- fix for Romania being able to appoint a government friendly to a faction they are at war with
- locked CZE political ideology pushers behind appropriate focuses
- lowered CZE fighter output boost
- rebalanced tech sharing group bonuses for CZE to be more in line with everyone else
- tactical bombers can now pick the naval strike mission
- Added building slots and infrastructure to balanced industry path for CZE, toned down the export focus spirits

##################################
# Bugfix
##################################
- Fixed the bug when conversion could not convert last pieces of equipment
- Removed Demand Transnistria from the Romanian historical focus list. Romania should no longer think attacking the soviet union is a great idea
- Fixed bug where technologies was not updated in case of unlocking tech from another technology folder
- Fixed bug where some modifiers were not applied to airplanes after loading a save
- Fix for Soft Attack/Hard Attack values ignoring some combat bonuses in battle gui
- Overriding an idea with custom name, now overrides the modifier name as well, instead of using idea ID as key
- Fix for trade path not being recalculated when strait control has changed
- Fixed for a potential issue if CZE becomes a puppet of AH that may lead to intra-faction warfare
- Fix for dual mediation events in Transylvania chain (RIP Katya's sanity)
- Germany should now only leave the Romanian Tech group if Romania is in a faction germany is not in
- Changed the Sudetenland failsafe event to give the war goal against the controller of Sudetenland (was hardcoded to CZE)
- changed "His Majesty' loyal government" to work even if Hungary did not roll over in the event 
- Fixed Horty not being leader of Hungary at gamestart without DoD
- Fixed an issue where Germany could be stuck with the Demand Sudetenland focus under some circumstances
- Made the demand Transylvania event chain remove the correct core (North Transylvania) for Romania if they instantly fold.
- Fixed a bug where generic unit names would not work if starting letters were the same for different generics
- Fixed an issue where existing airwing names were never returned to the pool
- Fixed a bug where traded away resources decreased amount of factories available for trade
- Fixed CZE only being angry with Allies if they decide not to fight over Southern Slovakia (CZE now always angry, all the time)
- Fix for Zalozie not being transfered if Soviet union honors MR pact
- Added a number of sanity checks for AH reclamaition focuses (must not be in faction with owners of claimed provinces)
- fixed an issue where the Ljubljana award could give out states not owned by Germany or Yugoslavia
- "Death or Dishonor or Cake" achievement now has a tooltip that tells the player to have Carol II as the country leader.
- Fix for Yugoslavia being allowed to try and buy planes from a country they are at war with 
- Blocked vanilla YUG coup event if player has DoD 
- Fix for Yugoslavia spawning Croatia even if they did not own the territory 
- Fix for Czech-Slovak civil war not actually being between Czechs and Slovaks 
- Fixed issue where aid event from Sweden to Hungary after getting democratic king would fire more than once 
- Equipment conversion now properly converts to variants from older equipment
- Fixed bug where planes set on CAS mission could join naval battles without using naval strike mission 
- Fix for two missing locs in Romania 
- Overlord of CZE telling Germany to get bent during Sudetenland crisis now removes both CZE and Overlord from faction with Germany
- Fixed an issue where democratic Romania could not even handle King Carol II right now (or ever, really) 
- Fix for AH not being able to justify wargoals due to world tension being too low 
- Fixed France being able to take CZE into their faction if they do little entente and AH puppets CZE 
- Austria-Hungary should now get Banat if Romania folds in the event chain
- Fixed an issue where Romania could steal CZE from out under Austria-Hungary by creating the Cordon Sanitaire 
- Fixed fixedpoint overflow in peace conference which could give small nations lots of extra points
- Tweaked occupation rules fix for impassible zones, now it uses core and ownership prios
- Removed retire_country_leader from generic focus tree
- Fixed the bug when merging of airwings didn't update air wing manpower properly
- Fixed a few issues with yugoslavian historical focus list referencing focuses that no longer exist
- Fixed Bordergore if Hungary not in a position to gain state 73 in fate of CZE event chain (should go to SLO, now actually does)
- Fix for volunteers transfers ending up in the impassible states
- fixed a localisation issue with a Hungarian event
- added an effect for German leaning focus
- fixed a bug with CZE "Sudden Shipyard" focus which would have required the rest of Europe to sink into the sea to work
- refusing the Sudetenland now kicks CZE out of the axis (was originally only handled in failsafe event)
- fix for Yugoslavia not actually leaving axis when they should be leaving axis in coup event (still some issues with automatic faction joining if Yugoslavia and Germany are in a war together)
- Slovenian and Slovakian flags now has proper med and small flags
- fixed dual event options for CZE news events (turns out countries are in a faction with themselves, who knew?)
- fix for logic bug in event DOD_hungary.1
- fix for incorrect Romanian Admiral's portrait
- fixed an issue with Hungarian Pact of Rome faction dragging Italy into a faction against its will
- fix for a number of text inconsitencies in news events
- Design companies now stick to licensed equipment
- fixed a Romanian division being assigned to Hungary
- Updated script for Invite German Advisors. Germany now correctly removed when Romania joins another faction.
- Planes are able to attack several ground targets at the same time now rather than one per wing
- TfV trees checking for an autonomy level will now accept DoD autonomy levels as well
- Supply areas now ignores impassable states while building the connection graph
- added missing localisation for a number of tech sharing group descriptions
- Navy leader can now gain the air_controller trait by having carrier airplanes in combat.
- Now rockets does not cancel their mission in case of non of the rockets left
- Foreign equipment now qualifies again for conversion
- Who counts as attacker and defender in paradrops should no longer be country order dependent (sorry french paratroopers)
- Ensured hungarian mediator events revert to 'rebuffed twice' outcome when no eligible mediators can be found.
- Fixed YUG being freed when they are a puppet of GER and get the anti-German coup.
- Fixed anti-German coup not switching YUG ideology to unaligned when picking that option.
- Removed fascist requirement from Second Vienna Award focus
- abandoning the czechs during Munich now cancels any guarantees and tells the ai to stop caring about CZE (to avoid renewing the guarantee right away)
- fixed military access being given to the wrong country in a Romanian event
- fixed a number of faction joining focuses to prevent intra-faction warfare
- fixed issue where air wings without assigned region would lose their set mission

###############################
# Stability & Performance
###############################
- Added safety code for terrain calculation when loading broken mod files (could lead to deleted units)
- Fixed stack out of bounds issue when generating unit names
- Fix for CTD in the airview details view 
- Fixed CTD while tooltiping port strike air wing mission entry 
- Fix for CTD when airbase were removed or deleted while being selected
- Fixed a possible null pointer exception
- Fixing CTD in air interface
- Increased the size of atlas used for the country flags on map to fix glitches
- Fixed CTD when AI tried to evaluate returning expeditionaries for someone with no homeland
- Fixed CTD in mods related to naval base assignment
- Fixed a CTD related to hotjoining in while selecting airbases
- Fixed a case where savegames would keep growing and becoming huge
- Fixed a cross plaform out of synch
- Fixed a multithread related out of synch in multiplayer


################################################################
###########              VERSION 1.4 "Oak"             ###########
################################################################

#######################################################
# Death or Dishonor Country Pack
#######################################################
- New focus trees, generals, companies, and ministers for Romania, Hungary, Czechoslovakia and Yugoslavia including alternate history paths.
- New 3d models for vehicles, planes and infantry as well as accompanying 2d art for the new nations
- 3 new war themed music tracks by composer Andreas Waldetoft
- Voice over sounds for infantry units in Czechoslovakia, Romania and Hungary
- You can now License Produce equipment from other nations
- Added Equipment conversion ability on production lines that allow you to convert older equipment to newer and/or self-propelled models
- Added 2 new industry techs that allow you to improve conversion efficiency
- New subject levels for fascist nations: Satellite, Reichsprotectorate and Reichskommisariat
- Added 10 new achievements 


##################################
# Free Features & Important
##################################
- All new air controls and interfaces including new air combat screen
- Air missions and wings now visible and selectable on map with ranges etc
- Radar now more visible with ranges on map that can be toggled
- Added possibility to rename air wings and added historical naming schemes to most nations
- Its now possible to stop being capitulated by getting back to 90% and recovering your capital. Rules show on war participant items when they have the capitulate icon up.
- Grabbing territory occupied by others in peace conferences now much more expensive
- Several changes to map and strategic areas for better play
- New impassable borders and areas (Sahara) making warfare in certain parts of the world much more interesting
- Updated interfaces for War and Trade


##################################
# AI
##################################
- Made AI not bother with fallback orders if the area they would be defending is tiny. Makes the AI better at pushing after landing a naval invasion.
- Made unitcontroller units more decisive in where they are going, as well as various tweaks and fixes to reduce shuffling.
- Significant improvements to front balancing( Units should be far less likely to abandon parts of the front and far better at spreading units out across the front )
- Units controlled by the front should now cancel orders that are heading towards provinces that are no longer part of the front
- Fixed bug that would cause units to get very poorly assigned when an attack order auto splits ( for instance when it reaches its target at a province at the center of the order )
- Improved AI focus a little bit, making idea evaluation a little better.
- Tweaked what it means for a front to have the same value for highest and lowest prio score. Used to cause some fronts to never move.
- Made sure the AI is not trying to upgrade specialist templates before it has the tech. 
- Removed mobile template designs, because the AI cannot handle them properly.  
- Found and fixed an issue that could lead to AI not assigning units to a plan.
- Found and fixed some rare situational plan activation bugs. 
- Fixed to pretty nasty issues with plan activation that caused France to act dumber than usual and charge across the Maginot line again. 
- Fixed major booboo that cause AI to often just redraw attack plans
- AI now rebuilds attack plans if they are almost done and getting stuck
- Fixed issue with SOV putting an anti tank battalion in their infantry divisions
- Made sure AI does not convert equipment, for now. AI is better off using what it has than trying to optimize through conversion.
- Tweaked what AI sees as an easy target and weak units for better front activation. 
- Overhauled AI plan activation and mode setting.
- Fixed mistake in AI fortification evaluation for plan activation, and made them better at taking advantage of weaknesses in fortified enemy fronts.
- AI will now respect impassable borders when drawing plans.
- Fixed a case of redundant unit shuffle.
- Implemented scriptable production prio per template target. 
- Made sure 4 hour rule applies when changing attack target.
- Tons of AI template design bugfixes, improvements and tweaks in both code and script for many of the majors, as well as in the general script for other countries.
- Integrated logic for adding battalions together with replace so both options are evaluated at the same time. 
- Found a mistake in template match calculation and fixed it. Now seem 100% solid. 
- AI non capital area garrison order no longer guards the whole coast.
- Fixed bug in template match score calculation that could cause some countries to get stuck and not develop any new templates.
- Made sure rounding error does not break unit distribution on fronts.
- Tweaked port building desire based on AI naval focus.
- AI production tweaks taking role changes into account. 
- Germany and Soviet are now able to field anti armor divisions.
- Soviet and Germany should now prioritize tank destroyer technology as they are facing enemies with increasing armor. 
- Added first pass anti armor roles for Germany and Soviet as well as AI test scripts for it. 
- Implemented caching of armor and piercing values per country as well as intel functions to get some of them (others can be added as needed, but keeping). 
- Tiny change in AI personality; being hostile towards someone now also means they want to weaken them. 
- Made custom icons for AI templates scriptable. 
- Increased priority for infantry expert for Japan.
- Trying out Japan starting out doing army primacy.
- AI can handle reinforce priority better when designing templates. 
- It is now possible to script reinforcement prio for AI templates, and the AI can handle it.
- Rather drastic changes that effect how many troops end up in Africa. 
- Fixed bug in AI deciding on which templates are best for production.
- Improved unitcontroller front shuffling when fighting.
- Improved distance factor for unitcontroller handling fronts during wars. 
- Germany no longer loves spending time on motorized.
- Improved Germany AI garrison template. 
- Improved AI garrison template design. AI now badly wants to assign garrison units to garrison orders and will avoid assigning armor to garrison or naval invasion orders.
- Separated strategies for building ships, airplanes and land units in order to make saves work with roles.
- Added trigger for if AI has fielded divisions of a certain role for AI testing and template scripting. 
- Germany should now be able to design and field garrison units.
- Template roles should now be saved along with deployment lines (they get assigned one to make sure the count per role to build is proper.)
- AI template design progression now works as earlier, but locked within role.
- Roles now exist in upgrading templates and deployment.
- The AI should now be sending and recalling expeditionaries intelligently.
- Removed silly AI code that could potentially lead to AI only front shuffling.
- Fixed the bug when air ai would not deploy any air wings if no airwings deployed already
- Fixed the bug when air AI was too focus on naval air superiority rather than getting air superiority in land combat areas
- Fixed the bug when air AI prioritized own units on friendly territory, rather own units on own territory
- Now AI logic for request and recieve lend-lease equipment should be consistent with each other
- tweaked China's templates so they try to aim for something less industrially costly until strong enough (burn manpower!)
- fixed a case where AI would manage to sneek in nations it didnt actualy want in factions (like finland in axis too early) just because it really really really hated their opponents
- fixed a case where ai would jump on total mobilization despite having low manpower laws and ruinign their reinforcement (probably only ever happened for big nations like china)
- added separate ai scoring bonus for ahead of time techs so they better take advantage of them
- Units that already have good positions on the front are no longer considered for moving along the front
- Fixed bug that could cause units to take a naval path to nearby provinces they could just walk too.
- Fixed bug that could cause units to cancel their move orders when they shouldn't.
- Scripted higher prio for economic and manpower laws.
- AI will ignore historical list when looking for focus to bypass.
- Fixed case where AI could get stuck researching if only single techs were queued and they were not possible to research 
- Fixed an issue where AI would queue up tech targets too early so they were not correctly evaluated
- Improved logic for US involvement in the war in the case of swift japanese victory vs china. It will now get interested as australia and india start to fall also
- Minors will now do economic mobilization laws if justified against rather than wait for tension or declaration of war (to help china)
- China now a bit more on the ball on manpower laws as they need to throw anything they can at the invaders
- All nations will now be less spendy on admirals early on
- Soviet will now respect the spirit of the ribbentropp pact and not send volunteers to poland ever
- Chinese AI will now consider naval ministers less interesting
- Tweaked many ai research weights to remove wierd choices due to timing
- Reduced AI research weights for picking heavy tank and special forces techs
- Tweaked ai weights for nations to make better selection on manpower and economic laws
- A lot of changes to AI target templates for majors
- A lot of changes to AI production targets for majors
- Several changes so default AI focus more on inf, capital ships, fighters, less on armor, random planes, and subs/destroyers


##################################
# UI
##################################
- Dramatically improved communist Korea by using DPRK (best Korea) flag
- Console now can't be open in multilayer or ironman
- Added tool tip information about amount of division templates in the army when you hover over division counts
- Added option to double click for selection of all units in army with same template
- Made significant fixes to how autoscrolling for selected units list to make sure that now it will follow the selection properly
- Fixed overflow error that could cause wrong display of the intel data numbers
- Fixed the bug when available wargoals alert could stuck in iteration trough countries player has wargoals against
- Fixed the bug when you could request 0 troops from your puppet
- Fixed the bug when civil war country manpower were displayed incorrectly
- Tooltips for battalions in division designer now show correct change in the supply usage
- Now 'Subject main soon rise Autonomy" alert opens subjects screen
- Added reinforcement priority status for the template change menu entries
- Now tooltip for time estimation shows "Never" in case if factories assigned but penalty is too big instead [No factories assigned]
- Added manpower showing on the info diplo screen
- Now equipment type buttons in the request lend lease screen does not depend on the production or stockpile of the requesting side, rather than if this equipment is known to be available for export
- Airbase icons are 30% larger in the strategic air map mode
- Expanded the war overview window to show more information. Major countries now also has a golden frame, and capitulated countries now has a white flag.
- Impassable terrain now has a spiky outline.
- Changed radar tool-tip to clarify it helps you detect enemy fleets rather than your own
- Changed the icon for manpower losses in theater history. It was using the icon for manpower (top bar) but is now using the icon for losses (war casualties). 
- Tweaked some interface stuff for air combat (stuff that was meant for the simplified version, but is of no use now).
- Added new texture-files for the simplified air combat interface, to fit some old elements that would be moved into this air combat interface.  
- Implemented a simplified version of future air combat interface (in case of planned interface can't be implemented, due to time constraints).
- Changed the cropping width of the Air wing names and air zone names in the air wing interface.  This frees up more space for other elements that occupies the interface. 
- Changed the highlight color for "outdated equipment", "available licenses" and "active licenses" in the Production window. They were in white but are now in yellow, for consistency. 
- Change color of several text elements in naval battle, for more consistency. Parentheses for ship names during naval engagements have been changed from green to white. Changed "dispatch" to "dismiss" in the report for naval battles. 
- Changed coloring of naval losses text, for consistency
- Fixed some text-padding in the construction interface (some text was overlapping).
- Added convoys count on lend lease trade route tooltip.
- Fixed issue where there some plane icons had different sizes
- Fixed an issue where animated sprites would sometimes "strobe"
- Changed colors for strategic naval view to match air and be clearer
- Strategic air mapmode now has clearer and more visible coloring
- Fixed overflow issue in peace demand lists
- Created effects and animations on submarine.
- Fixed a bug where machine gun infantry trained with rifles.
- Created march animations for some units that were missign them.
- Tweaked several animations
- Airbase indicator on counters no longer eats zoom-in from mouse
- Efficiency growth now grouped with other modifiers of same type in production interface  
- Clarified tooltip of what production is needed for icon in production interface and added tooltip to number also
- Added mip bias to button texture loading as some drivers may be picking a worse mip level for our generals 
- Console now can no longer be open in multiplayer or ironman to making life a bit harder for cheaters
- When player is about to build a new radar, the new effect is drawn to indicate the next level range
- Radars now has the on-map-icon. So player can see them when playing with 3d buildings disabled
- Added setting for toggling visibility of radars on map 
- Mouse over the radar icon shows the details tooltip and a range indication circle
- While in the strategic air map mode, now the terrain is painted with stripes indicating if any of the selected air wings can be assigned to that region or not
- Fixed missing scrollbar in division designer when selecting custom icon
- Clicking on the army no longer swaps the map mode to the default one. Also it is now possible to draw battleplans in any map mode from pressing the "small" map mode buttons


##################################
# Audio
##################################
- Added and improved sound effects for airplanes.
- Added and tweaked audio assets for infantry and artillery.
- Added more weather sound effects
- Added new notifications sound effects
- Fixed several audio bugs


##################################
# Modding
##################################
- Added triggers for estimated max armor and piercing based on intel.
- Fix for CTD that occurred after reloading focus trees
- added console command "ai_pp_log" to log AI use of PP
- has_idea trigger is no longer affected by order of files in database.
- Fixed a crash when painting cities on the edge of the map.
- Added possibility to hide parts of the focus tree with a trigger. allow_branch = { <trigger> }.
- Added ability to reposition national focus based on trigger.
- Added modifier: IMPROVE_RELATIONS_MAINTAIN_COST_FACTOR 
- Added support for relation modifiers and valid_relation_trigger in the static modifiers file. Modifiers are removed if the trigger becomes false.
- Added add_relation_modifier effect that adds a static modifier from current scope to target.
- Added remove_relation_modifier effect.
- Added trigger has_relation_modifier.
- Added modifier license_purchase_cost_factor. Modifies total CIC cost of purchasing a license.
- Added modifier license_production_speed_factor. Modifies production speed for license.
- Added modifier license_tech_difference_speed_factor. Modifies production speed penalty from tech level difference.
- Added dynamic cost_factor modifier for idea groups. Example political_advisor_cost_factor.
- Added ai_license_acceptance modifier, for relation modifiers. Modifies desire for the ai to sell licenses.
- Added modifiers for purchase cost of specific types of licenses. license_air_purchase_cost_factor license_infantry_purchase_cost_factor license_armor_purchase_cost_factor license_naval_purchase_cost_factor 
- Added triggers for license production: is_licensing_to and is_licensing_any_to.
- Added set_building_level effect, that sets the level of specified building.
- Added a level < <number> limit for building province buildings.
- Added any_province_building_level trigger.
- Added console commands set_global_flag and set_country_flag.
- Added guarantee_cost modifier. Modifies the PP cost of guaranteeing a nation.
- Added autonomy_gain_global_factor modifier. Factor on all autonomy gained by a subject.
- Added trigger amount_research_slots > <int>
- Added trigger manpower_per_military_factory
- Added allow_branch trigger to technology trees. Will disable and hide all children of a technology that does not meet the trigger.
- Added possibility to look for a specific archetype of ship in has_navy_size trigger.
- Added trigger amount_taken_ideas. Excludes national_spirit, hidden, law = yes. Example: amount_taken_ideas = { amount < <int> (mandatory)  category = { military_staff } 	slot = { army_chief political_advisor }	} Category and slot is optional.
- Added on_state_control_changed to on action.
- Added non_core_manpower modifier that can be used on country level to control manpower from non-core territory
- Added new ai strategy land_xp_spend_priority with valid values of "division_template" or "equipment_variant"
- Added new ai strategy pp_spend_priority with valid values of "admiral" or "general" or an idea
- Added new parameter states_filter to start_civil_war effect which filters out invalid states from list
- Added new defines to control costs in peace deals (BASE_PEACE_TAKE_UNCONTROLLED_STATE_FACTOR, BASE_PEACE_TAKE_FACTION_CONTROLLED_STATE_FACTOR)
- States can now be marked as impassable and can then not be traversed by troops, they get special border graphics to signify this. Province view will indicate with an icon+tooltip, as will on-map tooltip
- Borders between provinces can now be set up in adjacencies as impassable and can then not be passed
- Added on_uncapitulate on-action to mirror capitulation
- Added triggers for estimated max armor and piercing based on intel. 


##################################
# Database
##################################
- Fixed issue with Japanese Infantry Equipment flavor name (hi ceebie)
- Added air wing naming schemes for many nations, including all majors, TfV and DoD countries
- Made suicide planes their own archetype
- added a few more Cosmetic tags based on historical research
- Changed wwill to will in localization file
- Soviet generals are no longer allowed to derp SU-152s in tank destroyer mode. The localization has been changed so that SU-152 is now self-propelled artillery and the SU-100-Y is the tank destroyer.
- Added Takuo Godo war industrialist advisor for Japan
- Added corps commanders and navy leaders to: Ion Antonescu, Gheorghe Avramescu, Horia Macellariu. Removed generic navy leader.
- Yugoslavia high command: Changed area of expertise to "Army Drill - Expert"  Danilo Kalafatovic changed to "Maneuver - Expert".
- Added new army leaders to Yugoslavia: Danilo Kalafatovic, Milutin Nedic, Petar Kosic, Marijan Polic.
- Added new army leaders to Hungary: Ferenc Feketehalmy-Czeydmer, Kàvoly Beregfy, Lajos Veres.
- Added Hungarian design companies: Ganz Danubius, MÁVAG and Fegyver- és Gépgyár
- Bumped Walter Model to skill 2 field marshal with defensive traits
- Added autogeneration of Air Wing names if none is scripted
- German generals von Kleist and W. List both get +1 skill level
- Added silly king renaming cities events instead of fixing the AI


##################################
# Balance
##################################
- Reworked airzones in several areas to be smaller and/or rational
- Blocked Sudetenland focus for Germany if Germany is in a faction with CZE and together in a war
- Changed event germany.122 (Sudetenland failsafe) to kick CZE out of the Axis if they refuse.
- Changed number of building slots in greater Transylvanian area based on feedback
- Added a core for Bulgaria in the Treaty of Craiova 
- Added Aluminium to Asia
- Blocked ENG/FRA from interfering in Sudetenland if they are puppets 
- Added a global flag that is set if Germany starts a war. AI weights for the Sudetenland and Rhineland have been adjusted to ensure that Germany will be challenged if they started a war before taking those focuses
- If FRA supports CZE alone in Munich they will no longer steal CZE from their existing faction
- ENG/FRA are more likely to support CZE during munich if both they and CZE are communist 
- CZE is more likely to fight over Munich even if abandoned if they are in a faction, even more so if they lead a faction
- Changed demand sudetenland effect to send demand to Czechoslovakia's overlord if there is one
- CAS, fighters and tac bombers now have a stat progression for naval_strike_attack instead of the same for all models.
- Rebalanced damage scaling in air combat to avoid most of the wierdnesses. more planes generally more deaths etc, also less damage in the really bloody defend/intercept scenarios
- Increased advantage of numerical superiority in air combat. 1000v100 test get around 30% bonus for big side rather than < 10%
- Now possible to disrupt all incoming bombers/CAS if you have enough fighters in air combat
- Scaled down damage done to planes on the ground during bombing to 1/5th
- Hungary now gets to have great war tank starting tech
- Prince of terror trait now gets +2% more recruitment from non-core territory
- Tweaked equipment deficiencies and some factory setups for china and japan in 1936 to balance later war
- Tweaked japanese/chinese tempaltes to slow down the war
- Reduced equipment starting lack for soviets in 1936
- Reduced stockpile gain on capitulate by 25%
- Its now 10x more expensive to take territory occupied by another faction in a peace deal (e.g allies taking stuff commintern occupies)
- Custom-difficulty slider now also reduces the impact of resource shortage for AI
- The amount of spawned milita divisions in Spanish Civil War are now more and positioned better to draw out conflict
- Spanish civil war equipment levels tweaked for longer conflict
- Tweaked SCW participant NU levels
- Bombing warscore now worth less on your participation


##################################
# Bugfix
##################################
- Fixed a duplicate advisor for Canada
- Fixed an issue with Vichy France thinking it was actually a proper nation and changing its name while still a puppet. 
- Fix for France and Britain gallantly coming to the rescue of a CZE that is allied to Germany 
- Fixed an issue where Romania could still refuse Bessarabia demands on historical mode (will now never refuse on historical)
- Fixed an issue with the name of Greek party in spanish loc
- Fixed a trigger issue with the Germany befriends China focus (was OR, should have been AND) 
- Fixed an issue with a tooltip to cancel all construction displaying the wrong key combination (Shift+click instead of Ctrl+click) 
- Fixed critical spelling error in South African focus description
- Changed event France.14: added ai chances (AI will now always create Vichy in historical mode), fixed a bug that would not assign Italy a state they were supposed to get when Vichy is created
- Units can no longer be in multiple attack combats at the same time
- Fixed the bug when quite damaged fleet never could be sinked by naval strike
- Fixed the bug when large stacks of CAS could not enter combat after entering the combat
- Fixed the bug when civil war side received only dead-zombie divisions
- Research bonus now sticks to tech its applied to
- Mission efficiency now affects air superiority
- Fixed the bug when change of political setup could lead to blocking of lend lease cancelation by level of world tension
- Now transfer_ships effect won't transfer wrong fleet in case of the ships with same name of in one fleet
- Fixed the bug when you could not lend lease allies in case of fighting in war together
- Now war overview shows the exact faction members that have to surrender to make sure that war ends
- Unlocked technology now properly updates units and division template stats
- Fix for the bug when ships port capacity was wrongly calculated while merging fleets
- Radar levels now uses last non damaged level for calculations
- Now subjects can join only master's wars
- Rockets now get properly upgraded
- Fixed the bug when military access was reversed for the strait rules
- Fixed the bug when airplane transfer progress was not saved
- Fixed the bug when building slots in revolter country were counted as non-core
- Fixed the bug when puppets were not automatically included in the peace conferences as loosing sides
- Fixed the bug when threat from the focuses with national focus were displayed incorrectly
- Peace conference does not consider any more as loser side country occupied by another one that stays at war with occupied after piece conference
- Fixed the map tooltip bug that occurred when units were selected in secondary mapmode but was showing still the unit movement info
- Attacked units now can attack on their own
- Made possible to declare war on puppets if already at war with master
- Now subjects can always join master's wars
- Fixed the bug when colonial troops disappeared after annexation of the subject
- Fixed the issue when on map tooltip shown that rocketsite and air base were located in state even they were not built yet
- Fixed the bug when political power was shown as progress for war goal justification
- Fixed the bug when cancellation of the trade happened if influence of opposite country was below zero
- Added removing of the war threat when canceling justification of the war goal
- Naval service manpower now properly returns after ships are getting sink in the naval combat
- Fixed the bug when factories could not be converted if there is no factory of other type in the state
- Went grammar fascist on an error log message for when dupliacte ideas had been scripted in.
- Fixed an issue where Slovakia used a Slovenian flag.
- Fixed a number of errors in German localisation (thanks davewolf!)
- Radar tool-tip no longer claims that it helps the enemy find your fleets
- The Northern Lights achievement now recognizes dynamic tags spawned from the Scandinavian countries
- Changed demand sudetenland focus to send the event to Czechoslovakia's overlord if they're a subject
- Blocked the munich conference (from Demand Sudeteland) if england no longer exists or has become a subject. Czechoslovakia (or their overlord) get the direct demand event instead.
- Fixed issue where units could be given multi-province retreat orders ( This could result in for instance retreats all the way back to your capital )
- Canada has finally learned that no means no and will no longer join Germany's faction when the proposal is rejected.
- Added bypass to Canadian focus 'Join Germany' if Canada is already in a faction with Germany.
- Canada will no longer get wargoals on USA from focus when they are in the same faction.
- Removed 0-1 cap from join_faction_tension and guarantee_tension modifiers to show tooltips when ideas reduce them.
- Fixed every_enemy_country effect using same code as random_enemy_country effect.
- Fixed database issue that caused has_available_idea_with_traits to not work for design companies.
- Fixed an issue where splitting an uneven amount of resources down the middle would round up both piles and cause discrepancies between trade interface and production interface.
- Units containing primarily licensed or lend leased variants now use 3D models from the equipments original creator.
- Added tooltip generation for create unit commander effects.
- Trade view now filters subjects properly.
- Added bypass to Japanese focus Sever 'Sino-German Ties' if China is a puppet of Japan.
- Request Lend Lease should no longer show as if it would be accepted if there is no equipment available for lease or the requester has too much equipment.
- Yugoslavia now only loses ideology support when Italy completes 'Claims on Yugoslavia' if they are not obviously working towards that ideology.
- Added support types so japanese suicide craft will work
- Fixed some cases that made air outcomes wierd and where air speed has extremely little (or possibly bad) impact
- Completing focuses no longer resets their tension impact. also tension given back now scales properly depending on when you cancel
- Syria and tunisia no longer changes controller as part of vichy events if occupied by 3rd party
- Fixed invalid caluclation for offer peace action. can now actually offer peace when losing
- Fixed an issue where divisions would get deleted when being transfered to another nation due to manpower already reset
- Total production line output can no longer go negative (caps at 0 and only appeared when doing certain modding)
- Fixed a problem with overflows for large manpower numbers when calculating intel
- Target for surrender now checks if we are allowed to surrender and scores appropriately. Fixes issues where multiple wars could block each other from ending despite a full side having capitulated, yet not called some party in
- Bombing warscore is now properly capped to its max even when bombing multiple target nations
- Portrait settings file no longer checksummed. Moved from common.
- Portrait database can now load data correctly from multiple files.


###############################
# Stability & Performance
###############################
- Fix for CTD during end of the offered peace conference
- Now pending diplomatic requests are cleared properly when exiting to main menu (could cause CTD as well as UI corruption)
- Fix for CTD caused by wargoal alert being clicked with bad timing
- Fixed CTD from deleting airwings by reducing size to 0 and then opening the air overview
- Fixed the annoying "death by of a thousand savesgames" thing that could happen when running with a lot of debug saves enabled and jumping around date points
- Fixed a CTD if a unit from a save with an invalid war with no capital was attempted to be teleported to it
- Fixed a place where illegal memory could be accessed, potentially triggering the birth of a new chaos god
- Fixed potential CTD/memory corruption in updatefrontdata averting the chaos gods once again
- Fixed a potential mod related memory corruption in launcher that could lead to rare crashes
- Fixed a case where certain scripted nations could make the game CTD selecting 1939 start


################################################################
###########            Patch 1.3.3 "Torch"           ###########
################################################################


##################################
# AI
##################################
- Italy AI should now be better at picking proper units to fight in Ethiopia.
- AI is now inclined to ignore non-dangerous fronts while at war.
- Battle plan AI should no longer "forget" units assigned to attack order.
- Made AI better at dynamically evaluating level of preparation to attack based on expected enemy strength.
- AI should no longer be able to give units ridiculously long retreat or move orders while they are in combat.
- The AI should now be a lot better at handling a surrounded enemy capital.
- AI is less spammy with call to arms and join war requests.
- Battle plan AI unit distribution should now be more stable (though even further improvements would be good).
- AI will no longer declare wars on countries that control no territory, even if they technically exist in a limbo while their faction have not lost a war.
- The AI should now be managing its theaters better.
- AI will now start considering buildup of military constructions after a while, even if peaceful and not directly threatened.
- Naval AI will now attempt to use strike fleets to aid in coastal land combats if they are not on a mission to aid in a naval combat.
- Some minor AI optimizations.
- AI occupation policy is now scriptable, though no scripts for this has been added.
- Repaired a mistake in AI diplo for offering someone to join their faction. Threat from wrong side was used when looking at acceptance.
- Made sure AI considers org when performing naval invasions.
- Eat your vegetables before you get dessert: AI will no longer be declaring wars or justifying claims while in a losing war.
- The AI can now build any scripted building that is a part of an established building category.
- Made sure AI can not send parts of equipment. Half a ship is not particularly useful.
- Fixed a serious issue where AI would never counter resistance with area defense orders, completely ignoring conquered territory.
- AI is now less nervous about neighbors fighting a common enemy and not losing.
- Purged unit_base, as it did nothing apart from making scripting harder. unit_ratio is now the end all an be all of unit production in the scripting, and setting it to anything but a positive value will make the AI NOT build it.
- AI will now remove deployment lines for types it has reached its wanted number for.
- Improved the code behind AI template design, so the scripting should make more sense now.
- Minor tweaks to terrain prio when drawing fallback line which should make the go for mountains more.
- Battle plan AI is now capable of finding more complex paths to front position.
- Some balancing to construction AI focused on improving military industry production.
- Made AI better at calculating supply use when deciding how many divisions it can field.
- Made sure AI is not blocked from researching, even if only crap is left. Script can still set AI desire to 0 to block it.
- Improved naval AI region evaluation and made it better at reacting more efficiently to changing situations.
- AI now considers reinforcement priority for volunteer theater.
- Improved deployment AI to manage lines better and improved calculation of desired number of divisions.
- Added ai_strategy type 'support' that can be used to manipulate a countries desire to send lend lease to another country.
- Added will_lead_to_war_with when Germany demands Sudetenland. Makes AI prepare for a possible war.
- Improvements for air AI airwings picking and distribution
- Now air AI considers AA while prioritizing strategic bombing and defense operations
- AI should no longer be so happy on naval construction over military when it had also alot of civilian industry (hello USA)
- AI can now reprioritize production lines in a few cases to deal with resource lack
- AI us now makes use of more civilian factories when needed for trade
- fixed a case where AI would get sidetracked when designing divisions of specific country type and instead attempt to make generic ones
- added "ai_priority" on battalion types that get calculated by template, ai uses these rather than the visual representation to manage its divisions
- AI is now able to send old equipment as lend lease not just its newest
- AI can now cancel lend leases it can no longer afford or with nations it no longer make sense
- made AI more careful with its stockpile and who to lend lease to
- improved logic for AI's lend leasing
- fixed issue where a big difference in scoring of combat width could make AI refuse to upgrade its divisions
- USA should now lend lease soviets when they are in trouble if they have sufficient spare stockpile
- "support" ai strategy now lets nations lend lease away some of their stockpile buffer too
- fixed a case where AI would fail to deploy its main invasion protect fleet completely if some of the areas were out of range
- fixed AI invadability evaluation sometimes failing on naval path checking
- fixed a case where AI would try to split off fleets when it was not valid 
- fixed a case where AI would spam invalid naval moves
- added equipment_stockpile ai strategy that lets you affect how much stockpile ai feels it needs
- all nations with many divisions will now attempt to accumulate bigger stockpiles for safety
- Fixed several cases where overflow of calcualted priorities could make AI do the opposite of what it wanted to do
- Now air ai calls recalculation of air priorities on joining a war
- fixed an issue where air AI would fail to assign mission if the only acceptable one was interception
- fixed a case where Japan would ASK to join germanys wars despite doing badly with china 
- nations with restrictive modifiers for joining factions (japan) now super careful about accepting calls to arms to majors (soviet) when still at war with major neighbors (china)
- ai should now no longer get stuck on super large trades and better fulfill its needs (basically skipped the full-trade logic) 
- AI now looks for trades in priority order of biggest lack 
- AI now prefers trade with closer nations if naval transport required 
- AI now likes trading with nations with neutral foreign policy more as they are stable 
- lend lease now automatically cancels when war ends for the receiver 
- AI is now MUCH better at looking at the equipment cost for switching more templates than just one at a time 
- AI cares about infrastructure way more when placing consctruction
- AI should no longer go as happy on naval construction over military (was counting ratio also using civilian so got disproportional large naval part)
- AI us now allowed to trade using more civilian factories 
- Ai should now be much better at going for medium tank divisions. Fixed issues with width being off as well as wrong template being used when evaluatign fitness for changing out lines
- rebalanced ai priorities for medium vs light armor so that ai doesnt get stuck thinking its making light when it isnt
- fixed a case where AI was looking at the wrong type when deciding about template upgrades and could get stuck on motorized
- AI should now show greater interest in researching excavation tech.
- Tweaked templates a bit for majors to avoid getting trapped in subpar targets
- Allied AI will no longer guarantee Finland if Soviet justifies war on their claims, while Germany is the biggest threat.
- fixed an issue where some scripted ai strategies would not work after updates (it was order dependant)
- added an AI sanity check to the War with the USSR focus for Germany
- Reduced AI research randomness and improved info in AI research log message
- Made sure AI considers convoy count and possible delivery route before sending lend lease
- AI will now leave potentially hostile nations alone for guarantees until they have generated some actual threat giving you 1-2 smaller wars before you are sucked into the ww2 vortex (makes some minors a lot more playable)
- rebalanced ai priorities for medium vs light armor so that ai doesnt get stuck thinking its making light when it isnt
- fixed a case where AI was looking at the wrong type when deciding about template upgrades and could get stuck on motorized
- Improved AI trade law logic selection
- AI now has a can_upgrade_in_field trigger on templates to give it hints on when to stop producing light tanks and switch over to medium for stuff


##################################
# UI
##################################
- Battleplans are now hidden during the peace conference to not obstruct the view.
- Players lagging behind message in multiplayer, is now replaced with an alert (tooltip shows who and how much).
- Added alert about having unassigned divisions.
- Added loading progress bars.
- When selecting a division(s), the list of all divisions automatically scrolls to show it.
- It is possible to hide ALL map counters except your units. Hotkey 'M'.
- All the message popups that doesn't require the player choice (yes/no/etc), automatically hides after timeout, to not fill the screen with hundreds of windows. Useful when running the "hands-off" observing game.
- Building constructions and conversions now can be added at the top of the queue by holding ctrl and click.
- Made save game name text field longer.
- Added stockpiling amount to production screen. Changed text to icons.
- Added tooltip to US "Destroyers for Bases" focus to make it clear who gains certain territories
- Fixed a tooltip for the Australian focus "A Deal with Japan" to account for different options of territories transferred
- Fixed legibility issues in event news.199
- Fixed a tooltip issue in the SAF focus tree
- Added dockyard output modifier icon in the production screen
- Fixed wrong division flags in the combat screen
- Missiles now count as bombers in the region air screen
- Fixed issue when multiple army groups was not shown in the volunteer theater groups
- Multiple fixes for trade influence issues with not matching numbers
- Tooltip in the research screen does not show ahead of time penalty if player has 100% ahead of time penalty reduction bonus
- Minor fix for army group leader tooltip, to match numbers when penalty for too many units applied
- Arrows now gets hidden while editing the orders
- Now top bar tooltip for factories also shows damaged ones
- Missiles are not shown in logistics screen anymore
- Fixes for fear trade modifiers being applied in wrong direction
- Now clicking on not existing country in the managing occupied areas screen you won't go to diplomacy screen
- Fixed the bug when plan evaluation numbers was not matching
- Fixed the bug when capital icons were not correctly shown
- Fix for the tooltip on return territory
- Added clarification on non-progressing training by reason of lacking equipment and manpower
- Now Pass button gets disabled in the peace conference if no actions left to take
- Combat log screen now will be shown on top of other screens
- Now load game button disable at the same time as continue button
- Clarified tooltip for opening multiple info windows in the tech and focus tree screens
- Political cost now is hidden when the law is taken
- Fix for the switch to next autonomy level glow (now it is actually hidden)
- Fixed warscore not being calculated properly while war without majors on one side
- Now invalid leader picking screens disappear as army group gets deleted
- Disabled icons while in deployment mode
- Fix for the rules not being updated on savegame load
- If national focus not changing tooltip doesn't show weekly change anymore
- Fixed factory conversion button flickering while non-paused gameplay
- Fixed the bug when techtree was broken after switching country
- Added ability to toggle fog of war map effect on/off
- Tooltips existing lend leases for equipment now show type as well as national flavor name when these differ
- Releasing nations with a lot of states no longer massively overflows popup window
- Multiple rows of division types now possible to be shown in army overview
- Tweaked gradient borders for strategic areas so there is no weird gap between areas (more visible with mods)
- Air wing reinforce limit window now has the +50/+100 buttons jump to closest multiple to avoid clicks for neat sizes, steps are also +5/+10 for carrier parked wings
- Can now increase/decrease queued up ship production faster with ctrl/shift click (ctrl=10 at a time, shift=100 at a time)
- Indian National Army focus now has correct effect description
- Fixed overlap of text in options with certain languages
- Changed shortcut for closing a bunch of production items as ctrl+click it’s easy to miss-click with other shift+click nearby
- Fixed centering of trade scrollbar
- Achievement entry header now highlighted in orange
- Achievement window now movable 
- Resistance tick indicator now doesn’t show VP stuff in states where there can’t be resistance
- Clicking rightmost side of savegame edit box no longer deselects editing
- Spelling fix of Trotskyist
- Added tooltip to icons displaying used combat width in the combat window .
- Added tooltip to research button explaining the 30 days grace period.
- Added province tooltip if there is an air base or rocket site present.
- Added state name when hovering over a naval base.
- Renamed "Small arms research time" to "Weapons and Equipment Research Time"
- Explained conditional effect of why we fight focus in tooltip
- Entrenchment tooltip only shows days left when unit is not fully entrenched.
- Fixed rounding issue in resource mapmode
- Made separate production tooltip for naval items, reflecting they don't retain efficiency.
- Added war requirement to lend lease tooltip.
- Armies view: Improved consistency across the different tooltips. Added penalty to the groupview in the bottom of the screen. Moved penalty explanation to delayed.
- Added delayed tooltip to production line filter explaining Shift+click mechanic.
- Removed "Support" header from division icon tooltip when it has no support.
- Changed production line tooltip to no longer lie about total output and resource efficiency to the player.
- Maximum amount of slots is always stated. Factor modifiers not shown if slots < 0. Wasteland is now displayed in same way as other categories.
- Changed "Trade Bonus" modifier to "Overlord trade cost" and made it a negative modifier.
- Added "Stop" button to continuous focus detail screen.
- Added bypass button for focus if they have are mutually exclusive with another, automatically locking players in a branch.
- Moved the disband button, manpower and equipment numbers around for unit details view
- A bunch of tooltips readability improved. Various changes, typo fixed, decimal points changed, etc.
- added ability to toggle fog of war on/off 
- Changed efficiency tooltip growth to show daily values instead of weekly 


##################################
# Modding
##################################
- AI occupation policy is now scriptable, though no scripts for this has been added.
- The AI can now build any scripted building that is a part of an established building category.
- Purged unit_base, as it did nothing apart from making scripting harder. unit_ratio is now the end all and be all of unit production in the scripting, and setting it to anything but a positive value will make the AI NOT build it.
- Improved the code behind AI template design, so the scripting should make more sense now.
- Added ai_strategy type 'support' that can be used to manipulate a countries desire to send lend lease to another country
- Dynamic state, country and global flags effect. set_global_flag = test_flag_@ROOT.
- Added triggers for date days and value to flags.
- Added has_resources_amount trigger.
- Added trigger has_tech_bonus. Works with specific technology or category.
- Added can_join_factions rule.
- The AI is no longer quite as emotionally attached to modded ideas. Will now consider changing non-hardcoded ideas if the ai_will_do value is higher than the existing idea.
- Added has_country_leader trigger.
- Clearing script flags now removed them completely instead of setting value to zero.
- Added modify_global_flag modify_country_flag modify_state_flag effects.
- Tooltips for is_core_of and is_claimed_by now work with any_state triggers. Removed state name from tooltip. Country name now uses def version.
- Added an on action for on_annex. Fired from both effect and peaceconference.
- Console command: add_party_popularity <ideology group> <value> - ideology group has shortcuts d f n c for vanilla HOI groups.
- Console command: set_ruling_party <ideology group> - ideology group has shortcuts d f n c for vanilla HOI groups.
- Added timed script flags. Example: set_country_flag = { flag = GER_drunk_scientists days = 30 }.
- Added local_non_core_manpower state modifier.
- Added has_army_experience has_air_experience has_navy_experience triggers.
- Added trigger has_full_control_of_state.
- Added scope support as right side argument for is_subject_of and is_puppet_of.
- Added trigger to technology folders. Will hide tab and disable research for techs if trigger is not met.
- Added on_startup to onactions.
- Added count_triggers. Will return true if _amount_ of triggers in the scope is true. Same as calc_true_if on other projects.
- Added set_state_name effect.
- Added reset_state_name effect. Resets state name to original.
- Added trigger is_staging_coup.
- Added trigger has_focus_tree = <id>
- Added has_template_ai_majority_unit trigger that uses the new ai priority instead
- Production line efficiency gain is now capped at zero for negative values so modders can zero out efficiency gain if they want
- Added effects for setting and resetting province names for victory points (set_province_name = { id = <province id> name = <string> } and reset_province_name = <id> )
- Split up factory modifier into a new industrial_capacity_dockyard so dockyards get their own progression
- Split up MAX_FACTORIES_PER_LINE define by type to MAX_CIV_FACTORIES_PER_LINE, MAX_NAV_FACTORIES_PER_LINE, MAX_MIL_FACTORIES_PER_LINE allowing different factory counts for different kinds of production/construction lines
- Added new num_divisions trigger to check actual number of divisions regardless of strength etc
- pp console command can now take negative values
- ai_dump command now also lists all active strategies for a nation to help with debugging
- Added define to modify threat requirement for joining a faction when at war. JOIN_FACTION_LIMIT_CHANGE_AT_WAR.



##################################
# Database
##################################
- Missing portrait for Xhemal Aranitasi of Albania. Buffed to skill 2.
- Removed duplicate destroyers from GER OOB.
- Afghanistan now uses generic arab leader as country leader instead of asian continent fallback.
- Moved Brest Naval base to be in the Bay of Biscay instead of English Channel
- Moved rubber from Uganda to Stanleyville
- Moved naval base in Belgium to VP province
- Nudged and moved Naval bases for ITA based on beta feedback. Moved navies start position to relevant naval base.
- Replaced Mao with Zhang Guotao as communist leader of China.
- Nudged Reykjavik VP, unit pos and naval base.
- Added rubber to states in Africa. Equatorial Africa - 4 rubber | French West Africa - 2 rubber | Gabon - 1 rubber | Central Congo - 5 rubber | Angola - 1 rubber | Portuguese Guinea - 1 rubber | Liberia - 7 rubber | Uganda - 4 rubber | Nigeria - 3 rubber | Tanganyka - 2 rubber.
- Changed Cape Verde, the Azores, the Canary Islands, Bermuda, Jamaica, Cuba, Galapagos, Comora and Socotra from desert to mainly hills or plains.
- Removed naval base from 6749. 11707 naval base level 1=>2.
- Changed color for D02 civil war tag.
- Changed icons for generals and advisors for a lot of countries, to avoid duplicates where possible. New icons used are: "generic_army_asia_7", "generic_army_asia_6", "generic_army_asia_5",
"generic_army_asia_4", "generic_army_african_6",
"generic_army_african_5", "generic_army_african_4",
"generic_army_south_america_5", "generic_army_south_america_4", "generic_political_advisor_europe_6", "generic_political_advisor_europe_5", "generic_army_europe_6", "generic_army_europe_5", "generic_army_europe_4".
- Flavor names for transport planes
- some updates to German air oob, using historical variants
- Fixed an issue with localisation of event germany.118
- Added flavor names for Romanian and Yugoslavian trucks
- Added events to rename Stalingrad and Leningrad
- Fixed wrong naval prefix for HOL
- Changed Romanian starting politics to better represent historical reality
- Added Colorado-class Battleship variant to US starting OoB
- Some minor adjustments to ENG and GRE air oob in 1939
- Changed prefixes for Italian ships based on forum feedback (newly constructed ones only for the time being)
- Some minor adjustments to Romania 1939 air oob
- Added sanity checks to Italian "War with Greece focus" (Greece not a puppet, Italy not currently at war with Greece)
- Added name list for Indonesia, enabled Dutch namelist if puppet
- Changed ideology for Serbia in 1939 to make it consistent with 1936 (unless someone can prove that Serbians were significantly more fascist in 39 compared to 36) 
- Fixed wrong name for Dutch fascist demagogue
- Added a number of historical plane variants to starting OoBs, including foreign-bought planes for a number of countries
- Changed Yugoslavia starting OoB and technology 
- Fixed two cosmetic tags for Lithuania and Latvia
- Added a cosmetic tag for Czechoslovakia if Slovakia also exists (i.e. Czechoslovakia is really only the Czech republic)
- Changed name for state 457 from Arabian Desert to Eastern Desert to better reflect reality
- Added cosmetic tag to Franco-British Union event
- Fixed a minor issue with a Japanese cruiser being the wrong class
- Added news event for Chinese United Front forming
- Some adjustments to Hungarian flavor names based on beta feedback
- Fixed two cosmetic tags for puppeted Poland (Poland now actually quite lost)
- Fixed issue with duplicate generic design companies for TfV countries
- Removed a General that somehow got copied over from Ethiopia to a number of other countries
- Removed a lot of cores from countries with overseas territory.
- Added shipnames for Malaysia
- Gave advisor Franco his proper portrait
- Changed name for puppet level SOV puppets after forum feedback
- Restored name changes for fascist France, using Vichy France for the German puppet state
- Changed some focuses in SOV tree. SOV will now no longer pick anti-capitalist or anti-fascist propaganda if they are democratic or fascist. The relationship penalty will also only apply to the major powers if they are not communist 
- added two more on actions to add the Czech-only cosmetic tag
- Changed autogenerated portraits for Middle Eastern countries.
- Added artillery to ENG starting templates in 1936/39 
- Added 5 convoys to Manchukuo
- Added armored division template to Hungary and Sweden
- fixed an issue with a portrait missing for TfV owners
- fixed an issue with the portrait of a Canadian admiral
- fixed a misstranslation in German localization (implied that you saved XP when creating a variant)

##################################
# Balance
##################################
- Heavy tanks gain 10% attack bonus vs forts
- Heavy TD gain 5% attack bonus vs forts
- Super heavy td get 30% bonus vs forts (compare 50% for SH)
- Added bonus to dockyard output to difficulty sliders (20%)
- Maintenance company can no longer bring bonus so high that equipment becomes invulnerable (total bonus went from +40% to +20%)
- Concentrated and Dispersed industry techs now give same bonus to dockyard output (+10%) 
- Super heavy TD's now match combat width of other TDs
- lvl 1 light TD now has same speed as lvl 1 light tank
- Added Soviet version of honoring the MR pact. From this version on it will suck to be Poland.
- Germany and Soviet will no longer hand out Polish territory if owned by player Poland in their faction. Poland is now playable again.
- Spread out repair speed over construction tech. All construction tech now give production_speed_buildings_factor = 0.10 industry_repair_factor = 0.10
- India focus tree: Naval Funding now unlocks Light Cruiser 2 tech if you don't have it completed. Added tooltip to explain the effect.
- Wargoal justification now adds extra threat depending on the industrial capacity of the target country.
- Added PP cost and time scaling to justifying wargoal. More justifications and wars => higher costs
- Changed naval production continuous focus to increase dockyard output by 20% instead of reducing prices by 20% (which was exploitable)
- Blocked ideology pushers (fascist demagogue etc.) based on completed focuses for SAF, CAN and NZL (to bring them in line with AST and RAJ)
- Moved Japanese cruiser Takao back to its original position after beta feedback. Another critical gameplay issue successfully resolved
- Changed one of the Sinkiang Captains of Industry to War Industrialist. Sinkiang now confirmed OP
- Now factories receive penalty for each next lacking resource across multiple lines rather than max out at 80% by line
- Infrastructure now adds construction speed to the buildings with shared slots
- Change: Total Mobilization economy law now has a 20% WT limit.
- Change: Increased Air Attack for Advanced Fighters to 32 and Improved Jet Fighters to 40.
- Change: Production techs have been rebalanced.
- Each level in the Production track now gives 10% Production Efficiency Cap.
- Flexible Line's bonus to Production Efficiency Retention has been reduced to 20%.
- Concentrated Industry now give 15% Factory Output bonus per level.
- Change: Production Efficiency Growth has been changed from being linear to slowing down as a line reaches max efficiency.
- Change: Defensive values for Medium Self-Propelled Artillery has been changed to be in-line with other Self-Propelled Artillery.
- Change: Changing a production line to a vehicle in the same family (Pz III to StuG III) now retains 70% of the production efficiency. Changing a production line from one vehicle model to another (Pz III to Pz IV) now retains 30% production efficiency.
- Change: Infantry equipment build costs changed to 0.4, 0.5, 0.6 and 0.7 IC respectively.
- Change: Soft attack values for artillery has been nerfed across the board.
- Artillery battalions has had their soft attack values reduced by 20%
- Rocket artillery soft attack has been reduced to 40 and 55
- Medium SP Artillery has had its soft attack values reduced to 56, 72 and 84
- Change: Medium and Light SP Artillery battalions changed to 36 vehicles each. Heavy SP Artillery changed to 24 vehicles each. Superheavy SP Artillery changed to 12 vehicles.
- World Tension from national focuses have been increased.
- Lowered world tension generation by about 50% for many actions.
- The national focus Italian Highways now provide one infrastructure per state instead of two.
- The national focus Metropolitan France now provides two infrastructure per state instead of three.
- The national focus Improve Railway Network for Soviet Union now gives higher priority to high population states.
- Soviet national spirit Home of the Revolution no longer reduces construction speed.
- Kiev, Kharkov, Stalingrad, Kazan, Perm, Chelyabinsk and Sverdlovsk have received 2 more infrastructure level to compensate for the infrastructure changes. Saratov, Magnitogorsk, Ufa, Zlatoust and Moscow have also received 1 more infrastructure level.
- Improved infrastructure for Japan. Kanto, Tokai and Kansai have had their infrastructure increased by 2. Chugoku and Kyushu have had their infrastructure increased by 1.
- increased infra NFs for south africa by one level
- increased infra NFs for india by one level
- Australian standard gauge railway focus should now avoid wastelands when placing infra
- Japan's infrastructure effort focus no longer places infra in invalid spots 
-Added 1 extra infrastructure from generic focus tree infrastructure_effort and infrastructure_effort_2. Now gives +1 and +2 up from +1 +1.
- lowered price of synth refinery by 30% and increased its resource output by 40%
- The technology Streamlined Industry now provides 10% Production Efficiency Growth instead of 25%
- Reduced tension impact for soviets claims on baltic nations and justifying wargoals for legit claims

##################################
# Bugfix
##################################
- It’s now possible to directly declare war on subjects
- No longer get invalid "overseas" penalty to disbanding troops when enemy has taken some lucky provinces in your capital
- For Naval Superiority air superiority now works as a multiplier to your naval force rather than side by side. So you can’t get naval superiority through only a giant pile of planes anymore
- Fixed an issue where in civil wars the dynamic tag side would end up with no manpower in their divisions and get them disbanded
- Fixed an issue in civil war start where deployment lines did not transfer over manpower properly  when balancing those between revolter and original
- Communist/Fascist minors are no longer tied to neutral tree in historical play.
- Reenabling elections for democratic nations when a civil war ends
- Changed Munich conference events to account for Little Entente. If Britain decides to support CZE while the Little Entente is active, the British commonwealth joins the Entente
- Fixed German puppets being allowed to refuse Anti-Comintern Pact and Anti-Soviet Pact
- Changed the "Test the Chinese" focus for Japan to bypass if the borderlands are not held by CHI, PRC or SHX 
- Added additional checks to Japanese "Pressure Siam" focus to check if Siam is actually in any position to be pressured (not a puppet, not a government in exile)
- "improve national spirit" focus for Japan now continues if conditions are no longer met
- Repaired paradrop order
- Fixed GetNameDef not using cosmetic tag names.
- Country colors now update immediately when changing cosmetic tags.
- Changed UK NF for Turkey to take UK ideology into account.
- Engineer company tech now shows gain as +2.0 instead of +200%.
- Nationalist china can no kill itself slowly by picking the internationalism focus.
- Missing loc. Wrong modifiers. Wrong news event. Weird event pic. Wrong loc for options, etc etc for a german focus.
- Oster Conspiracy now only happens if a leader called "Adolf Hitler" is in charge of Germany.
- Added name to GER-SOV research treaty.
- News events stating that SOV or GER has taken control of east/west Poland now requires them to at least control a bit of it.
- Added choice for player INS to pick side when AST starts a civil war.
- Added ai modifiers for demand NZ event. NZL will have a chance to accept in certain situations.
- Added function to normalize party popularity if drift is only negative.
- Moved naval base in Sundra Islands state to a less interesting location.
- Our words are backed achievement is now valid even when India goes free later.
- Fixed NZL historical list pointing to ENG
- Added localization to original_research_slots trigger.
- Japan now creates own faction and adds New Zealand to it for befriend Japan focus.
- Fixed missing leader portraits for Libya
- Added check for PRC control of state where they are given troops in Chinese civil war.
- Tizard mission no longer available if ENG and USA has different ideologies or one of them no longer exists.
- Around Maginot will now bypass if none of the targeted countries exist.
- Blocked restarting Chinese civil war if CHI or PRC are puppets.
- France now becomes Free France if Vichy is created from the event.
- Fix for some germanmarchorder songs requiring germany to have completely given up before having high chance of playing.
- Fixed critical spelling error in name of "Philipines Division"
- Fixed an issue where Stanley Baldwin would return to British politics in 1940 if player starts in 39
- Fixed description of MAN (the idea, not the country)
- Added a check for the Japanese "strike the USA" focus to check if Japan is in faction with USA (it would be silly otherwise)
- Fixed a problem with the Stanley Baldwin resigns event that could lead to non-Baldwin leaders getting fired.
- Removed an unnecessary ai_weight modifier in event Germany.5
- Fixed an issue where France forming the Little entente before Germany remilitarized the Rhineland could lead to France getting removed from its own faction
- The "Southern Expansion" Focus for Japan will now bypass if Japan is allied with Britain and the Netherlands. When allied with only one of them, Japan will still gain a wargoal on the other
- Changed French challenge the Rhineland event to spawn a civil war even if France is communist (the democrats won't allow the communists to drag the country into another useless war!)
- Fixed communist on communist violence if communist France challenges the Rhineland (for real this time)
- Fixed text overflow in Canadian patriation news event
- Fixed a number of spelling errors in Italian shipname list
- Changed achievement "Once more mate" to point to correct state
- Fixed an issue where event usa.24 checks whether ENG is at war with itself (now checks if at war with US)
- Fix for fascist Indonesia not changing its flag when taken as a puppet from HOL in a war 
- Fixed an unlocalized string in the South African focus tree
- Fixed a spelling error in Italian general's name
- Fixed Afghanistan using wrong 2d culture and incorrect picture for starting General
- Fixed air production continuous focus not affecting CAS and Jet strategic bombers
- Fixed an issue where Germany would take the Alliance with Spain NF focus even if Spain is already in a faction with Germany
- Fixed missing bypasses for war with Germany/England in Soviet tree
- Fixed an issue where swapping Slovakia for Danzig followed by the Soviet union attacking Poland after the MR-Pact would not transfer parts of Slovakia to Germany when the war ended, leading to very ugly borders
- Fixed lack of portrait for MZB leader
- Fixed a number of text overruns in flavor descriptions of British cruisers
- Fixed a number of typos in event germany.97
- Fixed Guanxi ideology pushers lacking portraits
- Fixed an issue with event news.37 sometimes showing two options
- Added cosmetic tag to Canada to give them their historic flag when not playing with TfV (as long as they stay in the Allies)
- Fixed an issue with missing text in event news.287
- Fixed an issue where "a deal with japan" would kick Australia out of any faction when it should only kick them out of the Allies
- Fixed missing localization for air_equipment
- Changed "Woo the US" focus in AST tree to require USA to not be a puppet, which should help to remove an edge case where US could gain full independence again by joining a faction with AST
- Fixed a number of typos in the RAJ focus tree
- Fixed issue with Australia demanding New Zealand causing Australia to be kicked out of any faction it is currently in
- Fixed typo in Australian event tfv_australia.90
- Fixed critical issue with portrait path for Chilean general
- Fixed a number of missing event pictures for Canada and South Africa
- Fixed an issue where puppeting SHX as Japan before starting the war would backfire later
- Added cap on world threat
- Now nukes can be build by reactors on controlled territory
- Fixed the bug when sometime combat width during the combat could be overstepped
- Removed naval leader xp gaining for spotting while peacetime
- Fixed airwing alert not opening airbase while being clicked
- Fix for removed rocket sites not disappearing
- Removed the ability to delete rocket wings
- Fix for cosmetic tag not being cleared on resign
- Fix for volunteer forces able to perform invasion without actual proper naval superiority
- Fixed the bug when civil war split distribution depended on the amount of military deployments
- Fix for the negative population growth
- Fixed the bug when one country could start staging a coup against second country if any other country already was staging a coup
- Fixing clearing the trade in case of lost dependency
- Icons now ignore clicks while drawing battleplans
- Fixed the bug not being able to assign to the fallback line
- Removing templates now unavailable for your last true template
- Now can declare war on puppet
- Submarines now become harder to detect as their tech level increases, not easier.
- Unit movement arrows now looks good (smooth) again.
- Mil to Civ factory conversion now properly removes the military factory. Also the "instantconstruction" cheats converts properly too.
- Blitz command - The "order of conquering the enemy provinces" is now properly updated when the command is reshaped by human player.
- Naval invasion arrow is now exactly the same as the route the units goes.
- No longer possible to overwrite the country tag in ironman, by reloading the game from ingame as another country.
- Deployment is now allowed in locations where it supposed to, regardless if your capital state is not owned by you. (Solves issues that may popup in the civil wars).
- Now units can't stuck in the middle of the sea while naval transfering due to the lack of convoys
- Fixed the bug when on annexation expeditionary forces were returned after annexation and units of annexed country stayed on the map
- Nations in defensive wars can now be invited to factions at 50% tension (or lower if their own rules allow) as an effect of world tension now stickign around at lower totals longer
- Fixed an issue where threat could not be reduced
- Now units can't stuck in the middle of the sea while naval transfering due to the lack of convoys

###############################
# Stability & Performance
###############################
- Fix for CTD while quitting to menu
- Improved the performance quite a lot. The most dramatic "spikes" where the game froze every 24th hour, was improved by a few hundreds %. And the overall performance got about 14-18% improvement.
- Now anyone can profile the ingame performance with using a "game-state-timer" command "gstimer on" and "gstimer off"
- Fixed CTD when production efficiency hits 0 (if no factories assigned to a line and being tooltiped)
- Fixed CTD when deleting all airwings then clicking unused planes alert when you had deployed carriers
- Fixed random CTD
- Fixed CTD when removing templates with game set to human_ai for observed nation
- Fix for a rare CTD in civil wars
- Fixed another potential CTD
- fixed a CTD when resigning from multiplayer lobby while using OpenGL on some drivers


################################################################
###########           Hotfix 1.3.2 "Torch"           ###########
################################################################
- Fixed CTD when doubleclicking the first factory in a line superduperfast to reset factories [AR-12518]
- AI now much better at respecting airbase size limits
- Improved AI management of air missions
- Deployment is now allowed in locations where it supposed to, regardless if your capital state is not owned by you.
- Fixed huge slow down and eternal freeze in the peace conference.
- Lowered air combat delay so that some areas will still see combat even though caught in extreme time zones.
- Crusader Kings 2 achivement now requires state 126 instead of 129
- Rebalanced air combat for increased air casualties
- Air accidents should no longer happen in peace time
- Added CTD safety for voice over playing in case player has some broken sound drivers
- Fixed potential CTD in clearing country resources on civil war starts
- Fixed a manpower transfer issue causing units to dissapear after peaceful annexation (like the Anchluss)
- Fixed issue with Australia demanding New Zealand causing Australia to be kicked out of any faction it is currently in
- Fixed two typos in Indian focus tree/ideas
- Tech tree now refresh after switching tag (when chosing to play as new puppet)
- Transfer ship effect (like in NZL focuses) no longer sometimes transfers wrong ships (or whole fleets :D)
- French language translation fixes.
- Fix for Crusader Kings 2 achievement. Flags are now set from events granting them immediate freedom.
- Added script flags for Crusader Kings 2 achievement if SAF chooses to puppet nations.
- Mil to Civ factory conversion now properly removes the military factory.
- Japan now creates own faction and adds New Zealand to it for befriend Japan focus.
- Changed trigger for Befriend Japan to require same ideology.
- Only create wargoal on AST if ideology differs.
- Fixed has_goverment trigger doing the opposite of what it was supposed to.
- JAP will only create faction if not already in a faction.
- AST will join JAP if JAP already leader of faction. AST cannot befriend JAP if JAP is in another faction.



################################################################
###########           Hotfix 1.3.1 "Torch"           ###########
################################################################
- Fixed some bugs restricting AI from template updates
- Improved some target templates for AI
- Reduced AI tendency to suicide attack into enemy lines
- Fixed a problem in AI where front priorities would sometimes fluctuate wildly leading to a lot of front flip-flopping
- AI now considers distance a bit more so wont pull most of its army vs ethiopia back early on
- AI for observed country is no longer blocked from diplo responding when using human_ai
- Improved AIs ability to prepare against enemies that they only have an ally sharing border with
- Spearhead order no longer so concerned about protecting its flanks
- When a Spearhed front is split, all units stay on the front that has the spearhed order attached to it
- Garrison order should now be more stable and not reassign units quite as much on changing priorities
- Allied AI now more hesitant to naval invade Germany and italy early on
- Fixed some event picture issues
- Made the focus "Burn the royal portraits" available if South Africa has already broken free
- Fixed some setup issues with NZL tech setup in 1939
- added cosmetic tag for Soviet-controlled Finland
- changed national focus to Test the USSR for Japan to account for Manchukuo existing
- Fixed a CTD in peace conferences
- Fixed an issue with map stripe coloring not updating in peace conferences
- Fixed some issues with credits
- Shortcut for spearhead order is now Shift+X rather than B which was conflicting with strategic redeployment
- Launcher - Added a button (and a checkbox in crash report window), that offers to backup and delete all files that can potentially cause the stability problems.
- A fix for a trade modifier not applied correctly if not bought the DLC.
- Fix for RAJ Famine
- Fix for Mexico Civil War inconsistencies
- Fix for missing SAF factories
- Fix for missing INS convoys causing issues with trade/resource system
- Fix for missing event in CAN focus tree
- Fix for RAJ being able to pick ideology pushers without picking a path
- Fix for South Africa releasing African countries as not communist in the anti-colonialist crusade
- Fixed modifier capped 0-1, so you could never lower tension for sending volunteers for a country. 
- Fixed script that used values outside the intended range
- Added port to Lesser Sundra Islands.


################################################################
############           VERSION 1.3 "Torch"           ###########
################################################################

#######################################################
# Together For Victory Expansion
#######################################################
- New focus trees, generals, and ministers for Canada, Australia, New Zealand, South Africa and India including alternate history paths.
- 19 New 3d models for commonwealth infantry, planes and equipment as well as accompanying 2d art
- New Autonomy system where a nations autonomy can move between Annexed, Integrated puppet, Puppet, Colony, Dominion or Free with different effects.
- Masters can recruit subject forces
- Masters can build in subject territory
- Continuous National Focuses are new focuses that give running bonuses (basic ones included in patch)
- A Land Battle Log giving you history and statistics of combats for a theater (basic history list included in patch)
- A new Spearhead batteplan command where units will aggressively take only marked provinces (great for encirclements using BP tool)
- Ability to request lend lease from other nations
- A technology sharing system where members of the commonwealth or factions can benefit from each others technological advances
- You can now release a nation as puppet and decide to continue playing as it
- 3 new commonwealth themed music tracks by composer Andreas Waldetoft
- Voice over sound for infantry units in: German, French, Italian, British english, American english, Spanish, Russian, Mandarin, Japanese, Danish, Finnish, Norwegian and Swedish languages.


###############################
# Free Features & Important
###############################
- Theaters now indicate number of attacking and defending combats with color for status
- Can now configure garrison order for what to guard.
- Can now edit existing lend lease details
- Added cosmetic tags for european states that are puppets of Germany
- Added cosmetic tags for east-european states that are puppets of the Soviet Union
- Added cosmetic tags for a number of British colonies (including a former one)
- Added a new type of equipment design company (support units)
- Added Manchukuo to the game. May God have mercy on us all (also a bunch of other nations!).
- Added achievement viewer
- Added a music player
- Added outdated equipment alert
- Added outdated and new production indicators for production view
- Added several new generals
- Enable player to call subjects to war even if the player isn't war leader
- Buildings can now increase in cost for each level. Forts and naval forts now ramp up in cost the higher the level
- Interesting countries screen can show more interesting countries with special national focus trees
- Air attack (from AA battalions) now counteract enemy air superiority effects in combat and for movement 
- Warscore system now uses combats instead of just taking provinces (these give a lot less) to reward nations
- Added 12 new achievements

##################################
# AI
##################################
- Tweaked up base AI research factor for mechanized and lowered top lvl infantry weapons a little
- Moved Weserubung focus to be taken earlier in historical ai focuses mode
- Prevented ai from researching technologies more than one year ahead of time
- AI now takes research bonuses into account for picking techs
- Fixed casting errors in AI that could make it assign troups to a non-optimal front, and also cause overflows leading to random madness
- AI no longer ONLY saves all its nukes for punishing the enemy taking their own cities
- Improved AIs ability to adhere to supply limits.
- AI now attempts to recover when units are unable to reach desired front location.
- AI now attempts to detect and react to many encirclement opportunities, both against itself and against enemies. Includes evacuating dangerous areas and cutting off bottlenecks.
- Tweaked prio for what AI considers "weak enemy" to avoid attracting too many units.
- Added contininent prioritization for the AI with high scores to Europe and the Pacific, but low to Africa.
- Fixed bug where AI would keep swapping a fighter with land equipment at the top of the list for all eternity
- Various fixes and tweaks to AI naval invasions.
- AI should now be capable of using rockets.
- AI sets up a couple of fleets to be used for special missions.
- Tweaked AI research desires.
- Tons of AI front balancing work. AI randomly abandoning fronts should no longer happen, among many other things.
- Removed block from AI preventing it from adding more support than columns of regiments.
- Various bugfixes and improvements to AI template design.
- Made AI capable of making % of production LL and should increase their production accordingly
- Made AI threat assessment properly include faction members of countries they are about to enter war with
- Made sure that AI does not completely block itself when having multiple invasion orders against the same area but being unable to cover the regions for all of them at the same time
- Made AI better at supporting naval invasions by focusing on the next one to complete preparation.
- Tweaked naval invasion priority to make them more inclined to take islands (particularly with air bases) and home region
- AI no longer ends up in strange state where they are assigned to a root order but not a following attack order.
- Split up AI garrison order in two: home area and other areas.
- AI is no longer using all types of garrison locations
- Made AI invasions scriptably more unpredictable.
- Made sure that a factor of 0 in tech script blocks research, and that it can not randomly get a negative score when picking tech.
- Fixed strange bug in AI order assignment that left units assigned to a group but not an order.
- Scary fix makes AI actually consider all target areas of enemy, in stead of one at a time. Should set pacific area ablaze when the time comes, and keep the invasions rolling.
- Made sure AI is capable of calling subjects into wars even if they are not in a faction.
- Fixed crazy random bug in AI that could randomly reassign units to one front before recovering over the next few days
- Tweaked crazy production AI that lead to air fields in very bad places waaaaay too early
- Fixed problem that caused garrison order to not garrison forts even when it was selected
- Made sure that coastal defense garrison order prioritizes ports over empty coast if not enough units to cover entire coast
- Made sure AI no longer ends up switching between mutually exclusive techs even when halfway through.
- AI no longer spams trucks like they were some kind of war winning superweapon.
- AI countries now will always call subjects who cannot decline into war.
- Fixed AI leaving military factories unassigned.
- Improved AIs capability of determining if ready for war as well as AIs ability to ask again.
- Made AI able to remove regiments in template design under certain circumstances.
- Made absolutely sure that the AI uses military factories, even if it does not want to build more air planes.
- Rebalanced AI desire to produce infantry equipment.
- AI does not trust countries in other factions even if they have a NAP with them.
- Unitcontroller does not consider provinces empty when a division is fighting its way out of it. Should reduce front shuffling.
- Stabilized AI invasion prio scores. Should result in invasions not swapping units around as much and randomly getting canceled.
- Blocked the AI from swapping the last support battalion int template design over and over.
- Added AI strategy to tweak desire for modifying templates.
- Fixed overflow that cause some countries to not build planes causing USA to end up with 0 strategic bombers.
- Made sure released AI countries don't get stuck building nothing.
- added a naval base in northern China to try and encourage Japan to engage in China
- adjusted ai weights for Germany to allow non-historical Germany to actually decide to go with China instead of Japan
- adjusted Soviet historical focus list slightly to account for focus requirements
- Germany will no longer try and befriend Japan if Japan is already in faction with them. Germany doesn't l-like Japan or anything!
- Garrison orders logic was significantly improved
- China no longer accepts puppeting with historical focuses on unless Japan is comically strong. China accepting now also adds World Tension
- Added system of scripable ai areas for ai prioritization
- Fixed bug in unit controller that would lead to provinces not getting any units.
- improved italy's minister picking AI
- increased priority on some early industry techs for AI
- Fixed a problem with naval invasions getting destroyed upon execution for AI
- Fixed an issue with AI's old templates becoming honeypots for updates
- Improved German production AI strategy
- Marked equipment as correct type for AI to avoid it getingt caught in truck vortex
- Tweaked german idea selection for chief of air force
- Fixed bug where ai strategy for template upgrades would pick wrong target
- Tweaked japan starting strategies for divisions, less trucks for the truck throne
- Tweaked japan target infantry template to try and keep their costly madness down
- Tweaked chinese tech ai
- Tweaked minsiter selection ai for japan
- Tweaked minsiter selection ai for germany
- Tweaked minsiter selection ai for france
- Tweaked trait evaluations for AI
- Fixed issue where AI always thought negative modifiers were bad, even when they were good (bad ai! no I mean good ai!)
- AI is now blocked from putting CAS on naval bombing missions. Should help GER and JAP
- Japan will no longer approach Germany for an alliance if Germany is not leader of a faction
- AI should no longer be able to cancel unit movement that is retreating.
- Further improvement to unit balancing between fronts
- AI should no longer leave civilian factories unassigned


##################################
# UI
##################################
- Focus trees now remember their position when closed. Resets when looking at other trees
- Diplomacy window 'sort by our opinion' now handles reverse sort
- Proper highlighting of 'add new command group' button
- Fixed overflow on long nation names in trade
- Subject view, manage occupation and idea subwindows in politics view are now mutually exclusive and wont stack on top of each other
- Added new icon to division modifiers in combat to highlight AA support 
- Setting up lend lease no longer says convoys are needed always even when they arent 
- Trade interface no longer incorrectly states that you need convoys when you dont 
- Amount of convoys indicated in trade interface now takes ones actually already used on route into account when displaying deficiencies 
- strait mapicons no longer eat dragboxes and zooming
- added cool canadian motto to loading tips
- Fixed war view so ally does not wrongly show up in both member and uncalled sections.
- Now dangerous naval invasion alert disappears correctly when enemy invasion fails
- Dangerous naval invasion alert now disappears in max a month after success instead of next hour
- Added In the Field and In Training to Manpower tooltip in top-bar.
- Changed some equipment names. Fixed a lot of typos.
- Added glorious manchuria leader Henry Pu Yi for benefit of all
- Map icons don't merge naval and land ones now, yay
- Added flags for ANG BOT COG MZB KEN and ZIM
- Added mr Orde Wingate, FOR TEH ORDE
- Added 4 new indian generic leader portraits
- Added 4 new african generic leader portraits
- Around 60 new focus icons added
- Around 34 new national spirit icons added
- Added 108 new report and news event pics
- Added training indicator for armies in theater list
- Added custom backgrounds and glow to show new and out of date items in production view
- Made selected unit and wings sexier and easier to see (thanks Roflbinflood)
- 'Received' and 'Given' military access relations are displayed with different icons in diplomacy view
- Always pause for peace conferences in mp when a human player is involved
- Longer range now supported for "mutually exclusive" national focus indicator
- Resources now always shown in peace conferences
- Option slider for setting volume of ingame voices
- Clarified tooltips for breakthrough for attacks in combat view
- Improved tooltip for "dismantle faction" button
- Fixed misleading tooltip for naval invasion order
- added DEF names for cosmetic tags ("The <country>")
- Fix for missing generic military theorist pictures in country technology view 
- Fixed localization issue with Jet tactical bombers
- Fixed a number of legibility issues with certain events and country names
- Fixed soviet motorized equipment being invisible when in production
- Fixed an issue where unique motorized icons were not showing in production menu
- Fixed a proper endline to collapsing deploy entries
- Fixed bug that prevented AI from rebasing its airwings
- Fixed a display bug in news.228 event
- Added tooltip to show total manpower of selected divisions in division list
- Map colors and stripes are now properly refreshed in the building constructions view.
- Fix for incorrect party popularity value in 'Stage a coup' dialog

##################################
# Modding
##################################
- Added num_tech_sharing_groups trigger to count active tech groups for a nation
- Focus.AutoComplete now no longer closes focus screen or does a popup
- added num_subjects > x trigger
- "-hands_off" start flag now set max speed automatically unless another speed is set on command line (enjoy fire and forget go home support)
- Changed the modifier send_volunteer_size to add to volunteer cap. 
- Added send_volunteer_factor to modify current allowed divisions.
- Attrition from heat and extreme heat in provinces is now separate and called heat_attrition.
- Added new graphical culture commonwealth_2d.
- Added if-else trigger. Syntax: if = { limit = {<condition for trigger_a>} <trigger_a> else = {<trigger_b>} }
- Added else to if effect. Syntax: if = { limit = {<condition for effect_a>} <effect_a> else = {<effect_b>} }
- Made add_building_construction effect able to take some really special ugly input, that makes it easier to place province building. Use at your own peril.
- Added modifiers cost of military leaders. military_leader_cost_factor, army_leader_cost_factor and navy_leader_cost_factor.
- Added possibility to set unit cap on field marshalls.
- Added new way of naming countries. <TAG>_ideology_<autonomylevel> <TAG>_ideology_subject <TAG>_<autonomylevel><TAG>_subject. Can use OVERLORDNAMEDEF and OVERLORDADJ to insert name/adj of overlord in own name. <TAG>_<OVERLORD TAG>_ideolog.. etc etc.
- Added add_ideas command to console
- Added on_release_as_puppet on_release_as_free triggered from the manage occupied territories menu
- Added 'set_cosmetic_tag' effect wich allows to dynamically change country's appearance: name, flag, map color, names & portraits pool
- Added 'on_subject_annexed', 'on_subject_autonomy_level_change' and 'on_subject_free' onaction events
- Added 'add_to_tech_sharing_group', 'remove_from_tech_sharing_group' effects
- Fixed CTD for reloadtechnologies command
- It's now possible to script a message for the white_peace effect
- Fixed bug that made it possible to really break AI production through script
- Fixed diplomatic on_action scope set wrong
- Added swap_ideas effect that will show the difference between bonuses of the two ideas. Syntax: swap_ideas = { remove_idea = <idea> add_idea = <idea> }

##################################
# Database
##################################
- Maintenance Company tech no longer belongs to armor company, which caused AI to waste tech bonus on it
- added lvl 1 port to Labrador so that supply works there if canada/UK goes to war 
- Maracaibo now has correct name
- Added Stanley Baldwin (thanks to EmperorTojo for base artwork!)
- fixed bug in Italy National Focus tree (Capital ships focus now actually gives the naval XP it promises)
- Japan can no longer create the Indian National Army if Raj is fascist or Japan is not at war with them
- Japanese Battleship name "Yamato" no longer used for first battleship Japan builds, reserving it for future battleships (including super- and space-battleships)
- Changed names for some political parties to be more accurate
- Newsevent for “Eastern Poland to the Soviets” no longer shows two options if Soviet and Germany in same faction (there is a reason it is called “unholy”, guys)
- added localisation for mountaineers_tech, cat_trade_interdiction and cat_battlefield_support
- All ground forces in the Dutch East Indies are now under control of (colonial puppet) Indonesia. This should reduce the amount of Dutch units in Europe while keeping the balance of forces in the DEI roughly as it was before.
- Added Pakistan as a releasable country
- Added Angola, Botswana, Congo, Kenya, Mozambique and Zimbabwe/Rhodesia as releasable countries
- added several hundred flavor names for equipment to a number of countries
- Added British Malaya as a puppet of UK.
- Added heat_attrition and heat_attrition_factor modifiers for both country and unit leaders.
- Added Belarus as releasable country
- One Australian land province is not wrongly marked as coastal anymore 
- Added Windhoek as VP to South-West Africa state
- Added two additional flavor names for Japanese tanks
- Restored Port Arthur to its proper historical significance, a decision that was not in any way related to AI performance and any such allegations are lies
- Added tech sharing for Tizard mission events (if you have TFV)
- USA no longer eligible for generic election events before 1948
- Fixed a number of inconsistencies and errors in the French and German naval OoB for 36 and 39 starts
- Fixed an issue where de Gaulle could be replaced as a leader of Free France for no good reason
- Added colonial governor as official leader for Malaysia and Indonesia (retire on breaking free)
- Added Yemeni merchant marine (5 whole convoys!)
- Added a number of cosmetic tags for certain constellations of puppets
- Added Italian generals Emilio De Bono, Italo Balbo and Radolfo Graziani. Added French generals Charles Huntzinger, Henri Giraud and Philippe Leclerc (Thanks to Sleight of Hand for this and other things ported from the Vanilla+ mod!)
- Added cosmetic flags for German dominated UKR and BLR
- British colonies now always use British equipment names and pictures if no unique ones exist

##################################
# Balance
##################################
- Increasing custom difficulty levels now also lower attrition units takes from that nation
- Moved mechanized tech levels down one year, so first is unlockable in 1940
- Increased hardness to 80% for light tanks from 70%
- Increased hardness to 50% for light tank variants from 40%
- Increased hardness to 90% for medium tanks from 80%
- Increased hardness to 65% for medium tank variants from 55%
- Increased hardness to 95% for heavy tanks from 90%
- Increased hardness to 80% for heavy tank variants from 70%
- Increased hardness to 99% for super heavy tanks from 95%
- Increased hardness to 90% for super heavy tank variants from 80%
- Added +10% hardness to motorized from first level mechanized tech 
- Bomber and CAS aces now use better bonus modifiers for attacking
- CAS attacks now scale properly with active planes rather than whole wing when looking at ace bonuses
- Added hard-cap for nations to become majors, 35 factories are needed. (should avoid wars dragging out into whack-a-mole-the-new-major as you blob)
- Reduced air superiority boost for offensive formations (doctrine) from 25% to 15% 
- Reduced air superiority boost for logistical bombing (doctrine) from 25% to 15% 
- Added air superiority boost for combat unit destruction (doctrine) at 10% 
- Reduce base free repair from 0.5 IC to 0.3 IC 
- Reduced agility of Naval bombers to 30-35-40
- Reduced agility of Close Air Support planes to 35-39-44
- Reduced air attack of Close Air Support planes to 6-10-14
- Reduced air attack of Naval bombers to 6-10-14
- Brought carrier plane agility in line with land based versions
- Carriers can no longer reinforce with fresh planes while in combat 
- Added a small amount of threat to more imperialist parts of US foreign policy focus tree branch
- Nerfed Raj tech level at start
- Reduced chinese civilian start ic by 1
- Nerfed French starting armor equipment in 1936 into the *bleep* ground
- Germany no longer allowed to pull Turkey into their faction after they have capitulated. No fun allowed.
- Warscore system now uses combats instead of just taking provinces (these give a lot less) to reward nations
- Air attack (from AA battalions) now counteract enemy air superiority effects in combat and for movement 

##################################
# Bugfix
##################################
- Fixed issue where some rocket sites would not show up on map
- Fixed issue where small damage to aircraft would be ignored
- Fixed issue where a command group icon was sometimes not selectable
- Fixed issue where CAS ace would actually have a detrimental effect to damage done in land combat
- Can no longer use console after resynch in MP 
- Nukes now impact owners national unity, not controller 
- Fixed wierd scaling issue with main menu bg
- Fixed manpower not being returned from fleets
- Fixed the issue when relations could be transferred wrong in civil war
- Now lend lease has the highest priority in equipment distribution
- Added cap for the factories going negative in multiplayer after very fast clicking
- Now units that doesn't have supply path to the capital will count as encircled while disbanding them
- Fixed the issue when division view was not showing air attack
- Added fallback if ship names were not properly scripted in the database
- Fixed the bug when player could call to arms country which was already at war in the war overview
- US focus Defense of the Pacific is no longer blocked by Japan having the same ideology as Japan.
- Stopped Japanese cloning program (Removed one of the Matsuis ).
- Added category tags for some technologies. engineers_tech recon_tech mountaineers_tech military_police_tech  hospital_tech logistics_tech signal_company_tech maintenance_company_tech.
- Removed highest level artillery high command for most releasable nations. Replaced with lowest.
- Fixed civil wars not spawning if revolter only has 1 state.
- Winter_attrition now does more than nothing for unit leaders.
- Save games now store enabled DLC bitmask which is checked. UI doesn't allow to load save game if some of DLCs are missed.
- Map mode is no longer switched for secondary coop player if host player assigns/un-assigns naval mission
- Releasable countries list is now correctly refreshed after player releases any country
- Countries aren't displayed as if they capitulated twice in world tension log
- Fixed issues where exp.forces could stay in wrong countries after a peace conference.
- More small air wings is no longer better than less large air wings.
- Air Accidents now happens equally fair regardless of how many different air wings you have.
- Fixed corrupted theatres and fronts after the peace deal.
- Fixed issues in unit naval transportation mechanics causing sometimes a unit to not leave it's port, and AI could not do anything about it.
- Minor fixes in the supply systems - There is no longer created an invisible naval route from the capital state to itself. (No player could spot it. We found it while debugging the code).
- Battleplans "estimated execution" province stripes are now correct when the source and destination are both 1 province long.
- Fixed exploit where a player could avoid loosing most of the equipment in combat by doing save and reload right before the combat was over.
- Nukes are doing now the real damage to the units, by reducing the manpower and equipment, not just str/org bars!
- Player can no longer trade with factories gained from other trades. Tooltips was saying that, but nothing blocked the interface from doing so.
- Fixed some possible gui issue after peace conference
- Fixed issue with calculating losses from manpower
- Fixed issue where river crossing would not impact breakthrough of attackers
- Expeditionary forces now use the manpower pool of their origin country
- Fixed an issue with Burma road focus not giving rewards unless Britain actually owned india and parts of China (Britain owning India and parts of China would probably not want to help China anyway)
- Fixed bug where some lakes could remain controlled by the enemy, and there was no way to conquer it.
- Puppeting either the Soviet Union or Germany voids the MR-Pact
- Neville Chamberlain resigning through event no longer forces fascist or communist leaders to resign
- Removed exploit where the SOV Great Patriotic war could become permanent

###############################
# Stability & Performance
###############################
- Fixed potential CTD in num_faction_members trigger
- Added some safety agaisnt CTDs when doinh really broken saves with mods
- Fixed a savegame reading bug leading to broken saves 
- Fixed potential CTD in trigger checks for home areas
- Fixed rare order-related CTD.
- Fixed CTD in automated handling of units in fronts.
- Fixed CTD in unit map icon.
- Fixed more divs by 0 than you can shake a stick at.
- Made exiled units move to the area closest to them in stead of their capital.
- Fixed CTD when player eventually clicked on the sea province in the construction mode
- Fixed CTD in lend lease view, when player closed the view while having acceptance tooltip
- Fixed memory leaks in political and unit stats view
- Fixed CTD - AI referring to a deleted front.
- Fixed CTD - Extremely rare and difficult to reproduce crash regarding the multithreading.
- Fixed CTD - Caused by the division by 0 when a certain naval combat took place.
- Fixed CTD - Rare crash when going back to main menu.
- Fixed CTD - When trying to access a garbage memory data (regarding the supply naval routes) when loading some savegames.
- Fixed CTD - When trying to access some data of deleted unit that was sent as a volunteers.
- Optimized by ~70% super heavy performance spike after the peace deals.
- Fixed OOS with peace conferences where not all human players were involved
- Fix almost guaranteed OOS in mp for AI white peace
- Fixed potential OOS on save load and some units were encircled
- Fixed OOS due to multithreading issue in air superiority calculations
- Very rare CTD fix (framerate dependent), when clicking CONTINUE to load the recent save
- Fixed malformed map texture in low-detail gfx settings. Enabled some basic lighting that solves the tiling problem, which improves the look, but makes the shader a tiny bit heavier.



################################################################
############         VERSION 1.2 "Sunflower"         ###########
################################################################

###############################
# Features
###############################
- Added Hotjoin for smoother multiplayer experience.
- Added Resyncronization option for the host if the game decides to go out of sync.
- Added custom difficulty settings

##################################
# AI
##################################
- Added abort to AI strategy that made germany down prioritize navy
- Romania now has a chance of refusing soviet demands on Bessarabia if in a faction
- Japan AI now has semi sanity triggers before starting new wars via focus
- Added AI weights for election events. Should stop nations from always moving towards fascism or communism over time
- Added AI chance to prevent France turning communist during first election in a historical play through
- Lithuania may now reject German demands for Memel if Germany is losing a war when demanding it
- Various front balancing to improve situations like countering invasions, not piling everything in Africa, overassigning to straits etc
- AI is now able to remove factories and build nuclear power plants in stead. Also made the AI better at reasearching nuclear tech. Watch out, the nukes are coming!
- Fixed a bug that made the AI unable to properly reorganize volunteer troops
- Various changes and bug fixes to template design AI, making it better at creating new ones as well as designing according to target templates
- Improved (read "fixed") match score calculation for AI template design
- Added a minimum target template match to avoid AI moving on to shit templates too early
- AI now evaluates current deployment lines to see if they should be replaced by newer templates
- Made AI much faster at replacing templates for units in the field. Will primarily impact large nations. Seriously, it was WAY too careful about this before
- Improved AI nuke targeting
- Units is no longer make arbitrarily long port rushes. This should reduce the number of map snakes significantly
- AI is now be better at noticing when they are about to get cut off from the front and react to it
- Germany is not backing down from declaring war on tiny Luxemburg just becsause it is so tiny that it does not prepare a full on invasion
- AI can now cancel unit production if they are struggling with supporting their units in the field
- Made AI better at balancing multi type production
- Made sure AI does not retreat willy nilly from a valuable VP
- Made AI a bit more cautious/clever when deciding on plan activation for undermanned fronts
- Now AI actually turns on naval defence when it is threatened by generating wargoal or actual wargoals
- Now ai does nuke only cores and when it will actually lower NU
- Germany should no longer have a crippled fighter production
- Merged in Enhanced Peace Conference AI mod (for more historical ai peace behaviour), with a few modifications 
- AI will now avoid taking occupied land from its faction members in peace deals
- Fixed a booboo in AI code that counted front size in a way that resulted in min units being one less than intended (sometimes leaving a hole in the front)
- Historical France should no longer go early communism.
- AI should no longer attack the swiss during historical period if france etc alive
- Now ai will be less careful in some attacks :D (Previously it was SUPER careful)
- Made unit controller more reluctant to leave empty front provinces
- Tweaked template progression script to make it better at moving to medium tanks.
- Tweaked down AI desire to make variants in stead of templates.
- Tweaked AI template design script to improve modern armor designs.
- Changed AI blocker for Germany's USSR war goal to only look for neighboring wars in home area
- Fixed a bug in AI template switching and tweaked the balance of it a bit to match the correct functionality 
- Added tooltips for add_leader_trait and remove_leader_trait
- Tweaked AI to be slightly less cautious against fortified enemies.
- AI now able to pick all ideas players could (was restricted by allowed during play that was scripted for startup condition only)
- Fixed bug that upgraded units to garrison templates.
- AI now more careful about considering units in combats when it needs to rebalance fronts
- Improved AI supply evaluation for fronts with supply issues

##################################
# UI
##################################
- Build cost of 0.1 or lower will no longer be shown in the tech window
- Fixed some stats for ships showing navy stats instead of ship stats
- Changed some highlights in navies and air overview to reflect if modifiers are good or bad
- Moved French foci to display the 'mutually exclusive'-arrows.
- Juggled some stuff around in the deafault mapmode tooltip.
- Added attack modifiers to unit tooltip when multiple units in the same province are selected.
- Added focus icon and national spirit icon for fourth international
- Ship combat history list no longer cuts at bottom
- Fixed texts out of boundaries issues in modding sub window
- Fixed linebreaks issue in production entries for names
- Fixed an issue with Czech letter ý not showing up in english version
- Added more army icons, there are now 14 in total
- Added ability to assign groups to orders on the theater item
- Added collapsing deployment conveyors      
- Added changing order of deployment conveyors
- Added visualization for stalled lines (icons and progress bar coloring) in the deployment interface
- Focus progress bar now shows amount of saved days
- Navy and army leaders have now better area for skill tooltip
- Organizing airwing entry names no longer overlap
- Improved the damaged building progress bar, should be clearer now
- Replaced english flag with american in launcher for language selector
- Added tooltip for max factory modifiers
- Added tooltip explaining factory repair speed modifier
- Changed how and when National Focus displays tooltips for cancel triggers and requirements
- Added descriptive tooltip for resource gain efficiency modifiers
- Now when unit is not advancing because of too low str/org, the shoutmark with tooltip explains why
- Added better tooltip for Trotsky Focus. Proper effect shows up when Trotsky is back.
- Fixed a truckload of spelin erors and tpyos
- Lots of localization fix. Some minor, some embarrasing
- Added 2nd level invasion alert after enemy has landed
- Wargoal justification modifier for fascists now shows that it requires you to be at war with a major instead of just stating: "Fascist"
- Updated tooltip to reflect that you can get Trotsky to return by picking the Purge
- Added damage info tooltip to survivors in naval combat
- Tooltips showing complex keyboard shortcuts now display correctly (like ctrl+h)
- Changed language flag for English in launcher to show US/UK split

##################################
# Database
##################################
- Added portrait to Japanese general Naruhiko Higashikuni. Bumped skill 1 -> 3
- Moved some units and buildings around.
- Gotland is no longer considered a colony of Sweden. In the game...
- Added German Claims on Poznan and Danzig in 39 start
- Removed coastal from some inland provinces
- Added some more Persian names
- Removed Portugese cores in Africa
- Added Sinkiang cores to 36 start
- Removed building from Menguko in 39 start to avoid the wrath of the errordog
- Returned Fehmarn to Germany, despite my Danish heart wanting to cling on to it forever!
- Made new soviet province coastal and added naval base to avoid troops getting caught
- Added new Cambodia state
- Adjusted states in the Caucasus
- Added Stalinabad as a new state
- Added history files and cores for Cambodia
- Added history files and cores for Vietnam
- Added history files and cores for Laos
- Added history files and cores for Malaysia
- Added history files and cores for Indonesia
- Added history files and cores for Azerbaijan
- Added history files and cores for Georgia
- Added history files and cores for Armenia
- Added history files and cores for Ukraine
- Slightly toned down Croatia's color
- Fixed positioning of units in the province two east of Amsterdam
- Added TUR communism leader Sefik Husnu portrait
- Fixed urban terrain texture in the city of angels
- Cut down some 3d trees around Hannover and planteed some new ones in finland. Also cut down lots of trees in various parts of the world, global warming here we come
- Added armored division templates to commonwealth countries
- Removed lake Volta from the map
- Added portrait for leader of fascist Palestine
- Missing portraits for Georgia. Fixed Georgia generating arabian leaders
- Fixed some state and city names
- Changed date triggers in UK focus tree to look for threat levels and war instead
- Indonesia is now a puppet state of the Netherlands
- Malaysia is now a puppet state of Great Britain


##################################
# Modding
##################################
- Added trigger: has_non_aggression_pact_with = <TAG>
- Changed every_country random_country any_country all_country to include current country. -Added _other_ versions of all of the above. eg. any_other_country
- Autogeneration of cores in home area now only adds core if no other country has core on the state
- Added ROOT and PREV support for has_government
- Fixed CTD when the players capital state did not contain any provinces
- Fixed CTD when scripting victory points in a province that has no state
- Diplomatic actions now use FROM instead of PREV scope to store stuff 
- is_ai trigger no longer unaware of human_ai console cheat
- added new "ignore" ai strategy for when we want ai to ignore actions against someone (implemented as stopping justifications and sets neutral attitude).
- Added console command to give nukes
- Added add_equipment_to_stockpile effect.
- Added is_researching_technology trigger.
- Added damage_building effect.
- Added set_state_category effect.
- Added has_state_category trigger.
- Fixed an issue for users who had mods installed prior to the mod system update refusing to update etc

##################################
# Balance
##################################
- Added anti-Daniel trigger to USA focus Issue Warbonds. Now available if at war with any sufficiently large nation
- Added focus to access purge part of the Soviet focus tree if the player choses Trotsky
- Rebalanced some armor values for tank varaiants that were inconsistent with how the rest were distributed. 36 light tank AA armor 20 -> 10. 41 light tank AA armor 35 -> 25. 36 medium tank artillery armor 35 -> 45
- Lowered communist support 8 => 5 gained from revoking workers rights in 'Matignon Agreements' event
- Now regain of convoy efficiency starts after 7 days instead of 3
- Now regain base speed of convoy efficiency starts was lowered and has been changed to non-linear change
- Moved Around Maginot before war with france focus so its easier to take for AI when needed 
- Subs no longer detect other subs leading to wierd infinite battles
- Reduced naval ranges across the board
- Balanced most ship's stats
- Fixed a bad bug with org impact on ship hit chance making it over all much too small (rebalanced base chance a bit to compensate)
- Evasion stat on ships now no longer makes such a drastic impact on hit chance (now capped and multiplicative)
- Ships with torpedoes AND guns will now try to close to torp range vs capital ships
- Added stacking penalty to hit chance for multiple ships targeting same target in naval combat
- Made ships spread targeting a bit more rather than focusing fire
- Fixed situation where ships would switch targets so often that they didnt bother closing range
- Dispersed industry now gains 5% higher starting efficiency for new production lines per level
- Lowered participation score from casulaties in war
- Submarines are now much better at detecting surface ships 
- Submarines now worse at detecting other submarines 
- Increased xp cost of land upgrades a bit (+5 base)
- Armor gun soft attack upgrade on variants now goes up to +15% rather than +50%
- Speed upgrade now stronger (max 20% rather than 10%)
- Fleets in combat in naval regions now also count towards supremacy so that you can't sacrifice some ships so easily and rush across
- SPART now much more costly (almost 2x) 
- Increased mechanized infantry supply use by 30% and increased cost to be in line with MARM (+20%)
- Signal companies now give more effect on planning speed and cost less
- Reduced Hitler's PP bonus from +50% to +25%
- Battleship lvl 1 no longer have too high surface detection
- Fixed an exploit for US War Bonds focus

##################################
# Bugfix
##################################
- Prevented Zombie Amelia from returning from the dead to fly around the globe and other related weirdness
- Faceless leaders should no longer be a thing in HOI4. Forwarded idea to Stellaris
- Fixed a bug that required London to be held by France for 'Fall of London' event to fire
- Moved all houses in Los Angeles to the province next door. Moved urban terrain modifier to reflect this
- Blocked 'Communists Influence Foreign Policy' event from adding popularity with nations you are at war with. Added communist popularity to option for the event
- Germany no longer demands Slovenia while at war with Yugoslavia
- Game no longer suggests R'lyeh won't give you a building permit. Building tooltip no longer refers to water as "foreign territory"
- Fixed an issue with how saved event targets works with tooltips
- Fixed a bug where would lose all thirst for vengance during a civil war. Romania now retains revenge ideas
- Fixed 2 supply areas having the same state in Brazil
- Fixed a bug where Soviet focus 'Southern Thrust' would only work for Afghanistan if Persia owned the states
- Fixed a bug where UK would hand out land they didn't own in return for some old boats
- Stopped dead Roosevelt from dying again, and pulling the current president into the grave with him. What is dead may never die!
- Stopped zombie Chamberlain from coming back to sign Churchill's resignation papers
- Japan now keeps its promise to not kill Siam. Added check for NAP to 'Pressure Siam' focus for Japan
- Added special case for Anschluss when Austria has a civil war
- Fixed an issue where German AI would get stuck on demand sudetenland. Changed reward from the focus if another nation has taken sudetenland
- Fixed a bug where Germany would hand out territory and not care about ownership during the Vienna Award
- Blocked warlords from joining Chinese front if at war or in a faction
- Autogeneration of cores in home area now only adds core if no other country has core on the state.
- National Foci now looks for control of state before building in it
- Being a puppet now quenches Japans thirst for war. Blocked war foci
- National Foci are now blocked by default when a country has capitulated. Added "available_if_capitulated = yes" to disable
- Added trigger to look for control of state before loading units from China Unite event
- Added province for Eastern Chukota. Added to eastern Siberia
- Added check for different ideology for a bunch of foci leading to war
- Made sure it is not allowed to give control over a state to someone who is not an enemy of the owner
- Now on game sturt up puppet airbases are accessable for master
- Now submarines target only non empty routes
- Fixed efficiency interpolation, now it can regain to 100%
- Now Convoy efficiency will also cap to actual amount of convoys performing
- Now for supply calculation is used naval cap instead of supported cap
- Now the unit with strategic redeployment will cancel movement towards enemy territory
- Fixed the bug when naval base capacity was not updated on loading the game
- Fixed the bug when sunk ships was removed from combat
- Fixed the bug when after peace conference pause was not properly updated on clients in multiplayer
- Now resistance drop will be properly shown when it is bellow the resistance cap
- Fixed not maching estimation number on the production entry and the tooltip on the production screen
- Resistance modifier in the army overview is now shown as positive value
- Fixed the bug when supply system was not properly initialized on start (fixed SOV supply alert on new game)
- Fixed the bug when game could froze in the production screen for a long time
- Fixed the bug when player could trade with infinite amount of factories
- Now division performing support attack can't have planning bonus gain
- Fixed the bug when player could remove guarantee preformed by other country
- Fixed the bug when countries was not surrendering while being fully occupied
- Glorious return of navy delete button
- Now if user disconnected from steam cloud save button will notify about that
- Fixed issue when save game status was not updated for achievements after selecting bookmarks
- Now while peace conference after capitulation winners can annex all of the territory of surrendered nations instead of only controlled by winner and lost nation
- Fixed the bug when sometimes military and naval factories were redistributed incorrectly
- Now air combat kills counts towards killer statistics
- Added tooltip over red striped zones in the deployment map mode
- Added air superiority as requirement for port strike
- Now planes put on port strike will not add up to air superiority in the region
- Now port strikes demands less than 30% of enemy superiority (instead of heaving more than 70% of our)
- Now adjuster values given from leader traits apply in land combats
- Now resistance doesn't apply in states occupied by revolter during civil war
- USA intervenes in inter american war event now adds USA to the war instead of starting a separate war
- Com China can now move it's capital if it own Beijing OR Nanjing, not both
- Fixed Fourth International news event not showing for the player
- Fixed script error that required London to be held by France for 'Fall of London' event to fire
- Party popularity boosts correctly stack now when several countries boost the same ideology of target country
- Fixed rebasing of planes to puppet airbase on game start
- Ship types are not duplicated in navy statistics anymore
- Fixed issue where min convoy efficiency was not applied (plus smooth efficiency change showing)
- Changed tooltip for Compassionate gentleman to reflect what he actually does
- Fixed a case where too large defender fleets destroyers would guard capitals rather than convoys in a convoy assault
- Guarantees can no longer be used to call in nations to war if you have no defensive war
- Nuke count can no longer go so big it becomes negative (max 999 nukes)
- Added fallback surrender target based on war leaders if you somehow end up needing to surrender to someone without warscore. should stop infinite wars that could happen in soem wierd situations
- Democracies allowing fascists in government no longer turn fascist faction leaders communist in election events

###############################
# Stability & Performance
###############################
- Fixed CTD for active naval missions.
- Fixed CTD when moving navies.
- Fixed CTD upon resign when running the game at high speed.
- Fixed CTD in AI when Handling Navies.
- Fixed CTD when validating if a province can be nuked or not.
- Fixed CTD when merging navies.
- Fixed CTD in the description of Remove Ideas Effect.
- Fixed few CTD's occurred during peace conference
- Optimized lategame AI handling of garrisons
- Strategic air view open no longer drops the performance to 1FPS at the late game. Now it takes almost no CPU!
- Fixed CTD when a nation would surrender to capital owner who might not be at war
- Fixed the CTD when while drawing garrisoning order and deleting all orders player could get a CTD
- Fixed OOS when host has gone back to main menu from lobby and then hosts again


################################################################
############     VERSION 1.1.0 "Red Ball Express"    ###########
################################################################


###############################
# Features
###############################
- It is now possible to set a command group to execute orders in different manners: carefully, balanced, and rush.
- Added achievements indicator in game setup telling you if you can get achievements or not
- Now possible to start from scratch with an empty division template by selecting New in the designer drop down

###############################
# AI
###############################
- Tweaked deployment AI to not get crippled when their armies are taking damage.
- Air mission AI is better at prioritizing the most important regions in stead of getting stuck in local optima of groups of regions.
- Tweaked down AI desire for motorized a bit.
- Added scriptable AI strategy to tweak factory assignment to equipment types and SIGNIFICANTLY boosted fighter production.
- Tweaked up AI production balance for infantry equipment.
- Tweaked guarantee desire to go down the more enemies a country has. Should keep Allies from going guarantee crazy while in wars.
- Added a define for min steps for unit controller to strategically redeploy to front location and boosted it from 4 to 8 to reduce lots of small redeployments along fronts.
- Made AI capable of determining if a template was created by them or not. Germany should no longer replace their divisions with templates from Austria.
- Tweaked area defense and pocket handling AI to be better at handling coastal defense.
- Tied countries naval base IC fraction to their naval AI focus, primarily meaning Germany will not be building as many of them, at least initially.
- Improved unitcontrollers capability to recognize when units should join as support in a combat (effects both player and AI).
- The AI now launches naval invasions against the same enemy area at the same time rather than separately.
- Tweaked AI template designing
- Having a common enemy will now make AI very accepting to granting and accepting military access as long as both are democracies.
- Neutral countries now consider guarantees when deciding on which faction it would rather join.
- AI is now properly checking if having common enemy when looking at asking for and granting military access, and is also more eager to do
- Soviet and Germany should no longer bail from the Unholy alliance as soon as they can
- AI containment score no longer goes massively negative if a major is farther away than germany meaning Allies can guarantee vs soviet aggression if they are worse than Germany
- Made non-core states count as half compared to core states when deciding on number of units for area defense.
- Added Women in Aviation to historical focus list for soviet
- Moved Claims in Baltic up the historical focus list for soviet
- Improved AI naval deployment to strategic regions 
- Tweaked front assignment AI. Should mean AI is better at multi front wars.
- Further tweaks to AI front assignment to attempt to reduce bad stuff happening in multi front wars.
- Further tweaked the AI front balancing, and made sure France does  not completely mess up their Italian front and Germany pushes hard against Poland when war breaks out 
- AI should now be able to respond to naval invasions with naval bombers 
- Made sure fascist majors are much more likely to go for war economy 
- Polish AI will no longer randomly change its ideology by picking ministers
- AI should no longer use garrison divisions as infantry.
- Changed trigger condition for UK focus Benelux Intervention to require a bit more fascist/communist support, preventing the AI from taking it immediately. 
- Naval AI will now deploy all its fleets (previously it would generally deploy less than 1/3 of all its ships). AI will now split fleets it cannot find a mission for, allowing it to spread them out better
- AI is now able to set naval bombers to try to prevent others from sending reinforcements over water.
- Tweaked AI down prio of non war/dangerous fronts.
- AI will no longer guarantee against leaders of other naughty factions (like soviet) if there is a much much worse faction around doing bad stuff (Axis) 
- AI nations will no longer spam you with requests for military access at game start and nations who would rather occupy someone than liberate wont ask for military access
- AI can now feed puppets/liberated/change government countries with states in peace conferences giving much saner outcomes
- Made sure unitcontroller does not interfere with retreating units.
- German 1939 OOB now lists the good armor template last so ai will prefer it
- Made sure that template design AI puts a motorized together with armored when making new templates.
- Made AI look more at fitness when picking template for designing, upgrading and deployment.
- Improved how AI calculates which is a garrison template (making it pick the proper one as infantry.)
- ai now avoids putting nations that have very small bottleneck borders as main enemy
- ai now prioritize fighters and medium armor more for research
- Countries at war are no longer automatically assuming war will happen with non neutral neighbors (the Germany putting everyone against Soviet thing.)
- ai no longer retains main enemies who have already gotten wiped out
- Germany no longer goes justification crazy on south america
- Romania and Yugoslav small armor templates on start no longer deathtraps for AI
- AI should no longer ping-pong between trade laws in edge case
- US AI now a lot more hesitant to join factions due to threat
- fixed add_ai_strategy effect and added strategies where countries are added in faction from event or focus
- AI will now prioritize better economic laws a lot more
- Fixed typo in polish AI focus


###############################
# UI
###############################
- Division designer difference indicators now have tooltips showing how much
- Added open air base button to the air mission entry 
- Now shift+click on the category in the production will make visible only that category 
- Interface tweaks so long texts in other languages does fit in several places
- Added buttons for airwing limit to make easier to adjust values in big steps
- Now navy commander can now also be assigned while fleet is not in the port 
- Added tooltip and toggling icon to indicate if current settings let you unlock achievements 
- You can now merge fleets that are not in the same location, the merging fleet will then travel to its merge target and then merge with it. 
- Now it is possible to assign airplanes to a mission area before the arrive to the new base 
- Division template window has now better tooltips for equipment, manpower, training time.
- Clarified "no trading while fighting"-tooltip
- Added yellow highlight to deployment date for units
- Changed string format for convoys in topbar to prevent overflow 
- Opinion in interface will now also return a value capped between min and max values
- removed useless decimals in logistics screen 
- Logistics screen now show 1 decimal when over 1k 
- Intel viewing of airplanes don't show fantasy numbers anymore
- Now air base icons shown non empty only if there are players air wings


###############################
# Bugfixes
###############################
- Fixed issue when sometimes frontlines was not updated after occupation.
- Now Nation A liberates Nation B if Nation B is friend or giving military access to Nation A, otherwise occupies
- Fixing quiting to menu achivement bug 
- Fixed some focus that couldnt be aborted 
- Fixed issue where it was impossible to do naval transfers where you have the theatres. Also player couldn't RMB on some naval ports but the systems allowed for the transportation (GUI issue).
- Building cosntruction triggers checked for owned state/province. Now checks for controlled instead 
- Added on_action to the add_to_faction effect which should fix lack of achivements for faction joining 
- Modified flags for Holland 
- Fixed so equipment cost list doesn´t cut of 11th entry in div designer 
- Efficiency retention techs now actually help (no efficiency loss at max all techs now!)
- Fixed spelling error in FRA, BRAZ for "Ottowa"-class ship
- Intel overview of nation now also lists airplanes in stockpile
- The political advisor type "Ideological Crusader", which are supposed to increase same ideology opinion with 20%, now has an effect. 
- Added custom trigger description depending on type of idea for better tooltips 
- Border occupation now account situations when you attack trough the country which is from the same war, but not in the same faction, plus border flip afterwards also account for countries from the same war. 
- The game option "Pause on Notifications" now also pauses NF/research. 
- Proper data cleanup when kicked, banned, connection lost, server lost.
- Fixed glitch in the front sections calculations, causing sometimes the fronts to be split/malformed.
- Skybox is no longer visible when you toggle UI off
- Changed font on animated map text so it show cryllic and polish characters
- Fixed fighter icon for polish dlc
- Fixed text on Mod tools button in launcher that didn't fit in Spanish
- Kick and ban buttons in mp lobby should now be aligned (important!)
- Maldives now looks a tad better, changed the heightmap, made some of the islands smaller and nudged unit positions 
- Fixed script error in Pearl Harbor Gambit focus 
- Carrier deck size now matches everywhere.
- No longer allowed to declare war on someone you are fighting a war together with.
- Convoy count in topbar now can show 5 digits
- Fixed Issue where long air region names goes out of dedicated area 
- Added triggers to block multiple news event options 
- Fixed issue when take all states action did not changed the price when other country puppet the loser 
- Drawing offensive orders now takes better choice which def.line to attach the arrow to. 
- Added ability to disable debug saves and made them turned off as default 
- Added bypass to Pearl Harbor gambit focus for USA 
- Fixed malformed frontlines against master/puppet for countries being in faction with the master.  
- Disabled the system_debug.log when not running with "-debug" launch option.
- Fixed pausing of the game on the fullscreen 
- Patched mysterious issue when airbase was lost and the air wings still remained in void space. Now they are send back to the warehouse.
- Fix for flickering airbase icon in the airbase view 
- Nations who are done in a peace deal will no longer give remaining points to anyone in faction, just people with same ideology
- Parts of unit map icons will no longer "trap" the zoom-in with mouse
- Fixed artillery starting with 0 defense 
- Now peaceconference saves will happen only with -debug while start up 
- Now occupation breakdown updates properly after exiting to main menu 
- Fixed occupation rules
- Fixed a bug where you could avoid civil war by inviting back trotsky 
- Warscore from bombing is now saved in save game.
- Warscore from bombing is now much lower + added monthly falloff.
- Fixed issues with country rules not clearing properly and not updating every day
- Added special case for showing shortcut icons "," and "." 
- Changed price calculation for new divisions so now it does not add up cost for group if it is first group
- Increased modifier that prevents spain from joining axis early 
- Fixed bug where a country without the rule of occupying neutral countries could occupy them.
- Fixed the bug when airings manpower was not updated
- King G now only dies once 
- Browser now remembers last page 
- Naval strikes can now also hit navally transfered troops outside combats 
- Added event that allows merges of 2 communist chinas 
- Fix for peace conference turns not taking scor einto consideration properly 
- Fixed bug where it was possible to send a single unit as exp.force twice!
- Changed a lot of popus to use the definite article 
- Fixed a bug that gave USA extra PP for certain NF 
- Warscore is no longer added from dropped countries in war merging.
- Trade routes over land now get correct tooltip on day 1 
- Factories from trade now used to fill construction and trade first
- Fixed join faction achievement not firing. Fixed scope from add_to_faction effect
- Fixed Soviet civil war triggering multiple times. Fixed 2 outcomes of not purging happening at the same time.
- Leaving a faction no longer broke the entire supply system until save reload
- Fixed issue where merging ships would reduce manpower
- Removed EU4 hints folder.
- Fixed the bug when Britain couldn't declare war on other democratic countries despite having a wargoal from focus


###############################
# Database & Balance
###############################
- Changed German democratic party to Zentrum 
- NF completion for Poland 39 start 
- Fixed spanish communist crusader using male portrait
- Focus Lessons of War and Sov-Ger research agreement now give less armor research
- Added AFG leader portrait Zahir Shah, VEN leader portrait Lopez Contreras and 3 new middle eastern generic portraits 
- Replaced incorrect japanese general 
- Added Xi'an to PRC 
- Added straits to denmark to make them more surrendermonkeys [Balance]
- Several name corrections in OOB files
- Province 3860 is now a part of state 527 instead of 328. (Manchuria/Korea) 
- Added an event to move PRC capital to Beijing or Nanjing after Chinese Civil War. 
- Added a requirement of more than 15% world tension to War Economy policy.
- Removed Hungarian claims from Northern Transylvania and Vojvodina
- Removed generic Tank Designer idea from Canada. 
- Moved Sao Paulo to be part of the Sao Paulo state. 
- Found a better Serbian fascist party leader.
- Adjustment to Paraguay and Nicaraguan political 36 and 39 starts.
- Republican Spain and Nationalist Spain now have the same National Unity
- Added more ai_choice triggers for Czechoslovakia's response to German demands.
- Added localisation for Libyan adjectives 
- Changed names for neutral Nicaragua and Paraguay
- Fixed Finland starting as democratic in 1939 
- Added ENG cores to French cores when Anglo-French Union happens  
- If the Munich agreement can't happen (depending on various wars for GER or CZE) CZE will now get a different event about ceding the Sudetenland or giving GER a wargoal. 
- Soviet now gets one armor research bonus and one land doctrine, rather than three armor research. 
- Fate of Czechoslovakia now correctly adds claims and an annex CB if CZE resists GER. 
- Fixed text overflow in Balearic Islands headline. 
- Expanded the final event for RAJ's Azad Hind, and added several removal points for the Azad Hind idea.
- Removed eng core from state 687-British Guyana 
- Added fixedsize to countrystate view state owner and foreign claims 
- Fixed heightmap error on denmark
- Fixed so all building in the maldives are on land again
- German march order music now has correct path
- State name corrections.
- Added names for (unreleased) country tags.
- Lowered time for Demand Balearic islands for Italy 
- Moved capital of Brazil to Rio 
- Subdue the Warlords now requires that China does not exist or is a puppet of Japan 
- Johnson Island Garrison renamed to Johnston Island Garrison 
- Corrected JAP_1939 unit history. 
- Fixed a bug where an achievement wouldn't fire because of it was using any_country trigger
- Soviet foci New Soviet Man and Women in Aviation have switched places 
- Added general to Ireland 
- Nerfed skill 5 generals for BRA AST AFG CAN 
- Changed German Admirals traits for variety 
- Bumped population of some of the smaller islands 
- Changed ideology of country leader for DEN FIN FRA NOR SWE 
- Changed start trade to use factories instead of specific amount of factories for trade 
- Increased air range on rocket interceptors now that local coverage isnt always 100%
- Mass assault doctrine now gets -10% lower requirement on training for deploying divisions
- Political parties and leaders for Brazil. From forum.
- Great depression now limits faction joining at an extra 20%
- Human pause now has a superior priority to the automatic pause
- Fixed issue  with fleet splitting failing because it forgot to assign base
- Now state controller switches properly after capitulation
- Added 3 new generic asian stateleader portraits and 2 new generic asian warlord portraits 
- Added 6 new generic Arabian portraits
- Sheng Shicai got a minor facelift
- USA now gets a slightly different shade of blue to differentiate them from france
- Fixed inconsistent finnish flags 
- Added additional flags for Jordan 
- Fixed Israeli leader portraits
- Fixed bugs in event for china moving capital
- Lowered time for National focus "support nationalist spain" so Italy can complete it before the SCW ends
- Typos and political party fixes for Brazil
- around maginot line focus now a bit faster
- Rebalanced ships so that armor is more important and destroyer spam no longer rules the sea. Ships are also a bit cheaper to produce but require a little more manpower 
- air battles should now be a lot less bloody and slower paced
- Fighters should now have an easier time vs enemy bombers without escorts


###############################
# Stability & Performance
###############################
- Will no longer overwrite ironman saves if writing of current failed 
- Optimizations for air interface and mapmode 
- Parser now handles large tokens without crashing on savegame load 
- Optimization for releasing countries
- Fixed several memory leaks
- Fixed CTD for airwing transfer when base in invalid
- Fix for potential CTD in splitting navy when you have no home base.
- Fixed rare ctd when loading an old savegame from ingame with active naval combats
- Fixed several rare CTDs
- fixed rare CTD in alert manager
- fixed rare CTD in air gui
- Improved performance a lot when viewing a lot of unit icons in combat
- Fixed a possible CTD on fleet merging
- Fixed Extreme slow down because of sea locked fleets trying to get out.
- Fixed CTD in history writing when convoys shoot down aircraft and having lost their route

###############################
# User Modding
###############################
- Added possibility to script in historical aces in name pools
- Moved dynamic country tags into a separate file
- Manpower in field trigger no longer counts expeditionary forces from other nations
- Fixed issues with tooltip for ships in port trigger 
- Added defines to tweak unit assignment importance for different kinds of orders.
- Added possibility to script desired amount of factories to spend on a trade
- Fixed crash from default bookmark being later than 1936
- Added add_ai_strategy effect
- In debug mode the country flag tooltip will now show AI strategy values
- Fixed map icon crash from having more than 128 country capitals in view
- Fixed country unit names list being incorrectly initialized during modding leading to CTD

###############################
# Multiplayer
###############################
- Supplysystem should now update for all players when changing country controller (OOS fix)
- Observers no longer get asked for co-op acces as well as main player


################################################################
########################## VERSION 1.0.1 #######################
################################################################


###############################
# Gameplay
###############################
- Fixed an issue with deploying troops during spanish civil war when continuing savegames.
- Can now zoom in and out using PgUp and PgDown buttons on keyboard.
- Stopped an exploit where player could redirect a naval transfer into an invasion without preparation.
- Fixed a case where fleets who found themselves outside base range would be instantly deleted.
- Fixed some highlighting issues in tutorial.

###############################
# Database
###############################
- Added 9 new unique nation leader portraits.
- Improved some VP/state names in China.
- Improved a lot of alternate ideology nation names and party/leader names.
- France can now send volunteers to Spain if they choose the Support Nationalists focus.
- Fixed many localization issues, both in english and other languages.

###############################
# Stability & Performance
###############################
- Fixed several rare CTDs.
- Late-game performance optimizations.
- Large peace conference resolutions are now faster and also properly indicate that they are active to non-participants.
- Added GUI scaling option for people with very small or very high resolutin displays (experimental).
- Added a max framerate limiting system (defaults to 75fps) to settings.
